<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Nuxt Markdown blogs are potentially bloated and inconvenient - suXin space</title>
    <meta name="og:title" content="Nuxt Markdown blogs are potentially bloated and inconvenient - suXin space"/>
    <meta name="og:description" content="Most of the Nuxt Markdown blogging solutions lead to bloated bundle size and up to four copies of your content. All while the setup is also being more convoluted than it should. I suggest we should respect user's bandwidth and either fix the issue, or just use Gatsby/Gridsome."/>
    <meta name="og:url" content="https://suxin.space/notes/nuxt-bloated-markdown-blogs"/>
    <meta name="og:image" content="https://suxin.space/notes/nuxt-bloated-markdown-blogs/nuxt-icon-bw.png"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="Nuxt Markdown blogs are potentially bloated and inconvenient - suXin space"/>
    <meta name="twitter:description" content="Most of the Nuxt Markdown blogging solutions lead to bloated bundle size and up to four copies of your content. All while the setup is also being more convoluted than it should. I suggest we should respect user's bandwidth and either fix the issue, or just use Gatsby/Gridsome."/>
    <meta name="twitter:site" content="@suxinjke"/>
    <meta name="twitter:image" content="https://suxin.space/notes/nuxt-bloated-markdown-blogs/nuxt-icon-bw.png"/>
    <link rel="stylesheet" href="/normalize.min.css">
    <link rel="stylesheet" href="/fonts/fonts.css">
    <link rel="stylesheet" href="/main.css?t=1736166119584">
    <link rel="stylesheet" href="/notes/note.css?t=1736166119584">
    <link rel="stylesheet" href="/prism-github.css?t=1736166119584">
    <script src="/main.js?t=1736166119584" defer=""></script>
  </head>
  <body>
    <header class="header"><nav class="nav header__nav"><a href="/" class="nav__link"><div class="header-text"><div class="header-text__icon-container"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"/></svg></div><div class="header-text__content" title="Home"><h2 class="header-text__primary uppercase">Home</h2></div></div></a><a href="/notes/" class="nav__link active expand"><div class="header-text"><div class="header-text__icon-container"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"/></svg></div><div class="header-text__content" title="Notes - Nuxt Markdown blogs are potentially bloated and inconvenient"><h3 class="header-text__secondary">Nuxt Markdown blogs are potentially bloated and inconvenient</h3><h2 class="header-text__primary uppercase">Notes</h2></div></div></a></nav><h2 class="header__logo">suXin space</h2></header><main class="readable note short-width"><h1><strong>Nuxt Markdown blogs are potentially bloated and inconvenient</strong></h1><h3 class="uppercase">Jul 09 2019</h3><div class="note__content"><p>In a <a  href="/notes/about-this-website/">previous note</a> I wrote about my experience on making this personal website and the way I wanted to manage my content. During those days I relied on <a  href="https://nuxtjs.org/" target="_blank" rel="noopener"><strong>Nuxt</strong></a> as a static website generator of choice, but I realised that <strong>it won&#39;t scale for me well enough</strong> unless I figure out more hacks on how I should manage my <strong>Markdown files</strong>. I switched to <a  href="https://gridsome.org/" target="_blank" rel="noopener"><strong>Gridsome</strong></a> instead, which <em>fully</em> focuses on static generation part, and actually serves me in a better and more straightforward way.</p>
<p>In this note I want to address problems I had with managing Markdown files on <strong>Nuxt</strong>.</p>
<h2 id="the-bloat"><strong>The bloat</strong><a href="#the-bloat" class="anchor-link"><span>¶</span></a></h2><p><div class="image"><div class="image__container"><a href="./bloat.png" target="_blank" rel="noopener"><img title="The bloat" src="./bloat.png" /></a><h4 class="image__title">The bloat</h4></div></div></p>
<p>The resulting bundle I was getting would grow with each note added, and I wouldn&#39;t understand why exactly due to my convoluted <strong>Nuxt/Webpack</strong> setup. It&#39;s just unacceptable that no matter what page I open, it&#39;d have <em><strong>four-five full copies</strong></em> of each note. So if you were to open this note on a previous version of my website, you&#39;d get:</p>
<ul>
<li>Pre-rendered note as part of it&#39;s <strong>HTML</strong></li>
<li>Original <strong>Markdown</strong> contents</li>
<li><strong>Markdown</strong> transformed to <strong>HTML</strong></li>
<li><strong>Vue template</strong> based on all of this</li>
<li><strong>Vue template renderer</strong> based on all of this, because I wanted to make <strong>Vue</strong> components work in my <strong>Markdown</strong> files.</li>
</ul>
<p><div class="image"><div class="image__container"><a href="./bloat2.png" target="_blank" rel="noopener"><img title="The bloat 2" src="./bloat2.png" /></a><h4 class="image__title">The bloat 2</h4></div></div></p>
<p>At this point I want to blame my requirements on content management, and believe that <strong>Nuxt</strong> isn&#39;t really suited for <strong>Markdown blogging</strong> out of box. In the section <a  href="/notes/about-this-website#problematic-dynamic-routes-and-nuxt-link"><strong>Problematic dynamic routes and nuxt-link</strong></a> of my previous note, I already considered the solution I&#39;ve got as <em>hacky</em>. Looking back at it, I could ask myself:</p>
<ul>
<li><em>Why do I have to pre-generate a JSON with a list of notes?</em></li>
<li><em>Is putting <strong>require</strong> calls into <strong>computed</strong> even legal?</em></li>
<li><em>Is <strong>Nuxt&#39;s asyncData</strong> method the only thing that I could rely on for retrieving the content?</em></li>
</ul>
<p>Usually there always should be a sane and straightforward method to do something, and yet I always doubted if I did things correctly in this case. The fact that there are only a few of blogposts describing <strong>Markdown blogging with Nuxt</strong>, which also have similar inane ways of setting it up, once again makes me believe that it&#39;s not really suited for it as for now.</p>
<ul>
<li><a  href="https://marinaaisa.com/blog/blog-using-vue-nuxt-markdown/" target="_blank" rel="noopener"><strong>Website with blog and portfolio using Vue.js + Nuxt + Markdown</strong></a> - rely on pre-made array of blogs, and then map it with <em>imports</em> and <strong>Markdown loader</strong>. The fact that there&#39;s <em>import</em> instead of <em>require</em> didn&#39;t help with the problem of bloat. The <code>/blog</code> page here has the same problem I&#39;ve encountered: <strong>four full copies</strong> of each post that are not even rendered yet.</li>
<li><a  href="https://vuejsdevelopers.com/2018/12/31/vue-nuxt-spa-markdown/" target="_blank" rel="noopener"><strong>Including Markdown Content in a Vue or Nuxt SPA</strong></a> - generate a manifest file that contains all blogs, always include it in your application (small bloat), based on current article route - fetch the Markdown, <strong>parse and render it on client</strong>. I guess this article is not aimed at <strong>Nuxt</strong> static websites, but there&#39;s still a hint at the end that suggests to move rendering to <code>asyncData</code>, which may lead to the same problems I complain about. The article also mentions how to include <strong>Vue components</strong> into Markdown, but I believe the way it&#39;s done is hell and also adds one more copy of your full Markdown post.</li>
<li><a  href="https://medium.com/haiiro-io/markdown-driven-portfolio-website-with-nuxt-js-a8d08ffe2712" target="_blank" rel="noopener"><strong>Markdown Driven Portfolio website with Nuxt.js</strong></a> - this one is cool because it&#39;s written by creator of <a  href="https://github.com/hmsk/frontmatter-markdown-loader" target="_blank" rel="noopener"><strong>frontmatter-markdown-loader</strong></a> which me and people from other articles may rely on. Unfortunately, bloat problems remain. The article mentions making of <a  href="https://namika.hmsk.co/" target="_blank" rel="noopener">Namika&#39;s Hamasaki personal website</a> and <a  href="https://github.com/haiiro-io/violet" target="_blank" rel="noopener">there&#39;s source code of it</a>. It relies on <strong>Vuex store</strong>, which I&#39;d consider the king of hacks in attempt to collect and provide all required Markdown content beforehand, and yet it still doesn&#39;t help with the bloat. No matter what page you load, it includes an impressive <strong>400KB Javascript file</strong> containing all post content.</li>
<li><a  href="https://dev.to/teleyinex/from-jekyll-to-nuxtjs-for-better-and-faster-sites-2i71" target="_blank" rel="noopener"><strong>From Jekyll to NuxtJS for better and faster sites</strong></a> - instead of relying on Markdown loaders or parsers on build step, pregenerate all blog posts in single JSON file, which is fetched on all blog related pages. Bloat problem remains.</li>
</ul>
<p><em><strong>All of these</strong></em> include some pre-generated file with all posts, and then it&#39;s always mapped in a way that leaves this bloat.</p>
<p>While I understand that most people don&#39;t have to care much about this issue, because it&#39;s not like everyone has 100 blog posts on their website - it doesn&#39;t mean this shouldn&#39;t be addressed. But I&#39;m mostly frustrated that mobile users may wait for a huge bundle to download, only for 80% of it&#39;s content to remain unseen. <strong>We should respect user&#39;s bandwidth.</strong></p>
<h2 id="a-pathetic-attempt-to-do-it-right"><strong>A pathetic attempt to do it right</strong><a href="#a-pathetic-attempt-to-do-it-right" class="anchor-link"><span>¶</span></a></h2><p>Spoilers: <strong>it didn&#39;t work out</strong>.</p>
<p>I don&#39;t remember how, but I found <a  href="https://github.com/galvez/nuxpress" target="_blank" rel="noopener"><strong>Nuxpress</strong></a> project by <a  href="https://twitter.com/anothergalvez" target="_blank" rel="noopener">Jonas Galvez</a>. This one stands out because it injects the Markdown content into <strong>Nuxt&#39;s context</strong> via <a  href="https://github.com/galvez/nuxpress/blob/master/plugins/nuxpress.js" target="_blank" rel="noopener"><strong>custom plugin</strong></a>. I tried to adapt the solution to mine, which resulted in abomination below. It&#39;s been about a month since I made this, so I don&#39;t remember the exact reasoning behind keeping render functions like that, I guess it&#39;s to make <strong>Vue components</strong> work inside Markdown files.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword control-flow">if</span> <span class="token punctuation">(</span> process<span class="token punctuation">.</span><span class="token property-access">server</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">'fs'</span> <span class="token punctuation">)</span>
    <span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">'markdown-it'</span> <span class="token punctuation">)</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token literal-property property">html</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">'markdown-it-highlightjs'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token keyword">const</span> fm <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">'front-matter'</span> <span class="token punctuation">)</span>

    <span class="token keyword">const</span> vueCompiler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">'vue-template-compiler'</span> <span class="token punctuation">)</span>
    <span class="token keyword">const</span> vueCompilerStripWith <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">'vue-template-es2015-compiler'</span> <span class="token punctuation">)</span>

    <span class="token keyword">const</span> note_file_names <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token method function property-access">readdirSync</span><span class="token punctuation">(</span> <span class="token string">'./assets/notes'</span> <span class="token punctuation">)</span>

    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span> <span class="token keyword">const</span> file_name <span class="token keyword">of</span> note_file_names <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> contents <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token method function property-access">readFileSync</span><span class="token punctuation">(</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./assets/notes/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file_name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token string">'utf8'</span> <span class="token punctuation">)</span>
        <span class="token keyword">const</span> parsedContents <span class="token operator">=</span> <span class="token function">fm</span><span class="token punctuation">(</span> contents <span class="token punctuation">)</span>
        <span class="token keyword">const</span> route <span class="token operator">=</span> file_name<span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"><span class="token special-escape escape">\.</span>md<span class="token anchor function">$</span></span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">''</span> <span class="token punctuation">)</span>

        <span class="token keyword">const</span> html <span class="token operator">=</span> md<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span> parsedContents<span class="token punctuation">.</span><span class="token property-access">body</span> <span class="token punctuation">)</span>

        <span class="token keyword">const</span> rootClass <span class="token operator">=</span> <span class="token string">'frontmatter-markdown'</span>
        <span class="token keyword">const</span> template <span class="token operator">=</span> html
            <span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;<span class="token group punctuation">(</span>code<span class="token char-set class-name">\s</span><span class="token char-set class-name">.</span><span class="token quantifier number">+</span><span class="token group punctuation">)</span>></span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">'&lt;$1 v-pre>'</span> <span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;code></span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">'&lt;code v-pre>'</span> <span class="token punctuation">)</span>
        <span class="token keyword">const</span> compiled <span class="token operator">=</span> vueCompiler<span class="token punctuation">.</span><span class="token method function property-access">compile</span><span class="token punctuation">(</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div class="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rootClass<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>template<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">)</span>
        <span class="token keyword">const</span> render <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">return </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">vueCompilerStripWith</span><span class="token punctuation">(</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">function render() { </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>compiled<span class="token punctuation">.</span><span class="token property-access">render</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> }</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>

        <span class="token keyword">let</span> staticRenderFns <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span> compiled<span class="token punctuation">.</span><span class="token property-access">staticRenderFns</span><span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            staticRenderFns <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">return </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">vueCompilerStripWith</span><span class="token punctuation">(</span> `<span class="token punctuation">[</span>$<span class="token punctuation">{</span>compiled<span class="token punctuation">.</span><span class="token property-access">staticRenderFns</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span> <span class="token parameter">fn</span> <span class="token arrow operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">function () { </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fn<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> }</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span> <span class="token string">','</span> <span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        }

        files[route] = {
            link: </span><span class="token template-punctuation string">`</span></span><span class="token operator">/</span>notes<span class="token operator">/</span>$<span class="token punctuation">{</span>file_name<span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"><span class="token special-escape escape">\.</span>md<span class="token anchor function">$</span></span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">''</span> <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">/</span>`<span class="token punctuation">,</span>
            <span class="token literal-property property">attributes</span><span class="token operator">:</span> parsedContents<span class="token punctuation">.</span><span class="token property-access">attributes</span><span class="token punctuation">,</span>
            render<span class="token punctuation">,</span>
            staticRenderFns
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">async</span> <span class="token punctuation">(</span> <span class="token parameter"><span class="token punctuation">{</span> app<span class="token punctuation">,</span> env <span class="token punctuation">}</span><span class="token punctuation">,</span> inject</span> <span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span> process<span class="token punctuation">.</span><span class="token property-access">server</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">inject</span><span class="token punctuation">(</span> <span class="token string">'parsedFiles'</span><span class="token punctuation">,</span> files <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Anyway, the point is: <em>I don&#39;t believe we should waste time on such setups</em>. Besides, <strong>plugin solution doesn&#39;t work well</strong> because <code>&lt;nuxt-link&gt;</code> will stop working with pages that rely on injected context: there&#39;s no corresponding info among resulting Javascript files. The context data is only being sent to <strong>HTML of the page</strong> and <strong>inline Javascript</strong> on it to <strong>hydrate the Vue instance</strong>. The solution would be using plain <code>&lt;a&gt;</code> hyperlinks instead, but I like the smooth transition between pages.</p>
<p>And yet, when I contacted Jonas about the issue, he mentioned to be working on supporting <code>&lt;nuxt-link&gt;</code> properly. The <a  href="https://github.com/galvez/nuxt-static-render" target="_blank" rel="noopener"><strong>nuxt-static-render</strong></a> has been published recently, which apparently would fix the hydration issue. It still feels like a hack though, and it&#39;s not that I mind the hydration code too much compared to other bloat.</p>
<h2 id="about-gridsome"><strong>About Gridsome</strong><a href="#about-gridsome" class="anchor-link"><span>¶</span></a></h2><p><a  href="https://gridsome.org/" target="_blank" rel="noopener"><strong>Gridsome</strong></a> is static site generator that relies on <strong>Vue</strong> for frontend, and plugins that will collect the data from various sources (including Markdown), which allow you to query all of it with <a  href="https://graphql.org/learn/" target="_blank" rel="noopener"><strong>GraphQL</strong></a>. It&#39;s just <a  href="https://www.gatsbyjs.org/" target="_blank" rel="noopener"><strong>Gatsby</strong></a> but with <strong>Vue</strong> instead of <strong>React</strong> and less mature.</p>
<p>I questioned the need for <strong>GraphQL</strong> at first, I still do to some extent because I have only one source which is Markdown files, but atleast the way it&#39;s integrated into this framework solves the bloat problem. Previously on <strong>Nuxt</strong>, the importing would usually include all file content, even if you extract and render a portion of it. With <strong>GraphQL</strong>, you explicitly state what data you retrieve and you can assure it will be the only data presented on requested page. Here&#39;s a query I have on my <code>/notes</code> page, which specifies all required metadata:</p>
<pre class="language-"><code class="language-"><page-query>
query Home {
    allNotes {
        edges {
            node {
                fileInfo {
                    name
                }
                title
                date
                image
                showcase {
                    image
                    imagePos
                }
            }
        }
    }
}
</page-query></code></pre><p>There&#39;s no actual content or meta description retrieved (for social media and RSS), whatever I want or don&#39;t want to display on the actual note page would be a part of related query.</p>
<p>The data for each page seem to be contained in their own JSON files, which are fetched on page transitions. The funny thing is: <em>this is perhaps something you could also make on your <strong>Nuxt</strong> setup</em>, but neither me or published articles bothered enough to try doing it. Besides, why waste time trying when it&#39;s already decently handled by a plugin and <strong>GraphQL</strong>?</p>
<p><div class="image"><div class="image__container"><a href="./no-bloat.png" target="_blank" rel="noopener"><img title="No bloat" src="./no-bloat.png" /></a><h4 class="image__title">No bloat</h4></div></div></p>
<p>The generated <strong>HTML</strong> files theirselves contain exactly what I expect: <strong>pre-rendered content</strong> and <strong>inline Javascript to hydrate Vue</strong>. It can be somewhat excessive for some content like code snippets, but when you transition to other pages, you still get a smaller <strong>JSON file with one copy of the content</strong> instead.</p>
<h3 id="about-vue-components-in-markdown"><strong>About Vue components in Markdown</strong><a href="#about-vue-components-in-markdown" class="anchor-link"><span>¶</span></a></h3><p>The amount of trouble, the bloat, and hacky nature of making it work on <strong>Nuxt</strong> made me think that putting <strong>Vue components in Markdown is potentially an anti-pattern</strong>. <em>Shouldn&#39;t we focus on plain content in our Markdown files</em>? In desperate cases for something interactive, I think embedding external <strong>iframes</strong> may still work, otherwise it should be put before or after the Markdown content, as part of the actual page component, which has proper access to any other components. I could also imagine just making entirely separate pages that don&#39;t rely on Markdown content too much.</p>
<p>One of the reasons I needed <strong>Vue components</strong> in Markdown files is so I could wrap all images into <code>&lt;a&gt;</code> links that would lead to full-sized image. I wouldn&#39;t like to type that manually every time because there&#39;s a chance I&#39;d forgot to change the link in case of edit.</p>
<p>The solution that works for me right now was to make a small plugin for <strong>remark</strong>. A small function returns another one that will accept the incoming tree of nodes and produce a new one, only wrapping the Markdown image lines with <strong>HTML</strong> I need. I suggest checking out <a  href="https://unified.js.org/create-a-plugin.html" target="_blank" rel="noopener">unified.js.org</a> for more info, although docs and examples may seem vague.</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// gridsome.config.js</span>
<span class="token keyword">const</span> unistMap <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">'unist-util-map'</span> <span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">addLinksToImages</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token parameter">tree</span> <span class="token arrow operator">=></span> <span class="token function">unistMap</span><span class="token punctuation">(</span> tree<span class="token punctuation">,</span> <span class="token parameter">node</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span> node<span class="token punctuation">.</span><span class="token property-access">type</span> <span class="token operator">!==</span> <span class="token string">'image'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> node
    <span class="token punctuation">}</span>

    <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'html'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;a href="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span><span class="token property-access">url</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" target="_blank" rel="noopener">
            &lt;img title="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span><span class="token property-access">alt</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" alt="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span><span class="token property-access">alt</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" src="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span><span class="token property-access">url</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"/>
        &lt;/a></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token spread operator">...</span><span class="token punctuation">,</span>
    <span class="token literal-property property">transformers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">remark</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">externalLinksRel</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'noopener'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">'@gridsome/remark-prismjs'</span><span class="token punctuation">,</span>
                addLinksToImages
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Interestingly, there&#39;s an <a  href="https://github.com/gridsome/gridsome/issues/39" target="_blank" rel="noopener">open issue</a> on <strong>Gridsome</strong> about supporting <strong>Vue components</strong>. So far it&#39;s been awhile.</p>
</div></main>
    
  </body>
</html>