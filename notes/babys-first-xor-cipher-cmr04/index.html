<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Baby&#x27;s first XOR Cipher in Colin McRae Rally 04 - suXin space</title><meta name="gridsome:hash" content="2fa2a2273162d40fb9fb1d73adc838b2da53e129"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="I was asked to look into resource file with codriver lines but they turned out to be weird"><meta data-vue-tag="ssr" data-key="og:title" name="og:title" content="Baby&#x27;s first XOR Cipher in Colin McRae Rally 04 - suXin space"><meta data-vue-tag="ssr" data-key="og:description" name="og:description" content="I was asked to look into resource file with codriver lines but they turned out to be weird"><meta data-vue-tag="ssr" data-key="og:image" name="og:image" content="https://suxin.space/assets/static/terrible_spectrogram.386961d.9dabdcde7633644d95ec827cdd51444c.png"><meta data-vue-tag="ssr" data-key="og:url" name="og:url" content="https://suxin.space/notes/babys-first-xor-cipher-cmr04/"><meta data-vue-tag="ssr" data-key="twitter:card" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" data-key="twitter:title" name="twitter:title" content="Baby&#x27;s first XOR Cipher in Colin McRae Rally 04 - suXin space"><meta data-vue-tag="ssr" data-key="twitter:description" name="twitter:description" content="I was asked to look into resource file with codriver lines but they turned out to be weird"><meta data-vue-tag="ssr" data-key="twitter:image" name="twitter:image" content="https://suxin.space/assets/static/terrible_spectrogram.386961d.9dabdcde7633644d95ec827cdd51444c.png"><meta data-vue-tag="ssr" data-key="twitter:site" name="twitter:site" content="@suxinjke"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.3e02e484571ea542be4c61bd4c753472.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.3e02e484571ea542be4c61bd4c753472.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.3e02e484571ea542be4c61bd4c753472.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.3e02e484571ea542be4c61bd4c753472.png"><link data-vue-tag="ssr" rel="canonical" href="https://suxin.space/notes/babys-first-xor-cipher-cmr04/"><link rel="preload" href="/assets/css/0.styles.045bfa50.css" as="style"><link rel="preload" href="/assets/js/app.e080a059.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--notes-vue.acd1227f.js" as="script"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.6db55c6c.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.7ca33cca.js"><link rel="prefetch" href="/assets/js/page--src--pages--notes--index-vue.ebaee131.js"><link rel="prefetch" href="/assets/js/page--src--templates--items-vue.564c134b.js"><link rel="stylesheet" href="/assets/css/0.styles.045bfa50.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript><noscript data-vue-tag="ssr"><style>.js-only {display: none !important;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app"><header class="header"><nav class="nav header__nav"><a href="/" class="nav__link nav__link_exact active"><div class="header-text"><div class="header-text__icon-container"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="home" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" class="header-text__icon svg-inline--fa fa-home fa-w-18"><path fill="currentColor" d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"></path></svg></div><div title="HOME" class="header-text__content"><!----><h2 class="header-text__primary">HOME</h2></div></div></a><a href="/notes/" class="nav__link nav__link_expand active"><div class="header-text"><div class="header-text__icon-container"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" class="header-text__icon svg-inline--fa fa-file fa-w-12"><path fill="currentColor" d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"></path></svg></div><div title="Baby's first XOR Cipher in Colin McRae Rally 04 - NOTES" class="header-text__content"><h3 class="header-text__secondary">Baby's first XOR Cipher in Colin McRae Rally 04</h3><h2 class="header-text__primary">NOTES</h2></div></div></a></nav><h2 class="header__logo">
            suXin space
        </h2></header><main><div class="readable note"><h1><strong>Baby's first XOR Cipher in Colin McRae Rally 04</strong></h1><h3>APR 05 2020</h3><div class="note__content"><p><em>It's expected you understand programming and x86 fundamentals for this reading to be any of your interest.</em></p>
<p>I was recently contacted and asked <em>if I can open <strong>.big</strong> files</em>. Whatever they were, one of them was also provided to look at. It turned out to be a resource file that apparently has pacenotes for one of the stages in <strong>Colin McRae Rally 04</strong>.</p>
<p>Due to <a href="https://suxin.space/notes/cw-reverse-engineering-models/" target="_blank" rel="noopener">previous experience with resource file parsing</a>, this file seemed easy to understand. It starts with <span style="color: orange;">magic header <strong>BIGF</strong></span>, <span style="color: green">amount of files</span>, <span style="color: blue">file offset where the files contents are located</span>, some weird <strong>timb</strong> I don't care about, and then the actual list of files.</p>
<p>Each file entry is also simple: <span style="color: orange">file name</span>, <span style="color: green">file size</span>, and <span style="color: blue">it's offset in the file contents section</span>.</p>
<p><div class="image">
                <a href="/assets/static/big_file.0887cd0.5f324622bc21cc32e35f422084bcadf5.png" title="aus11.big contents" target="_blank" rel="noopener"><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 876 199' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-1f33cd0b403a44fd3924bb68ad7dc3ef'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-1f33cd0b403a44fd3924bb68ad7dc3ef)' width='876' height='199' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAPCAYAAABUZ8lnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAI2ElEQVRIx8VXW6imVRn%2bPFwWlFdChRUYJGIjiCQ6mRBRV5oiGEZheWCkKbqw7AAJdVVE1IUUgUHpRBeVRIFMM81B9sxojLPnsGe793/6/v87n8%2bn//T0vOvb45DaTTftYbHW/613vYfnfd9nrdHOjRx4loXpeIqZYWI4GGO1WkH%2b1us1B/4vo7f/v8qu37H%2bb39akOaoihh1laMsM/iei8Vywa0lD/bzaiXzHOsVx7rDUo35W2OFK%2bsOC8qu1issV0v%2b5llcmfmPc69P5hV19XNvqx/93lUZma/srffOr9%2b2t1j0fvZjoYb40%2bvu7S4W9GP5zqHZZgddn8P3FwjDJeJ4ha5bwfOWyDLO/F5VgO0AWQ5EAdDEQJsAhU9YMn53aZJ7BffWlcwtumyBJpkj9zs1x3aLLO7gui3ybA7DbGivhcXZ81oEYYco4l4x57pFXS8o26Dgb5GLeDZNuUfdeT7nmX7P5ywZNswlbHeNyAM8HejoT%2bJ1cKi/rhY94Aqw1d7owdPCgEJ0zuYI6GwQztG2cxRZwIMlQSjR1j6SYJPBnsYsOoJ/hIdxJn4NG9FpnElP4YT/qppPpSdx3PVxbLbACeo7brY4qjc4ZrR4ZdJgGC5QlwSwoXPpmgEQvGzNgMCAweDXaNp%2b7rp%2bT36XPFNwlAJu0Z9PeV7mqoYKzrZMBM4M286bODk7h8v5m9g0a2xOWiTVXpvsjf9sAQIgwbtux2zUcD0RCWFe%2bCiK8fWoRu9FOboOzkUN0DUcHWr40JaGj1zW8GH%2b/uBYw02X%2bI3zB7h326svYP/hFHeftDlc3HNkiv3HHew77uF34xCVP2QQIerMRpZaiMIZGpbSvI7hOiOUXJeRyQS4GE8uouRcpw7iaIYktlDnHtoyoOyQYHooYx3LuYl/HXk/rA0NB17TcCP9ulm/Fp8%2bfR6fPNnh92ODJaojS3Zhz17H%2bTdeQRrvoKun0CT7U73GdNrAJgCmzR5eVLB2n0FmPIHCeBqFeRD26Idogxfh%2bC/jj8YLOGT8Bn/zD%2bGf0V/xl8kfcDT8O474f8KGNcCxgY%2bzTopzHCdJsmdNH5tsIcv6BexzGgG9HuXwGkTbGuIdDcXuNSgH18IjyMVAQz64BvVIw%2bwNDRWBLQmsT8CjN/t1xT3rwnVqnU32KY7KvOfReT/F6fSX%2bG3yKxyKf42XDQsvzYBTW08hoO6UtvTXNTibGjqC1FG3ZhoszWGFyaTGaFhgpAvfbWN28Q6k%2bn00cC%2bK6X2YXLwbrfFZGMYX8djOp/Dg4C48rd%2bP7zuP41vbX8KzzmN4dvo1PHv%2bLJ7ZsPCDCwFHiGdOTfBjRv%2bjizmOTQ7DuvQIcvubyGdPwx0%2bBXPnCaSTA2q4w8dROgeR6AdQuQcx2/4qSusgx9fhDJ5EQJmcCansg9AvU9Z%2bEonxM6yWOWr3K1hbD%2bD5rc/j/q178WVzP757YQPfOw/8efMQZpe%2bwSQ%2bh9HF7yCcPofC%2bwnPfxua67SYzRoG1sA0K16F7JPuMpzLH2Pwt6PUP6GGtX0ruunNMMY34OGdj%2bNzg9twz/BG3D54D/ZtvQ93Tm/AHYMb8OCZI3jkeIhHz3h49LSHh08YeGjDx2dOOHhpXCP1cuTs50oINSKZBSQzEmnBfo%2bSVc8FnFtygGUzMPZvxb4Xkoz5vRS%2bEFJ2S0XOeUoGWLho7DsB8yb8fPsW3PXGLXjAvRUPnTqML2w0eHE7gm8VCKIlk%2byxzRt05MWOF4XmuT0AJglLqmE661nVcSuSEZRBISHHrVGVS7RFgpLGU7ukownJyMfUMUhSGdchezZF6AeUKzCndz7XCRWlSUY9JdtgRj28erOYfR3wlnFQJBHP8Xccqus459w2FbnJYPAZ%2bz4l%2b7tqv8wS9n7GW8lUenKelWfLnIAJYS7LBSIjU7dhFlIPUUpC%2bjjVEQYexsMdzi6JvqaNkteg1WA87jlgOGArkLWFK01jSpKKlTMFjRomHWdQJe/C8WQMh%2b%2bFKssYKPnCtAlUhZJBpgTFchxmJkXJYfGRlcQxKq7lvE5HSlJ6QTnf9xmITRsxsigmyC4JslDrio7PZrRJ8MSO53m8DiOe6/XMDEPpSSMBQG4NXr0sGwluoI9ZQbz%2b6gbz%2bYJnXYzGOm%2b5AFP6HgYEhrItrxHN2gNAOEBVAIcoNE2DGc3oXIKC95RhmnsAZLw2bd4aHu917qUEh0GqK5OBKAD4aCh4VvYEgICO53S8zN8NAIeZitRZCbCinpSZa9gLBn0o81wBIPbeFYCwB0DkS96TAvZ4PFZgGNMpbcfqcScAiI7Bzg5nl7JS0WXfAn3/9y1g2516PrqSxbwPuKRByU5FA3WRqwBDyRKroaHDrucTTToggEm2GJhUSpX3jifitATC85ZlqlmCipg9caZgdciIInmRVqq1mkZ8IbB0sqb9MAzYAonSK98EONEjsgLAnA%2bH%2bXwJ37UxHI35ylvRl1xlOuLZ6XSmAJQKEOA7EkDXtldJ0OSLacJK0PVGAeCwNDMqkKAkC8pg0TsjTodRojIlQcqeZEPAyhiIy3LtZXMFQJwkaq9%2bGwAxA/aDQAUv%2b1F8FYCWzlkEQLJd034QCABxr4ffbFah2HgLAJJAy6BK2jQtWz19EwJW86WkACC7RwRguLurdL0FgMHgdwf9NXh5q8DObqU4QEhDMpcxS5JVneUkJSx9PdV1OsDHCXuqokFdnyq0RVZKUP5TJc5VJMQZDYtB6fOCMqPxiC1VIKes9Kb0diJEyb6UdskZbEp5qTqddkqVhFTZ8ykjeqSaJrJHPXJWAJB%2blrIuFTgOA%2bwwY9YjJsplMscTXfX%2bhPaFC6qqVonQ5PlrWa16DssIgrmqAN/3SEjlXumWqqwFzUbKj46GzL6g3zWNCkJllbLCF9LzqndZHTFBbEnPstfwvOs6So9kMeH5IPD3ZAtlr20bpXc%2bnysfpCLEZkzAhJOkIhp%2b87zeH6kIRYLMppS7R/0S7ILkF/B8mtFOHLHCTQIQ8RocqBZo6JPwxr8BvXO60GhhB/gAAAAASUVORK5CYII=' /%3e%3c/svg%3e" width="876" alt="aus11.big contents" data-srcset="/assets/static/big_file.368578f.5f324622bc21cc32e35f422084bcadf5.png 480w, /assets/static/big_file.0887cd0.5f324622bc21cc32e35f422084bcadf5.png 876w" data-sizes="(max-width: 876px) 100vw, 876px" data-src="/assets/static/big_file.0887cd0.5f324622bc21cc32e35f422084bcadf5.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/big_file.0887cd0.5f324622bc21cc32e35f422084bcadf5.png" width="876" alt="aus11.big contents"></noscript></a>
                <h4 class="image__title"><em>aus11.big contents</em></h4>
            </div></p>
<p>I managed to extract one of the <strong>wav files</strong> quickly</p>
<p><strong><em>but it didn't play</em></strong></p>
<p>Here I was once again thinking if I should just give up here, because I could be dealing with some kind of compression or encryption, something I didn't have experience dealing with. I still had enough drive to atleast try to use <a href="https://www.audacityteam.org/" target="_blank" rel="noopener"><strong>Audacity's</strong></a> <strong>Import raw data</strong> feature. I tried to import the extracted data as <strong>Signed 8-Bit PCM, 44.1KHz</strong>, which resulted in this <strong>VERY LOUD AUDIO LOWER YOUR VOLUME</strong>:</p>
<div class="audio">
    <audio src="/audio/babys-first-xor-cipher-cmr04/aus11_001_borked.wav" controls></audio>
</div>
<p><div class="image">
                <a href="/assets/static/terrible_spectrogram.c70d8de.9dabdcde7633644d95ec827cdd51444c.png" title="Very noisy spectrogram of extracted audio" target="_blank" rel="noopener"><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 501 154' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-a39acb17c1dd055817ebc7e63965d04c'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-a39acb17c1dd055817ebc7e63965d04c)' width='501' height='154' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAUCAYAAAA9djs/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMU0lEQVRYw1VYaVcbVxLlb2bOmTNzZjJzMlntxI5jgm12se87ZkcIxCKBACE2Q2xWsS8CDCQYjI0TJ5ZtvUaxUe7cegUTz4c%2brX79lqpbt25VK8nv64RcPrn6Onj3wO/v4tV5ef//q7/fi8BAt64Z7ENvsB%2b9gV70DvrQO/TBNcCx4X79HejTe9Cvc6/Ghv36e7Dvz/tAz%2bV%2bl%2b%2bv3l39vro%2bPGvo8p2sC3ywh9yv9r3aTy7O6aO9Pr8XSd2%2bVvT4Gzm5GYEROj3UBm9fA7r9TXr5GvX58u7urERLRxV6Am3w5X6NkesfIVh2G8G8rxFM/wzBlI8RzOC95i6C3/0DwVt/R7DoJoKpnyCY/C%2bd5/pSx1L%2bybmfIphznffPESzkWG0qgpUpCOZzXhrXZH/B99d0vawpT%2bbYl3qG65qukzMLbiBYwXWl3yFYdUfnlSXreXc/1TVp/0Hw9scYKbyBIe7f1VmMpObuMAbGV9AfDKPBMwl3fxj9oR08WnmBxvYg7nc%2bxPJeHBUNAVQ3BTC9eIh/f56G0OIzvGr0ABlZuCivQqKkHBe5RbgorkDClYtETiES6S4kGttwkcPxu5lIZOdxXhkS%2bSVI1DbwmfMaW5GQ9QWlSFTUItHazjkVuEhJx8VnXyORlWPXJ1IzdG16FhIeLxJNrbhwFXAenws5XsP9quuQSONzZxcuyqpxkZ6DRFkVLtK4x/epSFy/yTEX/uD550WlONjbR5I/tIbp%2bQgmH64hMBbG0OQqpuYeY2BkDkPjy3iwsI/lnZ/xMHyIB3MRhLdfYHr5OR5tvsQRnYs31OPtvVTE8gsQKypGLC0TseIS/uZVVY1YdQ1iGRwrLEKshr9LOKe6FrHyCsRuJSPW3IbYYACxlHuI5ebyXbWuv9%2bAWBnnVFYh1u7mGNfV1XFOHq98xPK4Xy2fCzl%2b7Qbfl9KGQq67j1hTk56bnc15tOteBs%2b6rWcW5MPQtlcdHmxvbSIpHHmDgbElDExs8r6M8M4rLG0/x%2brer5ha/JE5swh/KIzZjRdY2fkF6wdvcRQFNp4kcNzhxe80ytTfh8nKhUnPgGlshGluhSmrhKGRpo7v0jNhaLRTXg7jyoOprNE7GWDonOnutkYZOmNqay/3aIEpKITxePS5rR3mXhrM3XSYzGyYlDswVVUwdNSQGSaDY1Xyu5T3aphSjjU06DlpuXAyadut72E%2b/RJOVjaibg8iW1tI%2bmH5JTy%2bKdS0DKK0zovJ8Anm1p5iYfM5Qg93OC7U92Hk0SGWdl5iZvUYo3NPsHQYx0lpJeKCNmkV%2b9sndJKHMQomjygz4oZ0NAV0KjVdHcwkEDdpBOlsjSbdLUAdHTA19bwIZjHHSXtzJxWmhSAwgobMsk7JfumM6kf/UDAqKnReDoFM5d5ki0OGOWIHo23PkTkVBCqZ55YzKLfvwPnmFqJ5hQrAo/XXWHn8GuuHDjZ%2bimNp9zVZ8BsWI79hae8N1n88x9qB4fMrzG/%2bjEGmRU3LKCYWT3Di7kJcaE2qmhQaUlmph9bUwpHoSMRplDU%2b0wWngc62kB2uHGVNYYlGv6HZrjF%2bvzorUZV5XV4CWqB7yN7tBKy0QkGSPZkq9hIw6ZCR1CpkKhTz3LJyphVBok6Y5BRlRmG5nXvuciF6vxGR9XUkrRwCC3Ru5xmwcwrsnQGRp7DPu8/1eXn/HNMrZwToHcZnD7D82MHa0QVO6poQ50HWmeZmRb3mkpLi0Hc8%2bHaKsiAnXyPt6dL3nk44QvdSrqd4GeazHZc789M639NHcBqVWZJqPMPxdCjYWXkEuVLBESBT6WwmNYSCarp4RkWlphMdtcz59jbtSYZpamQK5CBK8bYMWDkAVndfWMovbD7D2uMXSMt7hvvuF1jbf27HF7fOKH5nWCNLegKP8NlXqWgLLOC0y8cUaEasu1cjJVQUEOQuqAutaajJzLo0qM6C4AhYwhqht6QM9cHmOyNodYAAOJL3AshdOkYRNY1N9nJaW5X2wgIKpVPIPep5DiNv8kl/AcRGm/vl5Cib5JLzJS1pi8PzorX3EdnbUwasHxqmwVteMVI%2bht5QDKGZGCMeY7TfYpUpsH18gTDT44flEwLxDsuH53ha34x4fr7mrhhVRqMkAsl3VKREGNOyVdAkHSSKMj%2bHRre54YyOKpX7/DqHjkrq2HERv7QMFVQRys5OTQGfX8ET4ApKVAvIEKe4SH8LY1jiTH8/o92s6UWdskBKABqacM4gRCceILLJKrBMBmw%2beWdpvy3XCXD4EiARsHWiqbBMLZjZ%2bJWOxxGc2kBD5zimls9wnOpCXKIoiF8ZZUWrSBkhvyX6osgV1RoFibSAVEujqMSmltHz9vC3W/NZgBCgJJLiTG%2bfUloYILpQV690/stfYb66qeqfQ5bdo9DeuKVnyVxJIVkrlUDWXfuWQBXYuQ7TNkpwbAqE997j4epT66iAsCsO75MVP/2pCQtbP2Ns7hCrBCD0MILhH/Yxvx3FSVM74h2s0V98Y9XZsAEy39y0SqyRZvlxt8Pp6VGdEJCyXBoRAUTKo2iDABIMaupIuRMhFG2po/Gs61bFWeetNkgJFHDlPXsDmzLlHwJbB8fnI6jdmv8E1hFxlWojAUjPslUiSoZFIhFhwB8Ib51ibv0U8%2btPWf%2bfIyXrKZVeeoGntiSKBqzsvmRVeI0JiuDEAsf2Yjjx9CHu7dIoimPipEQtLV3rrxgmuSllUPKcEbdgSETEyKIy2ws4Lc1KedEPYYCkkuwlKSAR9Xp1X8l/KY1C7XqCyKbJFBQpsCK0Le2XNG/Q1Glp0/Sy5bZewRQhZRpE%2b3o1BTaekPbH77F59M5SfPv4HaP9Ho/W35MBCWw9uaAuxG0FWNk3TIFNCuQ4JsKnZEAr4uIYo%2bGIA%2bzkTHePilcmBaiKxrD9NZ9fh/n%2bri1hzvCwjYQjTknq2IpRo3kukRoZseJmS%2bWde9rcjI3ZaDoTE6o3limc7%2b5QxgjlJX06qBOjY6r%2bBMwZuNQBWePnb/%2bAFWaHZ0Z9AS2D44svKW5vsLj7llpANvC%2byGjPbvzCpuiUbe8ZVn98Z1NE%2boKp8BNsHbMTPP4DJ14yQKIvNVro5uMh7MNtD0BFNs0dSkX2%2b6aZqdDGe/%2bAlkIxRiIoZVC0QAyVRmZgQHOa%2bepI7vv6tHyOjcMJBFQMs9lTyF1YUt9g1d0R1gh7JADirIAljBLa5xcpuLKGTdo5wYkOh8gAakBt2xRaeqbR3vsQU0vP4BtdgWdwHt6BFVQ1D6LRHUL/g11ECICUQd/wHIprejG2cIwT/yDik5MwgcHLHKcz6enWGSdAR4iyGWZEe0j3FrfOE2Eao3G9vUpTYYBQWIAQlZcxKZ8yXwAQOkt6yVppsqQRIp0daaDaCVxnt54r2iBOuvJVO2wz1UYQ6bSknbBD0pJ2OgQo2utTEfT0ryI48xjtvln0jKzB7ZuD27%2bIwPSBdVqivUYGRCiIUhIn5g6wxEZo5YBlMBBEXOjJy6HxjlBZIiyREhZYLXBpdEsvRWxqSlkxTNEbJxDuTjVc5gwENIoCUijEOcMqmGK8refsMAeHeN6kLXNW7Obmmec%2byxAj5VOYKE2YpI4AdNUH8GPLdosUw3MyNtrYgsj2NpKGH%2bzhAT9xA%2bNrZMAxP4NP4e2fwdj8EfZZAXZO3lMH3tmKIH3A7PoLnJ0TFGrCT/wE/V3ERfK/06t53NamjY7UdzEk47IMSmMj5U0YM0QnQqOa6yJ0QvEmOj4zo9GSSwS0Rrs/e%2b8PqJP2w6nYllwL%2bFXFoEA6Alprm84REKWTZLtuvxPkfEmJEn4Ks3GKcq4FYHnvHJtseLaO4ryT4qElNkRRbB%2bdY2UvyusVnX5mAVg74PuReRRUd2Ny%2bRlOa9kI1VRrkyP5NTKmOkAnnblZdZwly5EoCs0ZCdvh8dkZH1NjGRlHWCFCJtEXdojSi5CJE5LjAoIAK5%2b/MoeXI5Wkr%2b/PllnWSckbDalodvYo4wRo2VuCJMIrAkzdijI9IlsEYHbjDT%2bA%2bAm8G8X81i9IySjD0FTEfgCFOSafxzNrz/8HgD%2b0gOySNozMHeGsvZOCUq%2b9uOSuCJsImjQxks%2bSv/Kui8Z5vGqM5Ld0fIODWppYlzVtBjWSsl4cluoipe/7O7qH9BhivOzb3afdnzBAWCQ9gtzlvwVXsVaE3EK1YShogbaiKeI4MIjz6WlEZ%2bctAP8F39ny76%2beEHkAAAAASUVORK5CYII=' /%3e%3c/svg%3e" width="501" alt="Very noisy spectrogram of extracted audio" data-srcset="/assets/static/terrible_spectrogram.c70d8de.9dabdcde7633644d95ec827cdd51444c.png 501w" data-sizes="(max-width: 501px) 100vw, 501px" data-src="/assets/static/terrible_spectrogram.c70d8de.9dabdcde7633644d95ec827cdd51444c.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/terrible_spectrogram.c70d8de.9dabdcde7633644d95ec827cdd51444c.png" width="501" alt="Very noisy spectrogram of extracted audio"></noscript></a>
                <h4 class="image__title"><em>Very noisy spectrogram of extracted audio</em></h4>
            </div></p>
<p>This confirms my concern that it's either compression or encryption, <strong>but the voice can still be heard!</strong> Which made me think it's probably not very difficult to deal with, but that would require me to figure out what the game does with the audio file.</p>
<p>Fortunately, I remembered that I do have a copy of <strong>Colin McRae Rally 04</strong>.</p>
<p>Before setting up the game, I opened the extracted file in <a href="https://mh-nexus.de/en/hxd/" target="_blank" rel="noopener"><strong>HxD</strong></a> to also notice it doesn't have any <a href="https://wiki.fileformat.com/audio/wav/" target="_blank" rel="noopener"><strong>RIFF WAV</strong> header</a> in it, another sign of compression or encryption.</p>
<p><div class="image">
                <a href="/assets/static/wav_encrypted.c84a8ac.2c513bd7fac1f0205d8951cb89ea7990.png" title="No RIFF WAV header in the extracted audio" target="_blank" rel="noopener"><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 620 279' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-6a46f0773d920ddbefba47acbf038077'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-6a46f0773d920ddbefba47acbf038077)' width='620' height='279' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAdCAYAAAAaeWr3AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAORElEQVRYw91ZaW/cxhL0///yfs0DHoIgTmJLlmRde9/L%2b9775B7cTlUPuZJjO0C%2bPgMbUsPhzHR3dXU182F/OEjdTWWx2spuu5HlaiWTbCKr1UIs25XlcimbzUbW67Xk%2bUGKopD/p38ftsej/Oe/j%2bLHc3m6/SwPTzUZdoYyHvXkl483Yg1G8vhwJ0/PNTkcT3I%2bn%2bVyuXz3K4p/N/b%2b2T%2bNXX4y7x/f%2bRfn%2bcCIrtd7%2bOLyjWdO5%2bP37roUcjod8eIZ15Nei4JOOeHhWa/F5fTt2E/m/X3s9C/m8crx93tU95zLH5%2b/f7ca4/WIQHId/j6osceLpOlB4jiXxfIE2J%2bQDoUs5kfZ7M4w/CKLBe63ZzkeCqQHFoW/Vpi32WDsWMhsdsT1Ims825bzsuyATS46b702Y5zHseXiJKv1SccmkyMOeZE59yvXC8NcDnjGs3A93ic44wnzptMj5sIAzIsiM8a9J1PzPvdazI0dG9zn%2b0LH5jNzXhPMMgX4nyzJ5evXpbw8ruQR11p9I85oJ932WvrWXh3Q623F83I9eKezkW1eSK%2b7Fdve61ittlaDRoOdjMY7dd7Ly1od2OtswSd7NXAw3Mke73axhov1OO/5aSU7zKu/rqXZ3KiDf/99rgb0sUcII%2bdw3KfbhWwx7/VlhfOYPe7vlnKEQ9fY%2b/PNXN/v97fyDDvuvizEsXOZT7nHEs/59/7qAE2By%2bXH5MCIFGWe6PwLIVbgWkih6XHRMcLKuPNyHXtzcVGOIW3kXP59vj67vLsvd72%2b8/buSfc0f79/9u7%2bZ0aoHYd36W3OuNvtlMuuCCDE2u0NIrqRbtdcGfFWc61Q47/np0dpNFrqEKvbky0qw6A/EMvx5LDfS2g7WGcrg15L4mwq%2b%2b1OAsuWE6rMoN%2bXMe4P2NjXsRxocsX2Atljncg1azQbDQnCWHKsE3u%2b7DG/3W6LH8Q6zx87csp3YjuO%2bGEi58NeYjw7gcgP2GfY78psvkKKEfYHpPEOKHxBOkVYK1c70jSV29sbSVDpinNhHHAAJIMg17zjj/cp0iJGzq3LnAl8XxcqQCjL2UzLYRj6EiepGrmaz%2bWMsTjyZb5c6dgcm5xAOBHmLVZr5HsukxgHPx70IOYQR1nOF2pEEPiSTWfqoBmek9xs2wJHzGSHMjxNEt3fcWzJMHbM9zKJYjWEEZ1mKc6TiD0egy9ScVwX6RPj/ak6xYdTPT%2bQ6SQT10EAUObVAfv9WcbIW9syPws/z0EuI/%2bXKwPT0WiIxSI57rlpCGMveGeIiIUY20kWBpo2rj2SBIdjRGMc4Hg4iu9aknIsh1MRbTrAdW3xglCKI5ySZOqwXq8jLhzNeyKggFEZHZVOZD2bYszTsfF4JD4MoQMSzDOVQSTCuwMY/wq0DkYj6Y%2bAUNuWEPsQDb3eQPqDoXSAql6vL0P8rQ7I4QAa7Th7JYnqOgIRrlYGAYyEiTbQASSoYTiQH0R64EkcYR2%2b60gARxHuszSTAofrIQWGlqXzZjCmQCkN4DALh6cRGdYjAlzXQeWY6ruZRvaMc4zLPbAvDGFa1Os1mS8WOo9OJgIOeD6G8dbYArl60m415dMfn6XX7uDZSREbwGn1eh12jaVRb8qXL7dvKeB5e4W%2b75sU4N%2b2vbuWDS5cwX0Sxyg7R/Fw4ARGHhHZjEbj6ujYRPLdVlY4JDmDEQtg0IFjgPsFhyGiOHbStDB5bMNJYTmWAVmMrIMIct/D3sCdaUSuSOEoOo%2boUB2Anwd09YGiPriJzmjU6jKEkKNzUqReA%2b/Ref1eT/mr2WyVKYDSMhxsNeL6G27V%2bA7IkKWI/15fXqUJ6NABCaB2xLXTbqCc9Q1kXUNaj18fkF9%2bCU9PibHdbasRS8DYh/f3uz3e7SKyoSFQa6zrNRqvMhyOkSJHyUrYPjw9ycgh%2bSFAMGq32WHOSDlljpy3YQzVYo7nD/c38ufHP3Am7Jcm8vtvH1GSh%2bqYZqMmz3DIC9brtJvi%2bKE654oA3zcIqH4hfqzxFD/kAB%2bLRPAioz3l9UAEuBAisY7NgQRGbDQc6jxGkQekYSPknQcY7zZrzVmOkRhXm62SW1JG0cJhoyhBBdlgj/hbwoOjZuCKHHtZcMRiudZqQfQQ3iS5VrOOCtZDEEcQZEvlFO7LCpEhAI1aA88s5Y85gkGUfEuC9hsJOrhnSaw4wILXSVA0llBUuKOkab7v9wayiByhpfme58oBHHt5esa8RLbLhdjdLrgCKeYMZTJfynoxFxfv0CmEr2U5sp7PlARZtscwhg7N4TyTZnuItgcEKVSnpEGglYb/XMfWKtCqvSLfQ5miMiUw3EWpZhkcgouen15QGmtQvZHUUCKvDqhIkE7Qq2XSYbU2CGBpieBtk4vRNbJxiQqSEVOg0ahDkk51LET%2bbhHhQa8LSKYmZzFvh5reQj6yqmzgFAcHI%2bx7cA4dwHtWi6NGeySh7rtTYxnNJPRkDYNULyD16ABKnAFSje9zv5ubOzRxXzXvPThzuVjKGEFkgLqY93h/D43R%2bp4Eqx/J0LqS4EWCKgVIWqUDEnhxgrrNMeYsqwAJpiJLoiKHU2hYlT40opqXTacK9wg5rjXfGisvmGqRagVhZeB6WvOVLE8SQESlqO3HvUHZ%2bWyUZBoFMHCoeqVZb6hwe0FJDCGuWLEc1H7yAX90BNf%2bAQluAbsdJmxVHZoUKOTL7Z304EHWcA%2bwzHHwJI3Fcg3hRVisKmWT6dzoAMegoo6SNJ0abRCimtApzL8EOc1SRqeQU1x7KFPk9h6RpYpktWjh3TbyusDaEda7oDQSZa1OB0rQ6IVzqQNGwwGM8yGyYpzDRS/TlS%2bf/5S7m3t1rgvHdXtIKTiInBbH6c9JUBGANKhIkDmTqLI7lOXogDkeytHEECNyjwfJQHxRYkqj6gAcWDcH8ZzLd7XkqV6Idax615TVtByLlVRZGl3KYqQNq8%2bpLL%2bqF5AWRGOl6%2bfIeRpOxcfqQ/WaZpm0oAU8OC/FeWykFNcbDfrggtcfkKC90/s4MrJ4sTiZFECU4vSt9pIER1Baniqy3Ci30wHv2zA21rJFjc8o9vs9eL6vEUuwDo3tdjsyxqEqgUPDiIrpzKAnCfxSG9iqKzYgSxtIYPqw%2bhj9sVeeYTC0q4XzmPPtZhsonKC7fNXz3d09oKscwGl0AEnaxrM6usW7v5Fg6QCSIP8eIC0MCQpqa0e6yBut0ZS/gGwYODJHPeaBF9DXJ%2bSi61hXVGSaz0esNTIyOjcqUnuBLAG5JcrkCQ5J53HMD2M1LAWLMxXqrzWUxlQRwPJLEmw0GyiNEx1TaU0OQNfn4N73kYLoVR4eHuTl%2bQmtfR0N0lwspO1ysdJKwIA8QQ%2b8PL28S4HvSJCy9p0ShBQmiTAFTKPC5gIExUiQtABjfmkJEeGKA3QeHBaCnJIkMcQYRdduMGOToumT6rpMKa7Hd9VYOGKAwxr%2b2KnW0K4PKnIGRUm1yX31E9kJZ8beHtDJNGiABHle3lOe8zqfLTQVKNaeHp%2b1RP5YCZZqsN3a6BciJRjCPSh1QBxqCz4coNlgiwqDSIJMCx9X5vsSECSR4WSAIQ2baNOkrF0Kpip9mNskyy83N9LFmiuIFCU8bDKEA6j8jNw2qKAOoDhaAnXjVluF0A7OsEc9Gdu%2bCqLbzzfI8bo6rAsOaGBeG9L305%2bf5CMUIrvB2XTxYxJk7rvaEFUkKLh3ADH/SlCMehB4Gh09HJqbQ35A3z/WyDJis8QgYDJJZbHeakSXKH0HpAUdSiVYiSiuxzrNXkAFDp2DMao%2b7nvSPUz5HYDAgrIz5btVM%2bQg/Sim%2bPwJ8LdAoFvI6Q4qSQ18QPJj0GI4kmU0SaIfK0Eaz48i9dpav6XxHz9quF6oDuBBGG12V0pGOEgEB5GgmhAXVW5Pk0w7vwjCJQP8zIcTG/vlOGRX0rI0UgdQHfqA6RZ9AstkqOvttLSRA4yTY/0oyxwmyuiUiX6jKPQrzxBOpaHtVgt81VXkUac8PX6Fc/viw2lD8NgCCJsghdpAxRsJvqsCrgsH9DYgkPWVAwbdvowsR/M4gGdVpYHcHK%2bSx2HpFBetrpHHEQw6wLCX5xccqK8HXuBA6qh6Q0tUFcWqjxigWTLRDjVVqO1tIIBVwB2QhE9o0jpil610iLMoAnB/e3urMH9%2bfpSvYPhOz1SfGQyuYWyA9x/uH%2bQR0rxdN1ripylAR9AJ251RWWTRpNT2Bp6sAr4SyTE/KNz5LIaXqceP7yDLfFPtjjF%2bOdKSB7hPS1RQB6i0RrSVaA%2blXkC02Q7P0DPs0QsQPadyHsny6ijqgOKs5NiBUS2gcAxnju0xWt4mNIcHfhhqSryiqvg4NwVSq9P9GQlur4iYL8qvLTDs2vuXxgwBq7Htmjz2A0UAczYta3SgNRpwRyR6qMM8vIeDnTFGFZlAzJDI9Jsg3m0BFfOyyyMJbmE0G5bqe0DiGccbYhwbAgXrs/rI5aQRv0XNv3%2b4R4%2bx0g8jESsQCHPQH8mvv/xPYlaew07ukRZ//PrbtwiovgfySi0whDO2JQkm0OGOG5Q63TC5D/amuODYm5pDvlMHwEgSHtvU/qCnCq%2bKLMmyByP4pYeOYrlkP8/c5v%2bao7H87kjDKJhmEEfVvLMqSwu9hekP%2bI2hKD/6UglGIGOea0JFinOy7rssgyi7LeQ8KwrRyCvV7RsCUPZIhEQAo89WuNFcX9thNg%2beH2rJoxIkjGl8XMpelkE2Lxk2rVQaeSFHxJogpUybF/MNjz09BUoQxmWDZD51PUOcpPpJbKsSl/8vkmPZxOgAqk2y/QAEF4Wx%2bXSmKXDR/2vFvflRdgzkJZEnQ5v9QFua6B16OP9XdIfsaR6hAZ7BS0Og8S%2bzTlXogLCABAAAAABJRU5ErkJggg==' /%3e%3c/svg%3e" width="620" alt="No RIFF WAV header in the extracted audio" data-srcset="/assets/static/wav_encrypted.c84a8ac.2c513bd7fac1f0205d8951cb89ea7990.png 620w" data-sizes="(max-width: 620px) 100vw, 620px" data-src="/assets/static/wav_encrypted.c84a8ac.2c513bd7fac1f0205d8951cb89ea7990.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/wav_encrypted.c84a8ac.2c513bd7fac1f0205d8951cb89ea7990.png" width="620" alt="No RIFF WAV header in the extracted audio"></noscript></a>
                <h4 class="image__title"><em>No RIFF WAV header in the extracted audio</em></h4>
            </div></p>
<h2 id="breakpoint-targeting"><strong>Breakpoint targeting</strong><a href="#breakpoint-targeting" class="anchor-link"><span>¶</span></a></h2>
<p>Before I could use any tools, I had a problem with the game not supporting windowed mode, which can be easily fixed with <a href="https://sourceforge.net/projects/dxwnd/" target="_blank" rel="noopener"><strong>DxWnd</strong></a>.</p>
<p>The original file was called <strong>aus11.big</strong>, I'm going to assume it's related to the <strong>1st Australian stage</strong>:</p>
<p><div class="image">
                <a href="/assets/static/australian_stage.00c64dc.93ae8521e8386a901bf32b5c1a027077.png" title="Australia, Stage 1" target="_blank" rel="noopener"><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 802 632' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-d75b42540bfa05e32e031b0574b83f2b'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-d75b42540bfa05e32e031b0574b83f2b)' width='802' height='632' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAyCAIAAABj4UpDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALtUlEQVRo3t2Zy29bVR7HAxIbEAgkJEBoNogFYsNDYsMCISEx/8CARjNMNQvEYkqHdugrlBTSDm2HdkZTqAAhFggQLKASVdMEJ05iJ3GefsWO4zhOnPgRv9/vJHY6n3t/5eK6aZwAHQpHV1e/e87vnvP7nt/z3NvW2dHxz7eOdr555F/vHD9xrLPj0MGOw4duquutN9qPth9%2b89BB7oqEhw9Bv33kjeNHO6DbOtoPHz969NjRjrP/PnP6xDuvv7r79T2v3jzXP17dfej1fQf3vQZxYO9r73S%2bvf/ve/bt/tuRg/sBBt2m6740qNcP9uv1Op2%2bV6fQN9k10Nc3oO%2b7ttPQ399z8WJbtVq9/CtsGxsb3NOpVFuhkOehXq/Vf6ZWq/0MU2zermYBQCIRbysVi4Lo16iBVDLZDKBQKCSTydTOG2/JpLFEan55ZSEQabiiyuUPVyoVRe%2bZrD8cD0aS6pUIKHQCOrASL5ZKygyxmH16embG5XA4bXa7w%2bnkstus7nlvqVwR6a8LIB6Pr62tre%2bkwY9OWZXXmGExEJkJ5dzhPNeschVUumBxzYEThlAkHs7WooV6NF8PZ1YDicJKuhIvXg4kS4lUGgaPx6MfGBgyjRqGhvv6B3r1fX39%2bknHjCsUF4YWAFZXV9e%2bb1vTq983YPwAIBhxhrKeSEG5okWXL%2bBwzznnPNNOeyaTgSEcTURy67FCPVbciGbXgvFCMFmKly6H0tVUWmHwer0AGB4xDZvGBo3GQcOgY3HZX1xfSOaT6fSONbC5Qho6mzSwomxwdSlZcYez7lDGNj2N6G7PrN05nVblC8eSscKGAgAl5Nb9saw/nkvmV5dC0UQyKQB0fX19%2bv7ePv3w2LjTFwrlq/54ci64gnXvGAAOr4irdUKo8aB2DYB1FQDOUCoVlwOB%2bSWfc27ObLVOmie7ui%2bZxkzZbBaGpYDf7VuO5qpoAOPxR9KhRME40Gca6EomEzD4lpZc3kWbw2V1uqLFVV806QtHdYN9vf3f4Ws7MCEIolU0Gi1XqwSt1UpFwXb5cjWXS0UiFYarVWGGTdHA2hozLC8vO1yO2TlXcMXv8c7ZHXbjyPAfXnjh3AcfiBPPL3r6h3Vzy0u56uVMuR6Ixmfm5v78pz/%2b9z%2bnisWCgnDJ5/F5lkO4d3x5JeRwTY9Pmnb99S%2bdxzuLqrTbBqCu57RawyMj1XAY0VdLpZzLlRkeNnd3J4JB3tFwagA8855h04jZZnHMOExjo6ZRE9v/7LPPnjx5QpKmd2FeN/hdT3%2bXbcacyqYt01P6wd7nf//8W50dAmBxcWFicshiGZ2etlrtlknz2MiI8cUXX3jjSPtOAGAbau6IRSLFTCZrseRmZjLj46VAYL1er3g8iQsX8m53MRRS2MSJRQN%2bPzYQWlkxI8LYmMFgcEzbjQaDeWoql8vBEAwGl/3LwVBwYmrMYp0aHR2ZdjiGhoemzJOZjOKjoVAwEFiOxSI2m91snjKZTDMzM6OmkWm7VRhaAMCUkXsdA0kk1lQl1Dc26KmmUpVoVMkVicR4V1dmYiLZ25u1Wuu8XavJi8qkqZQgsVqtuOLg4CBGBQycuVwuNzKYzWadTjc4aPD5fEaj0eFwlNQ8AEO1qjDY7fbe3t7%2b/v6lpSWD0WixWmWG1hpgj8vpdOzChdzERKVcVsJkvc5Or29srJbLiYGBQiqFK%2bdnZzEqdCUmJAB4PaM2cmI%2bn881NFkC6TdhyCuNYNDEIIPZXJZRHoVhq0x8xYRqtdV8PmYwRNzuKb0%2bbLGUvd5qsciVMplQBQpRfPdqHxAAv3ApcUUDtVopn7f39IRtNmwJby4uLWWs1tToaGFxUQlEFSUIKXFJ9ZhGAGppWJe7VF3QUolp2pemVWYarQnXxNNItAag2ku9XKmUiJKRSM5mqxHpVSFqatW6rkqsNfiZTvOBm0IDkstqYvr4AD6l2soP94bWZEK4IF6LyWLERD2SF4sReSKRCD0Jtckqmhw3BIAUOYq4aq7dojXlAb/fT%2bCbnJwkBK2srCAusWVqaoqgxJ1QMzExQWiSrHwDATQKuE0AogGCxvz8fCgUWlhYIPwxIaOksLDaYCMfo6VAICDa%2bHEwtgLQePTZmtbcQCuilHI/nXa5XMiK9BTG3AGG0EjMI9gwJEZ5RAm89TMDYIfQeHkbDZmqaoNGdEomTQNYEfJF1azHZs/NzSH64uLi/8OJAcAOKbljywYD8mEnIig%2byk5LHAQGDHRiHko0K5fZZjxYq3MlGooEN8QHqmqNuUWDASFwxG%2b//ba7uxuDIds7nU6ZARMCD0qggMFrURSxiB7qBWqH8fHxZDL5U0RvAQD7QQPZbTQExTy4wy93mRSJGSXtE4IggMqu8yhICK/iMzfKhH71XyU2fkJrnKGRaOpsKZlWU/wkDWz8EjppLIeaYDTJc30NEN1JTNWq7Bm09ia2K/lfzForrbjL4VhW1dKFDMmJWUsajbIy1CiW0HgLwU1SyrUK3AqAdCVnZ73nz/suXpz/%2bmvnJ59Ep6bSXi8FPi5ILUCooUygHBgdHcVxvV6vnLDoJ8JYLBaCDEGJAEp4ZcjtdvNIJ0cTohbxh1jEi6zF%2bYZOLSLJ6qdPn77zzjvb2toeeughjjKCU2CfP3/%2b7rvvPnnypGzlZhpQu6rZbGJhoRCLpRcWONJl/P7VYrFWqayrxxTCCEsiH3EdSBJ56JRjB0GJFIt8DBHNWFsOKsQi3mJf6ayoDQl4lyFRqYh48eJFRH/qqaeOHTsGjHvvvVdSoWzE/fffz%2bjevXuvC0C6Esmky%2b2ecbm8Pt/s/LzVbmeDb7RLCICXXnoJEcfGxqBPnToF/fnnn0OTCp9%2b%2bumHH374lltu2QqAZppXvgSrn4OazLTJBK83tB20TUcT2uOPP87Gp9Vvb9gbAA4cOAD98ssvs/1DQ0P07N69uwWAXyqis3GPPvroPffcgxPzODIygrgdHR14wq233kpGx5zo2b9//84ANEb0G2RF2rRPPvnkXXfdJRowGAyIizM888wzt912G9b13HPP0fPAAw%2b89957KuDaj8wDTUlqU1vauCYtbj2n%2bMCuXbsQkeMO9Lvvvgv9zTffvPLKK79TG1YEEtxgz5492istNAATEUO%2bfhJAqmpyaMo7LUO1lhBaOvGlS5cQ%2boknnmhvb7/jjjvuu%2b8%2bOS3IKMcjRvft29ciCvHO7OwshSQVPLES46Oad6sNgogk9TNRnGwgNSbM0MRWXoGHUTrJDDJqs9nohCCSkjeud4KRnrNnzz744IO33377Y489NjAw0JgHKG8feeSRM2fONG7c5gA4klNIsjw0wZs3ubM8knFagAYYPBwAGCLwh9QmRT9vyWmLUSaRU6XMAAMOKoF/izqC1AHzlX856TS5Qs4YkuBbf1aRZMmS3Nl17ojFLnKeopM9ZnZtPTKXS20cFBmFRxbePO2nUi2/u0iFAkGa%2b%2bijjz799NPPPvvsww8/JA1/8cUXJ06cIKlfVwMyBeIitGwb4srRmx453WIDcirHJRCIHoYAgOgAgwB/UW2Sm7WjBTQK2c6HI5GM%2bb/66iusiPT8gdref//9jz/%2bmCVaAJBDPYJiCfLrDgzIJ2dIFIr1IzfKwacRmk7iBgUSSsDuF9VGkYPSQA6P1A4QIG95lGF%2bcDInxoYkzACNIeGWRqNRvtA0xr1NACA0Y11dXXq9/ssvvyQek1N6enrYD3Ihwp07dw5tcpKEjRmZXRxDcxLxHB7FnH74KZ1Ob6EB4cG1hoeH2WZ2jdiAwXDnvMqcxAmdTkc8aPF1Wj7UUFqynZSf7CVT8Mh9cnKS94EEwa6jR6TE5NCVuDXLoCj5CAcG%2baWnLQbz9r89yitoldKISIAkLC3ytHBi%2bekrZ1xMWaxIaO4yhJRptSErgNl19h6hIeRRIMkHjvT3jaFt1kgaZqZF5xgVu8OOSHhsfaTUfvKtXf0rctPflfJxt/FDbyN91c/CbRwUf2uH%2bq1P3r%2bRrxL/Ax7GIQiJc6ipAAAAAElFTkSuQmCC' /%3e%3c/svg%3e" width="802" alt="Australia, Stage 1" data-srcset="/assets/static/australian_stage.368578f.93ae8521e8386a901bf32b5c1a027077.png 480w, /assets/static/australian_stage.00c64dc.93ae8521e8386a901bf32b5c1a027077.png 802w" data-sizes="(max-width: 802px) 100vw, 802px" data-src="/assets/static/australian_stage.00c64dc.93ae8521e8386a901bf32b5c1a027077.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/australian_stage.00c64dc.93ae8521e8386a901bf32b5c1a027077.png" width="802" alt="Australia, Stage 1"></noscript></a>
                <h4 class="image__title"><em>Australia, Stage 1</em></h4>
            </div></p>
<p>I setup the <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procmon" target="_blank" rel="noopener"><strong>Process Monitor</strong></a> to only target <strong>cmr4.exe</strong> doing <strong>ReadFile</strong> operations, and then press ENTER in stage select screen, which reveals plenty of calls, including ones to <strong>aus11.big</strong>. What's interesting is that offsets at which file is read, correspond to ones that I've already used when extracting those <strong>WAV files</strong>.</p>
<p><div class="image">
                <a href="/assets/static/read_file_stack.b7e070a.d97f1ba4b9d17efecb1c099f9fb161bb.png" title="Stack contents after ReadFile operation on aus11.big" target="_blank" rel="noopener"><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 787 660' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-4f2ee6482f264e7ce86d916d5abaeafe'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-4f2ee6482f264e7ce86d916d5abaeafe)' width='787' height='660' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAA2CAYAAAB3Ep8CAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAX6ElEQVRo3tVbyXIkWVbVDsP4AH6GJez4C9as2lhQTAbda3pDGwZdXWCww7qq6S5YVFZlKpWSUjFPHu4e4e4xeMyzIhSDxtDlnPvcQyGlsjITrDErpbnF5P6G%2b84999z7Xh6Mx2MZjsYynU5lOBjK%2bXwh27s7GQxGMh5PZNAfyHQ2k5ubG9lut3KO961WW1brtX6%2bw723t7e76y5%2b3fv%2b6T373z%2b675l7zHWH/q%2bk0%2blKr9eVxcVK%2b36un%2beu2/e2eysHs1FPbNuRcsmSIGjIxXIlsr2XZrMluVxeLHxf9Xw0tBX%2bLRcLyeP7%2bcVa/l//7u%2bkFtQkn8/JbL58721bjP3%2b/v6jmz04CyYynUyl3Qql3e3IeDSX0dyTLw//UcJ6F1ZvwUCujMZTRUYfiJgBLa5TxmBKEgIN9XpNWmEolYonDu6tN5pSrVSlXHYlDJviex7ur0gIozabTVyhBL6P1ezrq1cNgKpQan4grusqwsKwJd12Txq1ugxGI5mfL8Qq20DpQLrdHhbFExuficha4GOMFZnNzrVN/kbkttFOFWMq5PNos4vxVaWBsdWDOp51pFqtysEruy8efnDKZSnhCsOB9GcF%2bedf/4VYBU%2bymZQcH7%2bVDhqkAdrtNu6vSC6bwfdnGHAVHeR0kjRIJpUTx62IVbTk9G1SarUAKCrJ25MzNaRVLknZKkuhkBcPyMqkU1Iq2XhflWKhINlcDu8DvC9joA20UxQPRpiMpvLy5WsM3JJGvYlnLDk7S6oBXddBX29hiAYm2JAi%2bstlMrKAO19eXkm305EJjLOYz2WO78ZD4950%2b4NXVkeaaNDF5Mu2jdUZyGBakF989Znksw46KsrpaUI63b4aoNVqSR2T4sDfYoJVDNaxy2ailo3vc%2bpSxUJRkqks3MoDEiy0VdCJcYVdGKiM/oiGEgZbKpVxny/lYkkNEPg1tFmRdtgRD/c20Of5bIEJJ9CGJ8N%2bX9vI5ou6%2bu1WU9KYcIVIQptFGDibScv11bVOeAG3vbm5lsvNpazBXfT9q6srWa1WcvC6MoJFG1KBFV1AotMZS3dals9/8xN0XsekipJKZaQHUjQI6ADKDV31ZDKLidcxWFsnwIkU85aurIvVpgHoHo7jABlZQM7HVUFfcA/LUlewrJK6Cg3ownAFrHiANiuuZxaGbQO2s8m5nJy8VaR0MAb2my%2bUMPaaum8imQC6XKx2F21iAdBOG4ZrNEKx0Vcymdb3FgzvwS2KMF4Oxj44tNpKLlWsTBkDbTaHMoQL/MtvPpNC1kVDee240%2bvvDOBjELlsWl3Dhm8XiwWdQKlYljSMYjuudpBIZhQtFlCUwntyhAU0kCc48SAIsFIZHTANWMwXJAd/9YEAC27RarSATFsa4IPpZCZv3pwqt7CvAGO2Sy7u9dQI6XRG0Xg%2bGUkx58jxmzfgq/6HSfDQGWJFQ%2bUAWwloJL1xSX7%2b5d%2bKYwGW8NkkENCNOIAERcLL5TLoNB8RHlYwCIzlwQMV5RRbUnCHWs1X2BdgEB8kxwGTmEhg5BMXRudkOakKEEADcHV5Tys0fFPD%2bOZwgUQyBcKsSrvTVhT4lUAR1sXnJH6rejVZzKZ4pq4u1qjXpYlVJwFn0mmMNcT3thqvChSWwFMHrx0ycYAOK5EBhtI/L8kX//03sLAPssrB1xPShUagARiLA5/MmpXjE0OCRRCarmDBkiwmTQOQBM8SaV0dkmACfOE4VUUAOaJUNAYhl9AF1IXAG3kQYYyARq2B8AykwK8niEKvX79B264%2bR8IlrP2qQUAymVQX6GCBnHJVUbfZbJQHqCPGiCQM8ZeXG9Uwi/O5LPH54GVEgg4GZsUkOCnI51/SBTBQcAAN0N4jQXbIgZ%2bdYUUwGMexIwTYagCd4B4J2liNfK5oSBATqEQkGIbkAEtXQkkQzJ7NRiToRCSIhaELEAFniaSGLoa6AtztbSKB0OkDKU11Ad%2bvq8vR1cpwsdVqKROE%2bAFC53q9keXFUmbn50qEF3w/ncUkSNJxdyTYm1ry%2bdc/kapTB7EV1NL7JNhkqAEJJhIZ44tlw%2bJFDKqAlSEJOjDCjgRh2HTEAZWqiQJEBWNyCfyhCMDA6TYFfA4Qp12gpVFrqmsaEpyBc04VqXTDIoyVTKVVO7QiEixZLp6pAYklda0BOKDd7qoR05msvucC1Hzyh60iT0mwTp/AA2XHIIAk%2bMWv/xyh6/0kyDATkyDhrCRYKutEGe9JaCTBWAeQHB%2bToKXGy2WzipwdCeb2SLDZVl4gAhgFaAAPkKdRC8WSQVhMggyDFV/CRk0XggagXP4wCbqGBF3EcgeWarcjEvzq78DAgZJgSklw%2bIgE87ns8yQIHqhgkA6U1iMSzD0lwfIDCVoRCSJ65POMKA0NmTQAdUANHKAkmEipAagfbIZWuAvRqySYSuG7KpRiVw1N/dKHYuT7PO7LwrAUSgyPvke%2bgWiD2xy8tntKgt4eCQ7Oi/LFf/01hIkhwdPTs50BSIJEAA1ABFD1FWIShC9TCbp7JFjfJ0E3IsFyRIKREnwgwQJIMEJAEWiEC9iAKaNATILUEXXAnFElgzjeaBi/T6aSQF4VCGhgsgUd0xVUIPOCWyRyi8WFJkZM6iiClCCvr0GC5S582pBg7AJKgr/8S8RTV4UQFd%2b%2bEmyi0wwkcgIT9AFjStEYAblM3khehWjOkCA4QBEAEqxEQogIYFt8NSQYQLCUDQkqB8QkWJU6SfCcCEiqEqxTKGHBKHkbEGVtkGAqxbE0MP6G5gXscw2lR8Ik0pgnTEF6w%2bFQ1eFkMpE%2bflMSZIMUQg4G1%2bnABWaW/OLrH7%2bXBAk7KsGzs7TCuqyixiCAE2X2SBdQIVQ3JJmCsQhHt%2bLo5Bim6lCgDKExAnhfTIKUwgyDVHEkwemYQuhESZB9kmgZMokGJlwJRIQynlH3sCsK9RDvmdaTGAuAfK83ANnifugB6gAaEblAW7OjClY/zgWGs7x88Z8gwYzzQILd/i4ZIvFkQIIn0AEK61JMgrZRgswFlASzqtXpAnQN%2bnWZXAOEUAqrnAWMYxIs7ZFgGWhqkwTh68wFZlMjhakEKd1JgpobkBOASIbBAN/34aJcCKKF2SD/qP3fS4Kv3REsYjQ3SbADEuxOLPn5r34MBq7tSLA3eEKC%2bedI0IYfW5iop7peSbBuEiAmQ3SBfRJkW46SoPNAgoUHEmT6TGTW0Mf5bK7ZH3VAq9XRjJIoaLdbqvkTEEIVtE/iozjLMwWG61DmE3Gnx8eqFIkM/l6GkbIZ5gLlbkSCJhcIQ5DgDCT49V9hMp6S4ImS4EBJpIPU0q%2bSBDPyRsOgq/l27AJEAImRLPtAgsUdCZbgLkqCpaJOIJ0iCTqKKqImH%2bUCJZJg/SkJHqteIS9kEdfPEBUIZUOCKbiXpwhIJ6FeT07UwPHfzbVRhFpbUWK81deDkwpIApYyuQANMJIh0uF/%2b9VnsFJVEUCy68J/7hFX6QL0rWw2A2RwhRuKAPoifZkcoOkuViiVzpsw6DgqThj3SWJVLZyYXEARUGI6XdPEhy6gCMA9nVbXSF2MbzFfKtERAfT5MtCWhxvwfQcoSKkLMFxOYcyGVq36gz4k8FizTo55CiJknyN8NxqOlM8O/v4lHs6XMVn4Hxqs11pS6dryo3//B0mmmd8n1fINJCYbSEhOgn6ZTJzJq8M3gG9ZEw0bvk1X4UqX8F0O8DpC9sYIQWMdH50oQhjmNIThGQfoSZydadji88wMTThzVTpXAF0WNhwYodfpyYsXLxU5TKTevj1TXcCxMDQeIfvLwM0aGF8mhT7gSswGiQKGbrbjw7B0tRpInOk6F%2brgz37pyrcnWUm9PZWj4xMoM7C%2bnZc/%2bdm/youXCXlzdCjfvPhWctD2DFuEaAr%2bdvjqpXz77UvV58dvjhApEqrUXr08VLY%2bfnOM575TiJ%2bensh3GDwHfXxyjDaP5ejoCBySlqPXrzW%2bJ8Hix/juu%2b9eKoEdHh6BN/IK5QTaICJeYBynJ6eqIfj8d%2bg/iXvTMNo337zQcJ3SZ1/L4etDddcBUEBDjJAM8T3zAr7yM6%2bDaQ9xvV6Rq2tWTDYaOxdzJAwXU4iFNbKnS/WVbSQiKC95xXVH8/5%2b98p/u/f322e/f%2beZZ97vX%2byX/BP3F9%2b7/5m/b7d30femHT5HsRO/XiEzvFYuuNUqkVaEOu1Qal5WMyQKheXFApnShREOyKTOkT3dRp3/kP%2bU%2bPbCIeerSvA6YkdjoSu94vfxaywfiQ4%2b%2bEO8KH15xZ%2bJbH4%2boCQkUZAd6R%2bUji28Z%2bmZvjMdj1V58Z4lDMBKKlFBhPD1h3LNZjO9nn4%2b4IQoRN4cvdEsLmz3EEdTSkzU5avlUpUdBQ99jXsC8/n8nQ7m80%2b5Pub5h3vmn9z%2bx18H9PftEx9/Xx5NH6I78FWJKPo%2bzrI%2b5dr3x5iwHi7TzzYiurjf38Z1sMQKX8K/e92%2bSsw%2bkgd%2bx3jfhOTlDs0cqeRqtdZaGjcayKADZFWssHBniPuJa/WvvevJ583m8tHF9NTzfa0KMUlZqW/u3Q8fpZRlhrdU7tn8ny6O/%2bkYeBkDXF7DHyZaZmKNb3u3Nakqa31QaE932phfDwY9laEsTKzXl5/Myrc31%2birqpmk79WfvWfY78E93d9qdDhgoXB1vRYJAcXBrSyvNsSkSsjRsK/ylsVMkmQTK6KQv73R5IerNxoONOFhxdfk6VVNhrjjzEoNE63Ar%2b/cKo7fN%2biHz7CG6EPJcSdJ9%2b1Yn4RCXBJxq41Wc5lMMTtk5sf8gcVUqjgfY2D6WwvwPfpgcYRttFgKhwKlomTmWG805GK13vW/f6kB1jcb2Qb3sqmtZXZxrgYg/AKsUOIspXU/3RJD42oAIIDbXSxkMLtzXVsNVWGaq5uOnubhLFRQzrbCjoqTfQNcX661qnyKhCoHRZiGzteqMXKEPKTxJUTLFAkQC7DMK/KQz5TONAaNVIDBKsgLTG7hajmM%2bQgryjW0w8pTnH9Q%2buqu917/jxCgBqiBiNo3srpaa9LTQxhshQ0MjHm8qbw2kFTEBmBhwlELI4mpcHOzpltOjBjMD8glvV5HJexoOH5k/dgAmUwB0jUlJchrZndcXWalXDlqE1aCWa/kZgZrjUxrXfRLA3BzlIZmJcmrukjlPTUAiywseLD6a5cNArjVtnyCgHcMcA8DXIWXMl8vGAa0XKRZVtJsOXW7HS1/xQaoRAbgVjRr%2bPzMrI/lcIUsfutBR1hIm8vlyiMIxgZIp3NAGJInJEgshnKFdcAwxBoExTJYKzIAt90qURWHsC8icaMxyFG%2bh%2bwTCGDxhUUWZrfcesvphqynFarFhxBwj7nRBcbzqf7QRVQIm4BU0NRBdbpdjRaxAbgZwoyNWRwn0oXB6kGgldag1jQqEhfVI1Xk3RMOuNqs9DmWyugCRADrBExbiaQlmJtSnJPlJkouZwzE9JluwYIK6wvc1CUKtAjjuBq1mP4uLpaq9pjfaP93dx9wgToQ0L6S%2bWqhPzD8ODas7PpahCCMdjoBjbHQwQ4d1/h8By4TakHShTGG73S2n%2bjECGD6fIKUmWcAWE3SswYsiaG99ebKIACEZ0f7h3QnrijPIrDMVmI5PfCV/Oh2prxeU2QsQaDP5QPPRwEYQGCA6yYSouVMfwhZka3aMERTy9eNiABNFLjTGmIub2mV93yxBFQbWiwlUy%2bXHz4%2bYzggrwgo5nKar7N2zygSgHO4b0cDsNzFVeemCw3AgggPRbCgQgSQhJsgW0YF%2bjzJmkYiiT5l/WcRwD2yGxiA8/N9dDo3BugjL6BvuWWjDWpBHTK5u2uEu0la4AQKbMvWYiUZuF5vmr1%2bZWZuVQW6U8Pcm7kFt6PIJZvVhe7lsaLDVWO0mExnjwbJLXE1gB0boGoMoOU3swVHlqcLcOI0glPmlltL9x83kct%2b35mhnQGazXtMcg3ozCMO6GqlhWeBGJ5Yqm51ejGYQDRtPazA/IEFRtbhaQBGAz5H47ByW3VN0ZPtMaEiUQZAyma11ENZYStUpmcNkdtv%2bwNmITRGwIMO8HSyNECZOQpckZqEsd5VIrbwXagGuPw0AwgGu8AqGP8lg3uYiG0VNQqQXcN2Z/egx23xUlENUMqbOiANUKmarTASlypLIKGAEGYyzZ6ycxWIogHo87yXk2INr%2brXHw14jPCpYdAyJMgQS8RxxUuqWn1FhIojGNJxicYC0NxWftpcfoIBGo0tjMCkw/gvB8sVLlumekui4wED47%2bX6hIeJCzLzhVMgHt43J1dLufmVNnk/Hs54HINBNQaSL1DaXc6CH2BVPzaowFzL0BJkGFwzwXCpjkk5eppkZpyAqMFEUAD1OstFWnrTzMAXMDf6ARiF2CI8Sq27sVPkAZfX9/spLARIFU9t%2bdqnd/R2E%2bGJg%2bQQ7hNxQFeXd08EFIUBWgAR0%2bYIVZj4p3QHLdj9Tn%2bYyk8jMJgQbe8jRKs6U5PUQ1A9NAAdUQCGoAcQOHGEPg09H7QBXxvhczO6ABClgwbeIBVxdeYbhrDtb1TdHCCVGFcDfojtXmBG5aYDE%2bgcluLOz/n0cHG7R4b0wDcKqNuKOlWeEs6gDGLL/HAqQMUAXakBN1KdNbPyGOSMxfChwF4bEa35OyyZqnPqb4PGsCjARbGAC2oQGZqngv/AwKY3u4bIPCqkRq01NdVyWFFM6mUJiYjGCBwqwrvm9u7Z12AOQaruowSIVBThGokz9zvIaC1L4VdoziJFOYOeaCAKORV9aoadeiycc4S1yw%2bzgUQBdqtW1i8LrdYgIYeKCopAT4VEjzTq%2bmybWvyo6GQcrjK1ampICFjc4OTR1So0TlIq%2bgg7Z5HBljpgYZMOmv8GW3x2F2s2Q0HRGEQ7e8LISo9buezDxqfmR9JkGTLzdeL5eaD0H/GAFtM/lZGgy5TAYgaYwCyOs/fxqXmuALUoGTFYLgzxERJDx1wawySlvGetUbuwFDQLBZzrTSzCHIduRIRQO6gBNbMDgMnj7Q73T0DnKsBaOhYCBkENHQrzcfYckAeeYEG4MEpB5np/OJB999/rAHqdUaBO1mcjxXmFBO2bSkCdP47A9wLz02TdbmlxUmMxyPdofVBPkWs/t337MbGf8wFaFySYFENUNECS1xz2DeAImBPB/AeZqHc1aZ7mHNDrR0CFhfrT0dAvWEQ0G7XdYI0AP2JE9zeP3EBJEM8mMCEiFlaUX0xUFLiNtQQqi%2bXSekmJ599WoSIXYD7%2bMwGmVRxIjYzPBhhu%2bOAiRY/dvUAO4oCKrkrur2VzebNibMIATaE23yx%2bl8YoE4D3CENbj8YIHaBRwgwHBBSelKjw%2bpUaqoCYQCeNqHs5f5/nJA8p8WJAFaESGbkAGqHeCs8Vps7F4jT4UgHsC7B43F0AYbHimtygFyupMWZfQTsrvdEhScucCvdTlM5gP9foFyOELB93BB1ACdNAuKq8JQmj9HTRxmCWGdkZnh1/RD/5YkB4jDITUwSIRl%2bMhmr3oj/xqOJSYctc/yOfTH7ZGYaV3/ohoxWNW7D4z6iYRoR7faZROj9yVDDIIAGIAICPVGVVwM8/aMBaPWq66nmJ%2bv3hyON4609H342JY7eb5YLJVBNX6kikd6ydvBICc7OdzqgVLIjJeip/mA2yP8/oIcuLcsc1QFiWWVixfpjUuF3EBACAZ12U25v7jAwT2t2FDZk4JPjtzpInuCYIEuL9Th3Zpkk8cR2CT68ubx%2bp9N9y28RDRBG5BJaoloJlDtq0A35bFGaceksEkL7uYApvpiCiB6o4vF%2b8gaNUyxqWs7ju2kYIAtxxeQpnc1prcGJFvH7XSAiwS4MwP8ewy1kCgoWG1gdYhhbgbj4yg0FPdzAM3xId3uAf7/X1ZodT2H6WFXW9R8ZIZrUDZKj%2bZ/%2bSJbF/5BK4Y%2bklvlDyRz%2bgTSDP5bzr34qFz/92W5wzAZ5/l/PHsMIPGLDEEglSMXH5IiHKSiMTH2wrqkydQKzQ16MUCyvvdcA9Nfr6w0miUn3DQnewgA9sDk3Rgi7MGw/3jnivgGgTiMQglR7LKH3ekNpwj9T8GlulrzjApERbq1A1qXPxcv9nrQyvyv5V78jff/3ZXvyT3Ibjnb3c9uOCKCRGQrpMowKTM97rFHy0BVWuoe8hWikBGf9gSfEwyiNpht9nwv8DzNzlc9og6rUAAAAAElFTkSuQmCC' /%3e%3c/svg%3e" width="787" alt="Stack contents after ReadFile operation on aus11.big" data-srcset="/assets/static/read_file_stack.368578f.d97f1ba4b9d17efecb1c099f9fb161bb.png 480w, /assets/static/read_file_stack.b7e070a.d97f1ba4b9d17efecb1c099f9fb161bb.png 787w" data-sizes="(max-width: 787px) 100vw, 787px" data-src="/assets/static/read_file_stack.b7e070a.d97f1ba4b9d17efecb1c099f9fb161bb.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/read_file_stack.b7e070a.d97f1ba4b9d17efecb1c099f9fb161bb.png" width="787" alt="Stack contents after ReadFile operation on aus11.big"></noscript></a>
                <h4 class="image__title"><em>Stack contents after ReadFile operation on aus11.big</em></h4>
            </div></p>
<p>The initial breakpoint will be at <code>0x515DBB</code></p>
<h2 id="debugging"><strong>Debugging</strong><a href="#debugging" class="anchor-link"><span>¶</span></a></h2>
<p>A little problem was the fact that there are plenty of files that have to be loaded before it'd get to <strong>aus11.big</strong>, but it's not that hard to skip most of the calls and observe the latest ones in <strong>Process Monitor</strong>.</p>
<p>Observing the stack only made me sure that I'm on the right way, <strong>003</strong> corresponds to <strong>003.wav</strong> I saw in the <strong>aus11.big</strong>, and then there's weird reference to source code file about codriver - exactly what I'm dealing with.</p>
<p><div class="image">
                <a href="/assets/static/read_file_stack2.2c84a33.1ed9122e5e7ff1f127244c6a0ceba535.png" title="Stack contents that I'm not exactly interested in" target="_blank" rel="noopener"><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 587 338' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-11c9626e13be10f01b8213f487af58ba'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-11c9626e13be10f01b8213f487af58ba)' width='587' height='338' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAlCAYAAADyUO83AAAACXBIWXMAAA7DAAAOwwHHb6hkAAALLklEQVRo3t1a2W4jxxXVnxhIHCB5SQLE8WOQfFMeDM8ATmwPJomfgiCvNhIEGASIZ9NIo42SKFIkJS4SF3ETKa4SSVHctG8jHp9T3S1RGsk2MhpgNA8FdnVXV3fdvvfcc25x6IOf/QJ/%2bP3v8OFPPsBvPv4YH330W/z8px/i17/6Jf75j7/j8y%2b%2bxF%2b/%2bgp/efgAXz54gAcPH%2bLrb77BxOQkXK5pNpf9ezfb0L17n%2bJvD7/An%2b9/gk8/%2bSM%2bu38PDz67j8//dB8zEyN4%2buQxRkeeY/TZt3j%2b9AleDD%2bDxz2DRDSC1fQKsqnEnW5DO5slFHNJdJvr2FovoFnNo15dQ7teQj4RhGtsGAGvC76ZUcy5RuGeHkMuuYTjnS3gdBc42bnTbahTK6BayKDFBW9q8eUcmhsFbLHlaADPzDhCfjcW5iYx755EeMGDBsfttmvAYRdnBx30nca%2bddy9cq5r/R71rKbjQ%2bfXPv/aHJ2L6%2bfP6F4%2b59x7acw173J4c7vRAK0aPWAlBO/0uPGAoJcGmJ0wBqhXctjrNoBXe%2bjTiv1Xu9bvcc/6ddoZrx9vW8d64H4b/d3W5ZfUAnSe3tQ/27fGa17NqWM155p5xvbFmEPOsdeyjKlrGue8k%2bY9Yf90x3rWUe96A2xVc8in41xUHhuFNMoMhwoN0uAiM9GACYG17Ariix4EPW4klv1IxkI4qK6CJ9CfcQGJCBBna5QAvwfgvYwfgF6D5QCQ5vHkcxBIgIVZ4OULwDUC0KOwluL9IWvczATAUESIc/g4LhIE6kUgwONpXltiP73MZ7j5bI7fyFnjFn3A6gqQinHsHBD1W9dD83wer5XzVrhywaAhBttQb7Nsvnpns0IMWDM4sFUrmhAoZZYRCXiQXVmiMRaRTYSRjocsD2hWgU4NfXoOGmVAHrFLXOA85pjXwHnMr8bKOPptb3BR9j06t9ME9nhfiwvnM80czli1XsO6xncz/W6d43iciVsL0jXN19u05tQzNUZjdX6Lz6OXmAVfZwB5wFomgQYXXitlsc6vLxDc5gTZWACTL5/B7XqJkG/GGCLNryWA3OvUjVXldsa6dEszqXMskHFA8tQ%2bPu/vXjTnPp2n%2b%2bLYnuPUvs%2bZS9dObfBieIDhdX6fM8%2bpfe144Jm6fsPijQG6dDEtWh6gDLDJUGjQAMKDPBe7RPcq55gy4kHkk2ECojwiggN9ZTuucBfaTR7QoQEU81sEPYWAYr/GJgOUMlGsLC8QI6JYjS8il1pGKhpEhXG7LzdzDHCNZe9KG2qt51AgyMkAGzREdS2NjXKWoVPECsHo6f8eEbMeY25qhN7gRXhxjkbKWyHwPhhAIFgjCLYJIC0CiEJAINiul1GmB8QjfvPFqwyDYjaGQiaG9WIG%2b%2b%2bLAZqVVeTSMZMG15kGK/mUYYYbxaxx%2b3DAy5gPIx6cY6YJM8tME4DDOBDqvgsY8D0A96MMYECQi5UHbDL2G4YIFU0WyCUWMTs5Av/cFLyuF4YIZZPL2CRW7Cm9GVJy5QUcVL/a1%2b917ce86MnO6%2bOd4zf0QGOAypoFgi3mYRmgRm/oMisU00sI%2btwGCOMkFfFIgAZYsniAqLAYljSBJlOuZR/qH%2brFOlZfeZ10lBZlo9eQCZoxpjWtBejevbY1Xn39qu/MqXDTePX37fPOvW/qAVsCQbIofXUxwXpp1XCCDcZ5ZtlHHvCc5CvA4xBi4QCSJERlguV%2bOUOmNo8%2blSHIDA0bFIEJkH2VyRLzZGZusrcImViC7G2cLPDFtzxH5kh9QWVFFjdtEZzYItnbAjA1ZhEYMcF5zhvmuTTn/c/XgJeMz8d7RjgP6bmZ42j7cij8fyBI9OeiO42K8QAxQXECAWIhFSHLdCMe9mGJdDRMmqlMIDG019owX6GvUNAX2re/YM9mhPraSpWHthc458Uf5A3qy4uc%2b3bs8eprTo3VsTNW1/Qc/errqzlf/00M0CKtLBH4FAL6%2bqLFbWYGpcEstcAk%2bbtUoG96FFP0hoB32mQNkwZtcYKTK7F5bP%2be/ED8Oyzt6Mp4J%2bav3msk7ED/FjIQDZA3ITBIhRUOIkI5sj%2bpv0o%2bibVkhGkwiljQbzHB3jvABG/DA7oNxj4XrrzfJAVWkzfIAOIBCQJfinEfp/LLUAjFQn6TKt8bJmjEUDbB1FYwTFBe0GJKVBpMU/qOjzwh/owTz55hjIxwanzYKMJBHuC0u8kEGzYIblYNCBov2LDkcJEg6CNqC/gSBEJpAukB4YNDhc/swsZd9YahNkGwTJc2cc/8X6MxytQDEkXKAiJBkYU5rCz5DQ1OERdULTIlMUlUyVIC0/eVnd5l49AAeRRXk6YkVrdBsEoOoK%2bsEJiZmqAXTGBuYhge1zjT4jSJ0SKJUhVBzxiGH/8Xi34vDpWWzvYvFx1tPf8ue8Z5RUhUuF2z0L9ZIxcgKJaI%2bsvBeVMJKhIQpQHKJDibthps19aMQGrXKyR/dc6zahjkbmud6b5kCidH28132wM2KxQ9yajJ7VWqvhJTYi4TN2CYifoxQR6QoidkE0soUSSlyNrKq2nUimkszs8iGppjiowiSdb45NG/4PO4EAm42V%2bgcHJRQEWt4qlDc981MSQmqMV3TUXIqgQpI6i/lgzT/ScNAwx6JszxgnfGYIHksPNVzw7aONOxTWzOrpS1YVd/X3/ZwRz%2bA4s8umGRbyqGOnTjUs4CwSZ5eY3KcJ1A2GtWUKAB/PyKy0EvIv4ZCqNZhGiMMonRviitXe42tbdBUnRsMznn/HUqzrQrCs8ef0n5XacYzXN6t%2bMBYoLS/yI/NYKf6gAVmw9YYmjYiKEsxZClDP00EKlwOQswM/Q9s%2bivLKHPEOnTm/oLPvTpRf1CCn2vC32JIYZIf3KYQuYJ4KEAYmaBa5QCZ8qq3EoMxdlmJ0Exwnl5j19lcZ7LUkg9%2bjcF0JhVDpcY8kxaYsks/A2Z4LYthhwQbGp7TBsj9AhTFicHSJMJZmJB5MkBkvzVGFMWJ9idl8VFjCRTm3ZZ3JS/i5YoUsok4zTXnJK3%2bjp2hJPK2yppq6/71Nc8El0EZeuestV0TfMf3gIVduSwymDGA/j11%2b2aYIpy9%2bXwY6bCUSx4powUjkX8Vk1QL3dq7widXoiXS7s3AyXy/sDYvl3KNueOexe7R%2bprDruc3b/mXueZFt7cghjq1AuokPhYRChnQkDlMTFBBwRFhLQ1pmOpwTWC4CUqTMA7s5v24pwvcnWfcPD8IFBeju3ua/t7Z/ud8%2buXxdcteID2BmUAeYDYn3K5QFBVH4sKT2E55EN0wY0QQVDqUNtn24zVM3tz1IAXDs6JkF7ylbS82cy42BA5P6%2b%2bc41f2THcmbOQwU0Tjevv44Sh8TZY5VBrXUzQqgiZDKAQoAF2tqpIEYxmyAC1FxjxK%2bfPG4NIDgsjek3hRoEKcZ6Y9gQuAqa4QZNzRuk1gblZpGNhU1yN%2bD3GuEmCogqrK%2bEgImSVqegyOUbQbL%2bHaOTVZAyxwCzn9GGb2JHmO0wPD6OiKtOA%2bLpFJuiIoYpZlCpCosWqCJXSS1yQ20ji2KKboTBPDhA38lk7Q68Ieie7LQOetVKGmFXGDkHreLdJLKsaJqj%2bQWfDeMwxv%2bIeAazD8z2C2g6f2TFjLOaoGoP4hYy/36nhiPRaNct6MUfv6L0VRmk8wKkJqiIkD3DSoP4f4BYAzk8j4B6Dd2acTDBkXt6IIaeiI3eV%2bzt7cVf3Bp02eP66/cLzqs/A%2bNOLfcC3EgJOWVxfvWG2xNbQZbrqNirIxhbM32RkAP/sS8zSGKGAh3hRsAxww57722pvIwS%2bA5AfqS85zJb7AAAAAElFTkSuQmCC' /%3e%3c/svg%3e" width="587" alt="Stack contents that I'm not exactly interested in" data-srcset="/assets/static/read_file_stack2.2c84a33.1ed9122e5e7ff1f127244c6a0ceba535.png 587w" data-sizes="(max-width: 587px) 100vw, 587px" data-src="/assets/static/read_file_stack2.2c84a33.1ed9122e5e7ff1f127244c6a0ceba535.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/read_file_stack2.2c84a33.1ed9122e5e7ff1f127244c6a0ceba535.png" width="587" alt="Stack contents that I'm not exactly interested in"></noscript></a>
                <h4 class="image__title"><em>Stack contents that I'm not exactly interested in</em></h4>
            </div></p>
<p>While I was observing this, I wasn't sure for a moment what my next step should be, because I'm not really interested in executing step by step to find out where it's being decrypted or something. I quickly thought of a much better way: I'll just try searching memory for the loaded <strong>encrypted</strong> file (I already extracted it from <strong>aus11.big</strong> in encrypted state, and can copy portion of it's header), and set the breakpoint on read of that memory portion. When it's accessed - it's probably for decryption.</p>
<p><div class="image">
                <a href="/assets/static/memory_search.761593c.6c9ffbc82c57cf3049d163e8d4368895.png" title="Attempt to find the loaded encrypted WAV in memory" target="_blank" rel="noopener"><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1313 681' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-c2d994d8fb974c958a4a84fc89033361'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-c2d994d8fb974c958a4a84fc89033361)' width='1313' height='681' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAhCAYAAABpwa0hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQWElEQVRo3tVZaY9s11VtEcAKiC/8EhACIiF%2bGDhgyR8cAVF487P9bMfEiRU8xAN%2b%2bL3X8zxUdXV1zeOtqjvXPNwae1pZe9%2bqfu0hcbAjBN3aOuO995x19rD2qaXDgwPMplMMBgGm04mWo%2bEQk/GY9QGCIMB4PNJyOptpKXOGLIecFwRD9PsDjEYjbXe7PVxdXeH/y9/ScDTGZDLRDcwEgH4fM250wA1qyfZ4LHPG6OlGQ3DanU4IyKCvz3W7XfQozWYLFxcXuOL/5dUlLi8vcHF5qSL1Sy3/78hS1zlBotbGdqmJnN1EvNpE0W2j6LSQYD1v1XFs1JEyWyixL2/6iJ8k8PiDD9CyyujYpzA8E1a%2bBOc4ioJhwLYsuLaNUtVD3qhi9/AQkYKhYPZ6PZVut4MOQZR6n/0i0u6zv98P%2bwTUPrVwQOD7g7CtffP3yPzvKkvR9DaiqSi8Zhedeh2VYgmFUhmlcgXNVgtFu4tM0UShWIRlu%2bxrI5eNo5AvoO1xg6cplLhpq2ZiwEVZtgnHduA0bOzldpDPF%2bF7PgEtEBA%2b02yjXvfVdAKajM25Bp83TRP9XhdFv4dCxUKlTHA7XRQKBeRLWZS4phbXU5c1VipwHGduopTBt5el9z5%2bD%2b//6j3s7Oxia2MDayurWFlZwYcffoTV1VWsb0ewvLqB5WfPsL6xiaOjI6yvPcb2zh4ODo6wvLyBzz57jI8%2b/hSra%2bvY3FrH%2bvom9vb3sLL%2bFE%2bfLuu86EmU42t49myV711jnd9a38Cnn36m8sknn%2bLpk2fY2DnA%2buY2njx5it39Q2wsP8HT5f9mexk7u3vY3z/AxuamfusoEuV6Iiy/vSytPXmMJ//1MVafPlZZ/vxTbK8vo5CmahfScKp5uLUiPMuAa5ZgVfKUIsxyDrVyVtvF7Cnnx5FLxNjPcSOv47ZRhF0poMYTlL5EdAcnB%2btIxSPYWPkc2cSxPpdPnWB/aw3JkyNUi2l9pzxn6vsLrPM91cLzbxrhN%2bS931WWkse7ODncQiq2j3T8AJGdVZwcbSFou7gad3Ax6uB82MKo7WDUcXEWNIGrEXA5CsuLITDt0Z9OQrm8MXZ5QzDFqFnGrFvRd7Zcg3PGOu982ES1kAjfo%2b8M5jK8UV%2b0h1/T/vayJJuP7K4jHtnBaWQX%2bxvPFBCHp9CwCmg5BssiKrk4DIpbySkgAsQ5ZTZoYEhwpH4WNLT/q9LQTTdqKXSsFAZNG/2Gqe/hCzDpN/jerM7B2eCG9L/U/i1yHnx7AI521hA/2lYQ9jaezgHIoVV3GNpaCHptSgejQRezyRDjoEdheBz2tT5kf1j/TdLT8X6ngW7Lo6dvsWygZpTw/rtv4p1HD/DowT387I3X8O5/vIWf//QNvPPWI7z79pv4xdth/Z03Xw/Lt17Hz96cC%2bcv%2bn/6mrzjDt54cPd/JARgEwdbKwRgB0maQZRgxAQAIwvPcxGQH4QkZ4QJCZPE%2bEVcfx7fr77S9xW54Dzyo/Fkqm35M4wK3n7jAV6/dxt3b93C/Tu38dr9%2b3j13j08uHsXjx4%2bZDusP7hzB69y7CHr92/fVrl3%2b5b2P7h7B7d%2b/GP86yuv4N9%2btJAffan%2b9bJ0ckCPLWpPDUgc7%2bFwexnHB1uwyhm0Gj7aDHsSbhzH1vDTmcfibysLDiCx3LUtpAwHFbsOz3FhmxZDqA3LtNFqNuG5Llz2l0sltNttVCtVhsImSsUyCVcDDuc3Gi0FU8nXDQaq9XlbCM/V1dfL0q8%2b%2bE/88t138NGH7%2bOTjz7A%2b7/8hdaffv4Ytap8sE0G2FdtqLLdm5OW7yICgtBps1ZFsz3EYFhHp2eQcc6UnAg3aDZ7HBsoEWr1J%2bQfdMbn5wqiR/4hZMsjv5B11ao1nJ9dKGN1yQ9831eNk%2b8IM12A8LVMMLq3hkOqfWRvA5F9agNjt9RLmVOekIlkMoV0JqMnsCAi3yT%2bN41zgUKybLNGdtmE33Dpb0zYPG2LG2vxWyNS9OF4gtnZGU2PQtMRAGSTknMM5zlJMAw0P5Exoe5CrmRc2kLxZb5ow8UNGq7muAAgzTAoGz6lAxQTiO6GDnHY8dCsE%2bmaAZ%2bUN8MYL2U5lyQ3KGrsTp5EUC3lUGQslxieY1/i%2bAgpqSdj2lfKJtF0a2h5z6Xtm/DtKoxyCTW3iXaXSVRnoKfV6/ZxcX6h6ntFp3HJxV7JYi8u5/W5aqtA27rBxfj8uXCTV6F/4vtkbFHi6gYAySipME/%2bZB4FjnZW1Am2fS60WVfKm0gklK6K%2bokmdKmmbZ5gk3baUc3gJtot1RBRTzlhsV8p5cQbjYbarJSh1PU9YmK9bkD7P6fqUv3bF3S6V9SAM7S6Z/CbMzRaMzQ7Z/DqLNthn5T1Vlg67pRjUzj%2bTPu8xgyON4XtzWg%2b5/QvE5SrE45PYdQmpPwzTC8kUQv9w1Iisk2nt3nNA3bWPicY1IboLqpGmXTxCJtrBCV6iHw2hcTJMeLHEZyyPCW9TcZjyGWSiMfYx3rdpWPy7C%2bJpf1N36GquyoNX3KAMkHlyTfOYVoT9LihY3uMv71fwd/cq2j5V3cN/DXLv3%2b1gr%2b8Y7CfbY79xW1Dx37wIOz/AeeI6Bjbf/ewiqw/xl65g/Wsj5WUg93KABvZOtayDXTGF3MASE8Pt1dxyg2LHJEJSkgUHuC5NtKH%2b6rWmSSJUDGHXDqB1GkM6cQJ0uzLpk4JwLyP7ZZvo62bdL4gbdq5axqokiqbQm3NCso0gW4noOefoWyM0G2eYdMY4w//MU/J4U/%2bKY8/ejGP7/1DDn/6zwX8gfYV8Mc/zOMFKV/M4c9eKuB77H%2bB877Pvu/zmRc4/ucvF3HqjPE04eLjIwOfxSx8nvBZr%2bCTSBWNwfQ5AMIET%2bcacLi9oj6gVkxRhV04TGUL6Qxqln19GSKZnF6GUOTeQES4gvR3NcxJytsPRdPcrl6a5PN5Jkob2NraRoWeu8Yo0GlLiD1TADyXQNQD3N108HDLw70tFw%2b2Pdzf9nGffXc2KOsm7rL8yUoNr%2b3WcWdN2pzHubfWLDzc8XFr3cKjXQ9OO8BuwsDWSQkbJ0XspgwclzwcZE10g0kIgOQCSTq/BRPc33ymPsBi0uFYNappEYVMHHtbq0xK8prASJKUjB3SdHY4lmD9APvba9oX3d/m87sst9i3rv2STDlMZjwmU%2bJIPU2qiigWC%2boDxP6rlRHt%2bYwpdZcpQYMUeUiW3GYZkLEyJwnauBzS/1CTmKggaLGcBpj1mZtMB0wremTErflzLEc9nE9p/4U8NbeIWsWgQ6/SrzV0X9PpdAHA3vz0Qw04ojmI/ae5GYsPtOiZY7GYcgBxeOLAFuFQHJ44wjqdneTnGuIYm33f0zFXiAxF5rfmTrMpDpHS6bRDDaD3d6kBBjXAZtlivDctR6NBpWqSNvfY78Dlexv8jml7NCnSaJKgVoNJVM1UrtJud9HgWvvUOovhtMP3yAXMSUzuLvJaiiOX%2b4kMw/p0dvZcA2TjXzSBHWZnSZKNGlxKjaHOrpY1dPl2jTZc0nbdNTVNlrJJR%2bdxvO7U0GDbtSpayvwGw6D0d5o%2bei2feYCvZKdcFifIKMCTr1VJYlgK5RamGHDxFlnhmGbWbnfoQH2CEUahlkQZAtynafksZW6PdYk8Aee4MkbgRsEABk8%2bk6LzPk3CJGgWwSzmc8ot5j5gl3H7QAEQE4jsrmpIFCosbEvUvuWU4NVy8%2bywTHXOwadIpugaGfaX0LBLqJsF%2bDKPdckaG2w7Wubhcf7lpHud4YlGyC2TAODQBEQDXO%2bcWhZuZNgfqFbJhuTk69SAAYGp89T7DLtCpAKetlBouYnqECTRtiHrwhDbnDcZDelbDKTTKb1RMkpFnMRPkc1mlVhdAyAnrlGAGnC8v67%2bQBZuW6aSmF69hqbN0yI36Pikr8zlpS79vlnEoGVz3ECTgHS8CtpeNZyvzxnzlLqEc0l3CcLVtK8AFAlA6APOaGI0AfuMTrSvJhVwIw43Nx2JcyS9dUMAPJ/pd7%2bn5jTkyYvJKQCtkI9MqDHCNQYEbsxn5UpNNE0ccCadVi2oUCvGNwGIMflJzMNghExQtKGYjqHCOD3qtfSi4nLMhU9CCeu96/aXx79RbgDQnQNQLo%2boBVONFkKyZHMCwIi5QGPuN%2bTCVO8CuTkhWUKHVTMk0hAAAW7MPskPemwHBEqodZknX2bmWWUyVygUlYGORpPnABzTYy%2bI0IIH5BNRfXDcb4dqK7c1vy%2bZ9dWWFxogPqBKHyBOUEKobm5uArIhyQybdHwB%2byTPEL9QJyAy5jA8d/muPrVAEiFRewGrSwDk9w1xeMI4RWMKVP0CM0kxscl09jwKxBYAEIxDuRtgvZA8VgCCboOnJldjDEOUixtyOf4m6czly/UuT6se%2boDOQH2AaEDNnBGQnp642Leoq5hCQ%2bg05/c1E/TVL9h0kEPRDo51uDnf9Zhd1jAiSF6dDpM%2bYaS3zjYZbUUdY7lcRDweZ0SIPQfgVPl/mAAlonvXAOSoARIGheNLTtCS8Cf3A1KfiyRLjYX4XyPsr5NMNesSwlytS7%2b0HZ6ChKV%2bX2ycnJ0MsFqdqQZ4PEnZgEkfFKiDo32LXYuDEyC4JtGSgHNdRhPpF7ORkx0N%2bhqOBawpM0G5wxBHmMvl1QSSyQS/VWGWeR4CUEhFkTo%2bYPYWUQ042Fq%2bBkDIQ6VSQyqV5kuqPClPPWg6k0OettTp9tRm%2b4NgzghDZtifs0XJ7iqVKmIncWV%2bLh2ZqP3%2b/qG2hQrXajZPrsOS4csNf2YT8%2bhp/Hf1ZMUXyG8NDZqBRAH5Baoh0WCe7wtocnEjffIjimiJYzmh2pdKCoDD94g22PLbBp8J5IaLjnDp7Tce4uHdf8fP334UJkVkgRIGK4UEyvk0QSgTubJGBMe2FBSLebxlVq9P13UsbZvVil5yyDyZI1riOTZt0NDSYmptkFNkNCyRCeaz2N8l%2b9wha9wj9xB%2bYYXvllK%2bdbRPE41GEDuOIptJXX/r5jz5ltwtaJ3fj8eOsbu1hWMmcplMmiDaOubY5vVzMs%2bsVbD08ks/xMsvvYh/eeVlRPeYExxJeryBUcdDx%2bYHixEMWxYmPXrYrqflREqKXJOPuz5qBCt%2buI0MKXE%2bGUWR/iN5vA%2bHHMGvkQIzpLZdkigjgUY1Qb5Q1GvwoO3ojbLkHXIZ61bzGDSt6xArIm25QV7Iov%2b3icyT5xbPdhm6dcyfy425S0WaQC4RQfb0SDm93AgfCwDcYOBn0TETjN3z62p676/IecDNGdx0jECkYJVIoJhHGNlT9ld0k4OGRbpO9ayXMPDzCmQ5GyfNb%2brVdI%2bLTMb2MO7Vw/v%2b2Y3rcP3O4It9v4ss1vcN8/RWOMKTj81VXy5Ejvc39UYo4GL7fkG992%2bK6RLWuiQ/2ZOIhs78aQSVXBLlzAlBiHNzVngHfxag6%2bTR83I8dVdvoEV7ZBFtPi/OWPpl0b8zn/g9yFKaC0kRfVmQyAlJkfAA0YCBl9EfMi6GTd3oYsM361KKGvd8U1VXRH74kFJCZUiSOrqxnlugFjADrJuaa5wP23q6wi7llykxu/9tAH4Nk9AV8450034AAAAASUVORK5CYII=' /%3e%3c/svg%3e" width="1313" alt="Attempt to find the loaded encrypted WAV in memory" data-srcset="/assets/static/memory_search.368578f.6c9ffbc82c57cf3049d163e8d4368895.png 480w, /assets/static/memory_search.761593c.6c9ffbc82c57cf3049d163e8d4368895.png 1313w" data-sizes="(max-width: 1313px) 100vw, 1313px" data-src="/assets/static/memory_search.761593c.6c9ffbc82c57cf3049d163e8d4368895.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/memory_search.761593c.6c9ffbc82c57cf3049d163e8d4368895.png" width="1313" alt="Attempt to find the loaded encrypted WAV in memory"></noscript></a>
                <h4 class="image__title"><em>Attempt to find the loaded encrypted WAV in memory</em></h4>
            </div></p>
<p><div class="image">
                <a href="/assets/static/memory_search_success.bdc5dda.8d9fac42215c97afcf6c3dda971d04b8.png" title="Success!" target="_blank" rel="noopener"><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 636 74' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-557fce1763a7694846b041a4ae4f7573'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-557fce1763a7694846b041a4ae4f7573)' width='636' height='74' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAHCAYAAAC4NEsKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADOElEQVQ4y8WS2VbTUBSG%2b8Q%2bga%2bgslQqUqFDkiZNOtEWoWlKUVvpgMXVGSjcyGItJypQJpH%2b/ufEFvRC0Rsv9tpnT98eEk%2b/0UDxzh3sNpsARni70cBauYy112Xs7e1jq9NBtbaO4quXKJfKqFaqWC3wvVZFu93Ceu0N3tbr6LQ7qFUqKL0s4tWLEurrddRZV2P%2bRn0DzUYLrUYTRycXuNxp46P3LjA8xMXVCMdHRxgOh/9FPMViCaVyBZVqDdvbffR3dtHrbaLBYTvdHra2tqV/c3MLXdpCi3iPut/f4RE66HS6UkRcxijdXo/1XbSFn7Z8M1e8ezxqd70q2S36Gjx%2bs9mibv2km7e0fyd/YnpUVYN3%2bjGmHz7CkxkfvN5pmFYU0VgMU1MPMHXvPmZmZpHN5ZCj2LZNcXU2m4XjONIWMWFfa4fantQ4Tl6%2bpS30SuEHy5a2YAiWqJHatq9ZssfPdm5Sdz3POOc6154wf51nzPSoGg/g9cLv90NRVfhmZzE3Nw8jEqGeQ1jX4fP5oBsRqIoCLaxD18MIU0eYEwyFYJmMaWHEeTRx0EQigWAwgFg8LnOtaFTyI6bJuEKmAU1TJdswDEqELIMsBXHWKGTG4zH2IJMshX0tfhRhC7aIG2SJ/tFoDBFD50ezZI5gRfkWPQQjEAhKhsrdBDsc1hDjnBpti7UekRzisLqmwDQN6GoI/rlnyCwuQlOCvJiN9EISqWQSps7lkinELeZx4VQmhVAogJXcEoexUMjbcsjV1QIMLp7PO4hZJrLLS3jme4p0JgNDDfLvinNIQy6zmEkjwcGWn2fk0R17CcHAPPKOzRyTjDwXDpKx7NpODmZYxUI6jRgPn0ln8Dy9gFSKkkywr4EVJyuP86KQl4de4RyaEpJM8bEc7qT457Es/oCD9%2b%2bAy2N8Oz3A1ekAV2cD4OsRDj/u4evwk%2bs/c/2j8y8YCX32RcoVY64eSP%2b3kwOpL08%2bS7%2bwRUwwcHHo5t1gSK7s6%2bbh3K0Znd%2boHbNOx/bBpLeon8x9Y/5x7SX1hPnLPOMensGHPS58KIfCj%2bHEsMef92Vz8RZ%2bVwY33n8nY/7tGP/e5/Ys1/8dZQEBR8blznIAAAAASUVORK5CYII=' /%3e%3c/svg%3e" width="636" alt="Success!" data-srcset="/assets/static/memory_search_success.bdc5dda.8d9fac42215c97afcf6c3dda971d04b8.png 636w" data-sizes="(max-width: 636px) 100vw, 636px" data-src="/assets/static/memory_search_success.bdc5dda.8d9fac42215c97afcf6c3dda971d04b8.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/memory_search_success.bdc5dda.8d9fac42215c97afcf6c3dda971d04b8.png" width="636" alt="Success!"></noscript></a>
                <h4 class="image__title"><em>Success!</em></h4>
            </div></p>
<p>The breakpoint did work, after that I tried to let it execute the code and observe the memory changes - it does exactly what I wanted - decodes the file and I can see the <strong>RIFF WAV</strong> header emerge:</p>
<p><div class="image">
                <a href="/assets/static/wav_decryption.6535205.2188ce54c6a6e53563dddf9f55c4e4c8.gif" title="The code XORs the encrypted WAV file - see below" target="_blank" rel="noopener"><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 991 571' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-af8fdd8eb7b334eadf6191519ad3ca7f'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-af8fdd8eb7b334eadf6191519ad3ca7f)' width='991' height='571' xlink:href='data:image/gif%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAlCAYAAADyUO83AAAACXBIWXMAAAPoAAAD6AG1e1JrAAATmElEQVRo3pVaWZMk11XuP%2bE/AbIdBAYezJPDD/AAhiBsJEIGAizhwKEAecMCBQogMHbI9pMtmRghJGFGChlrRtOzdc/09FJd1d2173tlVmVVVmXtS9be3fXxnZvV20xrNOqIE5l5M/PmPdt3vnOrV1p2H8NRF5OpDbNqwL19H3omioqWRimXgFnKYTFqY9atIh0LIJ8Iol0tYjZoYNpvALMeFpMuMGnjeLbAIPMyhv7fA%2bYzYNpGPv0H0NK/yePvIuD/LWTTn8d8mMPcblCqfMZ5X83B8/OyWN7DrA%2bzYiAYDGLX7Ybb7YE/EML62jqSqQxKpRL0YhGapn9iWRmOnI8czwboNk0E9l1UPoW6kUeVyjdMHYtxF/O%2bhYjfrYxj6ilYpQyavIfDwdIAHS56DLNwA0byDS56iGOONwpvoa%2b9hqPh/8Eyf4ay/jPYbR3degy9RuLJDDAfIJ1K0oA%2bFLIpJaahQ89TeS2Hkp5T52ZZR61S%2bkSy0mYEDIY9zKYDNBomfHs7KBeSqBazaFZ1tGslHA9bOOzXUcrHkU%2bGOKarRdEqZ4uftGhEoJ/7NmapL/DenOMtFPQv0Huf4XufRjr6WS72cxh1wzjkN8Wzlyl%2bWQTUrRoVTyK0t6XWxkWpKNVSIRTplHTU70SkrEvenz2ZrHS4kClTQDw5aJ0ZoKa8r6HFcF9M%2bEy/hrDXjSqjQ8/EmALNC947WWg2GUMqHlULORq3UbQyGHZaaDGdRuUCMOor77erGRyPRfnuE6VAv9dFsZBFIuBGzcgp45t6BgU6pJiNUmIY9eqnRn1SWenRAJORE2b9pmMAI59QBqhzwY2KtjSAhZjfg2wi5Cg/P/PemQF6yKVTSEaTpwbQrQKG3S49mMa4Z9HQ4HO2Wqjzbu%2bJIqDX7UDLpZCNemGJIfn9SoHXMT8xJkRsCvE71llUzXrn1tb7aAM4IMgHiAHtZQoIBljlPEO9qPL8mCB4SNBKhfcRD/tOQ%2by8AQQDFrMpmvmraCVe5f0xMaANzfwh6vXvQ6v8G1q114gzP%2bXzVYURjwv/ywyg59KIeIlR9LxEbImOigc8yCWDSEV8jLTqqWPmNlNy3Dlb30d8Y2VA5bu2gwHNxsUIkBRoWw4GHA%2bbHI%2brcGtUCsvwPQ9grALTQ/SKP0Y/8QwXPeFYh176G9QKX0Kz8ixy2T9EpfRlTO0CRjTo48L/UgPk0wh4NokBOWWAMiNAS4eJATFiTJjYYi0jq4sqjTTpNT4WZ1aqvT6qfScCpAp43dsqnwRgzGIGdabA0bBNw9YRC%2bzByMWgEXRmdlOFllhZjLFguB9Ppqjl/wuWvqpA8GjcgpX/D%2bb/9zBs/ohV5SXkUt9Fr0mA7ejOu1KBHidLL54YIB0%2bYFRqpxhQ4loyBEBJzengUYU/LspWbPRgEAe6IxulWgWx4AFGnRomRFRnET31MVBBiQCT6UGLgOTAOR6fCNF3wSpQ/Ana2q/4Di8WfaSLz6FW/3MUSs8imX2WafAC7zFUMec79rn3HyP8loCgYECGGNBtGI4B6CBxSIWgnSM/OW%2bA85H12Aj4719OEEjb6Ez7MFot/OLtN/Gvr7yMn7z6A/z7v/wzrvz8pygVMrRwBPfXb2PnwT1kiPQ6F6OxHotX5LyYTyKf0VDOXIEZe5Ge5hhDNFN8Bab5T9DLLyGZ/wd0rB/znSCVcd5T7z9OZO5CmiW6zm%2bkWYl2UJcIYAoY%2bZQqg3o6ikTogCD7ZFXgfOqu/Oj1Q3jDI4yPBmjRylf%2b83V851t/j1defgkvvvANvPrD7yMdjyB44IFr%2bwGCvj0kY2GlgNTldCK6lDDisRyKsR/Air%2bAUDBDI4QRy/4JKubvE0u%2biqrxZ6iWn2Gl8NCIKfVOKk4Ai4cuFZk3RRGDW7UaSVT%2brPpQjiiHcqRCR0vMwIm3D22HEwgmyPFw4Iw9lCIrgACHUNI6hlYWkcA%2benWDbK3KkGoqkQlGHZPWjmJMpK2zDlvFtAIalQYnwpDXMj2E/IfEBLkeIlop0rBMB5KkY2YNiI2Hww7XwXA9ZBo87u9I0sw%2blwJpVffbJGiqzJVIiAjKkLRkBC6YurLWOVPhhM53SNrKBPUieUgxHSH7LF%2bMgKNOhnW9SlSmYmYGXs828yqOGtlWY8kDDmmEbk1jzQ2w3HgZekk0jKxC4ePlRMcEPLAKaNlX6fnnuJAJx9soV7%2bOQuFPUSs/jUL%2bj2HozzCivoRy6Y9QKX4V/c7X2W88j177ebTqz/M5Vo3yczz/W85pcI6BQvVup62I0KRXo13aypsLGnFBbrEYyLF%2bSpsFOId04JhVYW43FTaMujU1Nh%2b2LhoAA9Ld0QRj8vhms67KoK6nUaHyJnPNIhc4Yk21GyUkicBScoQnKAJDz5zlFXnAZIZG9Qpz9VuqL5CxUvVFFI2vkVP8HSqprxG5v4GW9T1WnO8SzL6NYe9Fnn8Tdveb6tisUmoca32H81UcA8x6pzzAyMaZ8xGV93MpxQMqTk/TzSASOsfZMvQfliVNvpgC/QK6LHHHoxp6TIHA7iaGwT2Miaojis1JJc8GTYON0jbrbkTxAMW7L1BhhxwV2J1lYmmVq0f0RK6WRY%2bltlOooJvIMYUE2aFSwmGFy%2bN8eTxailxP%2b48wwXTcSx6QQZ%2bVoExwnlUJiAzrKg3SZGTO2%2bbHAuHFCOhlWWmqTpjVdQTcW%2biHvbBZV0fMI5t5fkhF%2boyARGhf5ZZK5mnvEio8oBNYk%2bNki3Ob77EdrvqJJ2W0U0HUEz5MBpYiTdIofbycUew%2b6XSW/GQreouMtUSM6SCZ9hEPCsQUphrXaTFdhZ98HPm5UAYXPfb746bKqb5qhlzs2DIqBSx2gk3L4AdazB8TUd8u%2b/rohQ883AwJSRKckHATA2jVMEO7hHKZ5InzH0r%2bPgFBuYwJFrIJVqwHJGd5Bkcdu4E1lItJLr2NUs4hb7JPcTK/Q9I6j2%2bGJAIWI0t5rN%2bsON2gosJZWEbeAUEu2m5VkCbfVnTzoR7%2bvAEkN08MIGMp04t6hykzESMPn1j5hw1wAoJkaA4NFyewiTu0nUgRYFTgKLl%2buMSAxdiJVsl9qSYn1UrK4XJuGkB2fOoXDXCuHZb9ADHAgDkXOnDRKLkLOfawAWS/IBP3O2hMXKhqYbRzEfZKFsxmCrNR4yy3p91PZADZ/LBbBlrEoC7BWdYrkTCjtMyCwqZmJcdUNjAi4hfYJJXyMV6XWLqz1CmDGgG%2bRb2UsaanBmhcMIDqBul9aYQ6FMmxQbNMgAurcvK4CJAqkY0HlgZg7TaCRPUMHyPPYLmVFvlxu0CXGoDHAfuVcCgI19YGPK4dHOztYntrG7FomCWzinw2jWwmjVwmCaPI2k%2bJhAJIkkiVigWOp0iqYkjEIsiyZa%2bT9jf5HjGAYSUpwLAYLA0g3aDsukhLLO2wWEtQV5ok4eaXKX8aAekYCpnoaQrk6iQfNo0m20VHDMn5eQD9mA2LcwYY2QOs39vAtQ%2bu49r1VdxYvYmr776P23fX4XK54dnbx97%2bAQ68fuzueuD27GHX7cGOa1eJZ%2b8AgWCYEoI/EFTPHXh9UgZzmA5JFCY2rPpJCqRUqCsMIOs6JLDYDCMBGiFBM%2bbdw0CotsSmQC//IsaV15ZlrIms9kUUS5%2blRz6PdOp3SIM/z2BjGk1tRZQWso9wqVwsW/agj63NB/Duu3F/7TZu3vgQd2/dxObGOt558w1c/cXblHfYr6xhY/0Otjh%2b68NrWL3%2bAW6tXsfm/XsqIsJBH8XPc0cUCNqCnPPhsgqcYYBEQGMZAZICYZ9b7QpnYv5HGg%2b1KTobw8zfRDF5XzHBY4418u%2bilX6dXeD77AV%2bznR4Q6UbZtMlWZo4MrtETjGAZZApkIgEiAEmzEKC7Dei0k1y2%2bu6j33K3vY6dagu%2bbbtAKCSoQOCpz3BmagIGKra3GKY6xcNwAiQ/YBD1lZbpYCwsLDi1%2bf77dNt8ekCg8I/Yp76IhftbIvX2QgVUp%2bGafw2itrnlBSyn0HN/HVGxVNoNZ8iuj%2bFTuspjjnnRe3XUKv%2bBuclyZkMVapIL5CIBBVOlTLMYzZRYgTZoQ6SoAX3dxDiUTZyT5sgVRHOKT7tXVIG%2b3kMukWQ8cCupRQPOMEA2XxsVouY09t9Ki0sUNJAAeGs/1CNlU1ScEFPc2Gf4v0jZVRN%2bxQ0fQX53AqCwRUkEvxk83%2bZRpvk6GusMOvMhjOZ9B2Z2vfUnIuJs8MjKRAJeFWjZrAByrJbTAQ8ylnJ0B4i5Cgx/y7iIa%2bKTinbPaatpHLXKqoKMbfbjxhhRfj6dNjEmLW1UivDv/xdQF6QHeFu3emexuwG82xflefny9byERlAJ1DmkuGlF3qIld5DvXUHGAeo7AHFp1IFcxpodviozJci51NHeQnfWtVEIhpUmzXSiUo0msQq6e7UVt3y94q6UVAcRrhMlSVPdotkw0R2ssc9hySpHawTA5TI00W0wRCuYpXdoAtF3Skb2XQC6WScx6Q6l6OUm3w29YjIPavKNro/gt2bYDToMrVYvgY2j2OMhzMlI3vCa7nX%2bWixT%2b4L%2bvfQaliwrDoss7TskxfnjuNlQzFfHsdLmTpYoMYmzvXxkgQdncmKruXZruaU0kZJRzQSUeXDxdLh2t1lSXFjZ8fliMulSoqMy/W2Gt9xxnjPy7ISiYQRDgcpEUSiUXUdCocQ8HsR9B9wLIIwvxEKhRGkyDES4XPRGJ9zxkM%2bP5%2bJqudkHh%2bvY7EY1tfu4sNfvY/Va7/EdR7X76wiFQ8jGQ0hSnSXY4ENUz63dFJu6SC5lr0EMsmCthQ2UoV8GistS1dkQteKNIJj4WbdxIFnE4l4kh%2bOolaro9tmq7z/gIuNqUUZRhk2a3PIt4MIFYxywfl8AX16PBrcxcE%2b8zIc5Rxx9BhdpegOUp5VKhlVCrdabfL7LtmdxihLwk8lrWaT%2bVpHTeaLxZFKpdDlM/1%2bn5g6w1tvvY2vfOXL%2bItnn8HTPP71X/0l3nn7Lbz37lW8%2bcYVvHf1Kry7Lvi2t%2bBz78In53Lc2XbG1taWche%2bjQ34SKhW7ty5i1u37mCVxGJt/R4JxD5u37mFD65fx4OtLWw82FJEQ36Q3NrcwibZ1wOOidfdHg8esDY/2JTnNsnMXPDw/c2tTWxyTMa3GCHuvT243E6UbG5u4979DX7zFm7euo21tXVscyEypr7DOSXC1tfvqzlVNDIKs7k8qwZxiY1QqyYMtYgU89u1cUdVgajfrX68XRiySxQnGrOCSEXgc8jxmphG1KQEeT/mXBPYV%2b7dvoG1Wzew%2buEHuH/3lqKY/3PlHdy%2btoqox4sAa3/Q7yEBccG1s4F99zb2eR6kUmGyq%2biBD/49DwIHbvhD8uw%2bons%2b9Z5vz42Qm2Hv8fG5A3rZQxJygJ2te7hJRrfn2sbdOzfg3/YQvQOkqQEEeB71MZWI5gJ6yVgIqViQ1YNYlEqoui/lWbbGBfFdD%2b7gYHcD7s011a4fLfcDF8JRTkRYqQhzfsFmaCH35Zr3VjpVDRZRs0QrlYmm8vvg5jU3vBssNd4CovsJLj6J8H4clk7S1KigUylhVK3hqNvGtNpAy9DZN2gEr4pqQsaGhRGfa5dLGJsW%2bhUDY6aVbfFe00KdmNPSWV7Z4LRKGnqagSOC3pHdQTdXxLBiYtZtOvt%2byz3BslFChoAsv0pXlz/bxYL7KgKkBPolZWmA42WVOjNA71TZU8XPG6AmJYUlIslWVzq5LsvKoMTFVmroFSuwjSrPLXQLZUoJs0YTQ6OmnhmaVXXfKpAxFvP0TBZd08BAr6hneoYzl5lLolXW0DcqaqyezWHEdxsxHY2QhlZcx7DB65QOK5pDLZNFk83M0ZJnyE7vkHhjEKhlvYqhMoRT0QA8W%2buKnSapvBjkkDyBVsKCjoCI7BmqaxMLOnrBLnIh22YyRna7IiFVYs7kEiHF8qSuDitVTOokEyV6zLLUea9YRodAOSZIydjIrPG%2biWmjgQ7Bc1g0uagc22YTg7KJEefoVahwid43%2bU6thgY/3OECihlGGp/v01CNaAGdRBEdVqBqOoteykCnrCslz3eL0g2WWLFqxYz6cVS61GhgHzuMgBy7T/mNMMGUOJItMi2tlFZK0iALvrNgu7xgN7tgpC%2bo74JptCC7XbHk1xWShgwnkd3gXlO8ZGDIEJfQnLIGT1tNdAoGulRm3mkqxbsaq4Bp0jAGPapRoQpmNI6EuckwHZWr6DBsK0ZKeX7aoBGqdZUSbYZ5K0PPJ3Q0IzojQEM3YzgRRcJj65yfBj%2bedE4NYJ8zQM1wfrgVDJDcj1H5dNRL8TkYILk%2b75%2bG%2bSkdPtkMOTlyzIkAKp4hABUzsm9eUZHQZIjJ5uOISk64eLXonKY8OSzXUM7KXjtZXyqISibDnqqEfqmMUc2CzQgY0gAt6cu1JNOgoq5FQYmcdr5IL9LwITK3UAEaGWYjTyNkaWQatJPiXDTEyd7BRQOkTw2QCPuwfY/A7dpA2LvLNPY6Gx2n/Un39Pwjt8QkAsQAkgLyM1PXMpBnNDSWBjCpQJMNkeCEGEj%2bO0R%2bH9TY9ytv0NvSmAgN1XlfgLQkOc9yZZXyNIiTKpJWthiB2NLMFQiqmwgf7KofLOIBt6LZFZ2M0x1AN2nQAJULBlApoDs4IwZoscQlWQY311fhYRe4de8m4sG9J/pJ/Lz8P1Sa38GaO7GQAAAAAElFTkSuQmCC' /%3e%3c/svg%3e" width="991" alt="The code XORs the encrypted WAV file - see below" data-srcset="/assets/static/wav_decryption.368578f.2188ce54c6a6e53563dddf9f55c4e4c8.gif 480w, /assets/static/wav_decryption.6535205.2188ce54c6a6e53563dddf9f55c4e4c8.gif 991w" data-sizes="(max-width: 991px) 100vw, 991px" data-src="/assets/static/wav_decryption.6535205.2188ce54c6a6e53563dddf9f55c4e4c8.gif"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/wav_decryption.6535205.2188ce54c6a6e53563dddf9f55c4e4c8.gif" width="991" alt="The code XORs the encrypted WAV file - see below"></noscript></a>
                <h4 class="image__title"><em>The code XORs the encrypted WAV file - see below</em></h4>
            </div></p>
<p>The relevant portion of disassembly is presented below:</p>
<pre class="language-text"><code class="language-text">00402526 | B8 20A45600 | MOV     EAX, cmr4.56A420                  |
0040252B | EB 03       | JMP     &lt;cmr4.decoding the file contents&gt; |
0040252D | 8D49 00     | LEA     ECX, [ECX]                        |
00402530 | 8A10        | MOV     DL, [EAX]                         |
00402532 | 8A19        | MOV     BL, [ECX]                         |
00402534 | 32DA        | XOR     BL, DL                            |
00402536 | 40          | INC     EAX                               |
00402537 | 8819        | MOV     [ECX], BL                         |
00402539 | 41          | INC     ECX                               |
0040253A | 4E          | DEC     ESI                               |
0040253B | 74 07       | JE      cmr4.402544                       |
0040253D | 8038 00     | CMP     [EAX], 0x0                        |
00402540 | 75 EE       | JNE     &lt;cmr4.decoding the file contents&gt; |
00402542 | EB E2       | JMP     cmr4.402526                       |</code></pre>
<p>Based on observation and somewhat intuitively I understood that this code does basic <a href="https://en.wikipedia.org/wiki/XOR_cipher" target="_blank" rel="noopener"><strong>XOR deciphering</strong></a> with the key located at <code>0x56A420</code>. First byte of <strong>WAV file</strong> is <strong>XORed</strong> with corresponding first byte of the <strong>key</strong>, and so on. If there's no more <strong>key contents</strong> left, then <strong>key</strong> is used from the beginning.</p>
<p>While trivial, it's still effective protection from people who can't find the key easily like this. <i class="tiny-frog" title="yes"></i></p>
<h2 id="decrypting"><strong>Decrypting</strong><a href="#decrypting" class="anchor-link"><span>¶</span></a></h2>
<p>I've posted <a href="https://github.com/suXinjke/CMR4BigFileParser" target="_blank" rel="noopener"><strong>all the code and the encryption key</strong></a> on <strong>GitHub</strong>, but I decided to copy some of the relevant code here too, just to demonstrate the <strong>XORing</strong> and how the <strong>big file header</strong> is parsed.</p>
<p>I've put <em>Baby's</em> in the note title just because I consider this whole thing trivial for many people, but it's the first time I managed to pull off something like this and also did it very fast by my standards (in an hour or less to get the decrypted file). Therefore I consider it another proud achievement of mine.</p>
<div class="audio">
    <audio src="/audio/babys-first-xor-cipher-cmr04/aus11_001.wav" controls></audio>
</div>
<pre class="language-js"><code class="language-js"><span class="token comment">/* out of context wav key deciphering */</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> files_offset<span class="token punctuation">,</span> files <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">parseHeader</span><span class="token punctuation">(</span> big_file <span class="token punctuation">)</span>

<span class="token keyword">const</span> wav_file <span class="token operator">=</span> big_file<span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span>
    files_offset <span class="token operator">+</span> file<span class="token punctuation">.</span><span class="token property-access">offset</span><span class="token punctuation">,</span>
    files_offset <span class="token operator">+</span> file<span class="token punctuation">.</span><span class="token property-access">offset</span> <span class="token operator">+</span> file<span class="token punctuation">.</span><span class="token property-access">size</span>
<span class="token punctuation">)</span>

<span class="token keyword control-flow">if</span> <span class="token punctuation">(</span> wav_key <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span> <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> wav_file<span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        wav_file<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> wav_file<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> wav_key<span class="token punctuation">[</span>i <span class="token operator">%</span> wav_key<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">parseHeader</span><span class="token punctuation">(</span> <span class="token parameter">file <span class="token operator">=</span> <span class="token maybe-class-name">Buffer</span><span class="token punctuation">.</span><span class="token method function property-access">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> magic <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span> magic <span class="token operator">!==</span> <span class="token string">'BIGF'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span> <span class="token string">'Missing BIGF magic header, not a big file'</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> file_amount <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token method function property-access">readUInt32LE</span><span class="token punctuation">(</span> <span class="token number">4</span> <span class="token punctuation">)</span>

    <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
        file_amount<span class="token punctuation">,</span>
        files_offset<span class="token operator">:</span> file<span class="token punctuation">.</span><span class="token method function property-access">readUInt32LE</span><span class="token punctuation">(</span> <span class="token number">8</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>

        files<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token spread operator">...</span><span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span> file_amount <span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span> <span class="token punctuation">(</span> <span class="token parameter">_<span class="token punctuation">,</span> index</span> <span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> offset <span class="token operator">=</span> <span class="token number">0x24</span> <span class="token operator">+</span> index <span class="token operator">*</span> <span class="token number">0x18</span>

            <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
                name<span class="token operator">:</span> file<span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span> offset<span class="token punctuation">,</span> offset <span class="token operator">+</span> <span class="token number">0x10</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">filter</span><span class="token punctuation">(</span> <span class="token parameter">chr</span> <span class="token arrow operator">=></span> chr <span class="token operator">!==</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                size<span class="token operator">:</span> file<span class="token punctuation">.</span><span class="token method function property-access">readUInt32LE</span><span class="token punctuation">(</span> offset <span class="token operator">+</span> <span class="token number">0x10</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
                offset<span class="token operator">:</span> file<span class="token punctuation">.</span><span class="token method function property-access">readUInt32LE</span><span class="token punctuation">(</span> offset <span class="token operator">+</span> <span class="token number">0x14</span> <span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
</div><!----><!----></div></main></div>
    <script src="/assets/js/app.e080a059.js" defer></script><script src="/assets/js/page--src--templates--notes-vue.acd1227f.js" defer></script>
  </body>
</html>
