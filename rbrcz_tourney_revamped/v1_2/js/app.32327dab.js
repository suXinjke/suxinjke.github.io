(function(e){function t(t){for(var a,c,o=t[0],i=t[1],l=t[2],d=0,h=[];d<o.length;d++)c=o[d],n[c]&&h.push(n[c][0]),n[c]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);u&&u(t);while(h.length)h.shift()();return s.push.apply(s,l||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],a=!0,o=1;o<r.length;o++){var i=r[o];0!==n[i]&&(a=!1)}a&&(s.splice(t--,1),e=c(c.s=r[0]))}return e}var a={},n={app:0},s=[];function c(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.m=e,c.c=a,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(r,a,function(t){return e[t]}.bind(null,a));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/rbrcz_prototype/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],i=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=i;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},"41d0":function(e,t,r){},cd49:function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var a=r("2b0e"),n=(r("386d"),r("5d73")),s=r.n(n),c=(r("a481"),r("4917"),r("6b54"),r("96cf"),r("3b8d")),o=r("db0c"),i=r.n(o),l=(r("7514"),r("a4bb")),u=r.n(l),d=r("75fc"),h=r("bd86"),_=r("cebc"),m=(r("55dd"),r("3be2")),p=r.n(m),f=(r("7f7f"),r("c5f6"),r("2638")),g=r.n(f),v=r("a745"),y=r.n(v),k=r("48d3"),b=(r("28a5"),r("795b")),w=r.n(b),x=(r("ac6a"),r("5df3"),r("f499")),S=r.n(x);r("6762"),r("2fdb"),r("f576");function P(e){return"".concat(("000"+e.getFullYear()).slice(-4),"-").concat(("0"+(e.getMonth()+1)).slice(-2),"-").concat(("0"+e.getDate()).slice(-2))}function O(e){return e.split("-").reverse().map(function(e){return Number(e).toString()}).join(".")}function T(e){return e.split(".").reverse().map(function(e,t){return 0===t?e:e.padStart(2,"0")}).join("-")}function I(e){return"".concat(("0"+e.getHours()).slice(-2),":").concat(("0"+e.getMinutes()).slice(-2))}function C(e,t,r){return r>0?t+r<e.length:!(r<0)||t+r>=0}function A(e,t,r){if(!1===C(e,t,r))return!1;var a=t+r;if(a>=e.length){var n=a-e.length+1;while(n--)e.push(void 0)}return e.splice(a,0,e.splice(t,1)[0]),!0}function L(e){return u()(e).reduce(function(t,r){return null===e[r]?t:Object(_["a"])({},t,Object(h["a"])({},r,e[r]))},{})}function D(e,t){return e.evaluate(t,e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}function M(e){var t=[];if(e){var r=!0,a=!1,n=void 0;try{for(var c,o=s()(e.children);!(r=(c=o.next()).done);r=!0){var i=c.value,l=i.getAttribute("value"),u=i.textContent;l&&u&&t.push({id:l,label:u})}}catch(d){a=!0,n=d}finally{try{r||null==o.return||o.return()}finally{if(a)throw n}}}return t}function N(e){return u()(e).map(function(t){return y()(e[t])?e[t].map(function(e){return"".concat(encodeURIComponent("".concat(t,"[]")),"=").concat(encodeURIComponent(e))}).join("&"):"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t]))}).join("&")}function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.flow,a=void 0===r?null:r,n=t.curstagepos,s=void 0===n?null:n,c=t.page_selector,o=void 0===c?null:c,i=t.save_tournament,l=void 0!==i&&i,u=t.save_from_leg_page,d=void 0!==u&&u,h=l?d?{submit_page:"Save"}:{submit_save_tour:"Save tour"}:{submit_page_go:"Go"};return fetch("/index.php?act=tourmntscre4A",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:N(L(Object(_["a"])({},e,{flow:a,curstagepos:s,page_selector:o},h)))})}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return new w.a(function(r){var a=function a(){e()?r():setInterval(a,t)};a()})}function R(){var e=new Date,t=new Date(Number(e)+18e5),r=new Date(Number(e)+864e5),a=new Date(Number(e)+2592e5);return{now:e,nextHalfAnHour:t,nextDay:r,nextThreeDays:a}}function E(e,t,r){window.localStorage.setItem(e,t);var a=Number(new Date);window.localStorage.setItem(e+"_expires",(a+1e3*r).toString())}function q(e){var t=window.localStorage.getItem(e);if(!t)return null;var r=Number(new Date),a=window.localStorage.getItem(e+"_expires");return!a||r>=Number(a)?null:t}var B=a["default"].observable({cacheChecked:!1,byId:{},fetching:!1,fetchTracks:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,r,n,s,c,o,i,l,d,h;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.cacheChecked||(t=q("tracks"),t&&(r=JSON.parse(t),n=r.byId,a["default"].set(this,"byId",n)),this.cacheChecked=!0),!(this.fetching||u()(this.byId).length>0)){e.next=3;break}return e.abrupt("return");case 3:return this.fetching=!0,e.next=6,fetch("/index.php?act=rbrtracks");case 6:return s=e.sent,e.next=9,s.text();case 9:c=e.sent,o=(new DOMParser).parseFromString(c,"text/html"),i=D(o,"/html/body/table/tbody/tr/td/table[3]/tbody/tr[1]/td[2]/table/tbody/tr[2]"),l=i;while(l)d=l.childNodes[0].textContent,d&&(h={id:d,name:l.childNodes[1].textContent||"",country:l.childNodes[2].textContent||"",surface:l.childNodes[3].textContent||"",distance:l.childNodes[4].textContent?Number(l.childNodes[4].textContent.replace(" km","")):0,shakedown_allowed:["ano","yes"].includes((l.childNodes[5].textContent||"").toLowerCase().trim()),restricted:Boolean((l.childNodes[6].textContent||"").trim())},a["default"].set(this.byId,d,h)),l=l.nextSibling;E("tracks",S()({byId:this.byId}),86400),this.fetching=!1;case 16:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}),H=a["default"].observable({cacheChecked:!1,byId:{},fetching:{},shouldBeThrottled:function(){return i()(this.fetching).filter(function(e){return!0===e}).length>=2},fetchTrackSettings:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var r,n,c,o,i,l,u,d,h,_,m,p,f,g,v,y,k,b,w=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.cacheChecked||(r=q("track_settings"),r&&(n=JSON.parse(r),c=n.byId,a["default"].set(this,"byId",c)),this.cacheChecked=!0),!this.fetching[t]){e.next=4;break}return e.next=4,j(function(){return!1===w.fetching[t]});case 4:if(!this.byId[t]){e.next=6;break}return e.abrupt("return");case 6:if(!this.shouldBeThrottled()){e.next=9;break}return e.next=9,j(function(){return!1===w.shouldBeThrottled()});case 9:return a["default"].set(this.fetching,t,!0),o=G.tournamentDummyPostOutput({tourstages:"".concat(t,";")}),e.next=13,F(o,{page_selector:"2"});case 13:return i=e.sent,e.next=16,i.text();case 16:if(l=e.sent,u=(new DOMParser).parseFromString(l,"text/html"),d=D(u,'//*[@id="TyresSel"]'),h=M(d),_=h[0].id,!d){e.next=50;break}m=!0,p=!1,f=void 0,e.prev=25,g=s()(d.children);case 27:if(m=(v=g.next()).done){e.next=36;break}if(y=v.value,k=y.getAttribute("value"),!k||null===y.getAttribute("selected")){e.next=33;break}return _=k,e.abrupt("break",36);case 33:m=!0,e.next=27;break;case 36:e.next=42;break;case 38:e.prev=38,e.t0=e["catch"](25),p=!0,f=e.t0;case 42:e.prev=42,e.prev=43,m||null==g.return||g.return();case 45:if(e.prev=45,!p){e.next=48;break}throw f;case 48:return e.finish(45);case 49:return e.finish(42);case 50:b={surface_type:M(D(u,'//*[@id="SurfSel"]')),surface_age:M(D(u,'//*[@id="SurfAgeSel"]')),weather:M(D(u,'//*[@id="WeatherSel"]')),weather2:M(D(u,'//*[@id="Weather2Sel"]')),clouds:M(D(u,'//*[@id="CloudsSel"]')),time_of_day:M(D(u,'//*[@id="TimeOfDaySel"]')),tyres:h,damage:M(D(u,'//*[@id="DamageSel"]')),shortcut_check:M(D(u,'//*[@id="CutcheckerSel"]')),tyres_recommended:_},a["default"].set(this.byId,t,b),E("track_settings",S()({byId:this.byId}),86400),a["default"].set(this.fetching,t,!1);case 54:case"end":return e.stop()}},e,this,[[25,38,42,50],[43,,45,49]])}));function t(t){return e.apply(this,arguments)}return t}()}),W=r("768b"),U=a["default"].observable({cacheChecked:!1,byId:{},fetching:{},shouldBeThrottled:function(){return i()(this.fetching).filter(function(e){return!0===e}).length>=2},fetchTrackWeather:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var r,n,c,o,i,l,u,d,h,_,m,p,f,g,v,y,k,b,w,x,P,O,T,I,C,A,L=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.cacheChecked||(r=q("track_weather"),r&&(n=JSON.parse(r),c=n.byId,a["default"].set(this,"byId",c)),this.cacheChecked=!0),!this.fetching[t]){e.next=4;break}return e.next=4,j(function(){return!1===L.fetching[t]});case 4:if(!this.byId[t]){e.next=6;break}return e.abrupt("return");case 6:if(!this.shouldBeThrottled()){e.next=9;break}return e.next=9,j(function(){return!1===L.shouldBeThrottled()});case 9:return a["default"].set(this.fetching,t,!0),e.next=12,fetch("/tools.php?act=show_textures&stage_id=".concat(t));case 12:return o=e.sent,e.next=15,o.text();case 15:if(i=e.sent,l=(new DOMParser).parseFromString(i,"text/html"),a["default"].set(this.byId,t,[]),u=D(l,"/html/body/center/table[2]/tbody"),!u){e.next=60;break}d=!0,h=!1,_=void 0,e.prev=23,m=s()(u.children);case 25:if(d=(p=m.next()).done){e.next=46;break}if(f=p.value,g=f.getAttribute("ondblclick"),g){e.next=30;break}return e.abrupt("continue",43);case 30:if(v=f.childNodes[0],y="Originální­ počasí­"===(v.textContent||""),y){e.next=34;break}return e.abrupt("continue",43);case 34:if(k=f.childNodes[1].textContent||"",b=f.childNodes[2].textContent||"",w=f.childNodes[3].textContent||"",x=f.childNodes[4].textContent||"",P=g.match(/\d+/g)||["","","",""],O=Object(W["a"])(P,4),O[0],T=O[1],I=O[2],C=O[3],T&&I&&C){e.next=41;break}return e.abrupt("continue",43);case 41:A={time_of_day:{id:T,label:k},weather2:{id:I,label:b},clouds:{id:C,label:w},remark:x},this.byId[t].push(A);case 43:d=!0,e.next=25;break;case 46:e.next=52;break;case 48:e.prev=48,e.t0=e["catch"](23),h=!0,_=e.t0;case 52:e.prev=52,e.prev=53,d||null==m.return||m.return();case 55:if(e.prev=55,!h){e.next=58;break}throw _;case 58:return e.finish(55);case 59:return e.finish(52);case 60:E("track_weather",S()({byId:this.byId}),86400),a["default"].set(this.fetching,t,!1);case 62:case"end":return e.stop()}},e,this,[[23,48,52,60],[53,,55,59]])}));function t(t){return e.apply(this,arguments)}return t}()}),J=a["default"].observable({superally:[],carPhysics:[],fetched:!1,fetching:!1,fetchTournamentConstants:function(){if(!this.fetching&&!this.fetched){this.fetching=!0;var e=D(document,'//*[@id="SRallyPenaltySel"]');this.superally=M(e);var t=D(document,'//*[@id="PhysicsModId"]');this.carPhysics=M(t),this.fetching=!1,this.fetched=!0}}}),X=a["default"].observable({cacheChecked:!1,byId:{},carPacks:{},trackPhysics:{},fetching:{},fetchCars:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var r,n,s,c,o,i,l,u,d,h,_,m,p,f,g,v,y=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.cacheChecked||(r=q("cars"),r&&(n=JSON.parse(r),s=n.byId,c=n.carPacks,o=n.trackPhysics,a["default"].set(this,"byId",s),a["default"].set(this,"carPacks",c),a["default"].set(this,"trackPhysics",o)),this.cacheChecked=!0),!(this.fetching[t]||this.trackPhysics[t]||this.carPacks[t])){e.next=3;break}return e.abrupt("return");case 3:return this.fetching[t]=!0,a["default"].set(this.carPacks,t,{}),i=G.tournamentDummyPostOutput({PhysicsModId:t,tourstages:"10;"}),e.next=8,F(i,{page_selector:"1"});case 8:return l=e.sent,e.next=11,l.text();case 11:u=e.sent,d=(new DOMParser).parseFromString(u,"text/html"),h=D(d,'//*[@id="ModsPacksSel"]'),_=M(h),_.forEach(function(e){a["default"].set(y.carPacks[t],e.id,{name:e.label,cars:[]})}),m=/carsInfo\[\d+\] = new Array\("([^"]+)",\s+"([^"]+)",\s+"([^"]+)"/g,m.exec(u),p=m.exec(u),f=function(){var e=p[1],r=p[2],n=p[3].split(",");a["default"].set(y.byId,e,r),n.forEach(function(r){y.carPacks[t][r]&&y.carPacks[t][r].cars.push(e)}),p=m.exec(u)};while(null!==p)f();g=D(d,'//*[@id="ModsSel"]'),v=M(g).filter(function(e){return!y.byId[e.id]}),a["default"].set(this.trackPhysics,t,v),E("cars",S()({byId:this.byId,carPacks:this.carPacks,trackPhysics:this.trackPhysics}),86400),this.fetching[t]=!1;case 26:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}),z=R(),V={name:"",description:"",online:!0,offline:!1,from_date:P(z.nextHalfAnHour),from_time:I(z.nextHalfAnHour),to_date:P(z.nextThreeDays),to_time:"23:59",cant_resume:!1,only_one_car:!0,dont_show_splits:!1,dont_show_temporary_results_in_rbr:!1,dont_show_temporary_results_in_web:!1,save_replays:!0,require_stage_comments:!0,test_tournament:!1,password:"",registration_deadline:"",superally_penalty:300},G={tournament:V,cars_physics:{car_physics_id:"",track_physics_id:"",selected_car_ids:[]},tracks:[],legs:[],trackFetchInfo:function(e){return w.a.all([H.fetchTrackSettings(e),U.fetchTrackWeather(e)])},trackAdd:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var r,a,n,c,o,i,l,u,d,h;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=this.tracks[this.tracks.length-1],a=!0,n=!1,c=void 0,e.prev=4,o=s()(t);case 6:if(a=(i=o.next()).done){e.next=19;break}if(l=i.value,u=B.byId[l],u){e.next=11;break}return e.abrupt("continue",16);case 11:return e.next=13,this.trackFetchInfo(l);case 13:d=H.byId[l],h=U.byId[l],G.tracks.push({id:l,name:"",surface_type:r&&d.surface_type.find(function(e){return e.id===r.surface_type})?r.surface_type:d.surface_type[0].id,surface_age:r&&d.surface_age.find(function(e){return e.id===r.surface_age})?r.surface_age:d.surface_age[0].id,weather:r?r.weather:d.weather[0].id,weather_change_allowed:!!r&&r.weather_change_allowed,weather2:h[0].weather2.id,time_of_day:h[0].time_of_day.id,clouds:h[0].clouds.id,service_time_mins:0,setup_change_allowed:!1,tyre_replacement_allowed:!1,tyre_change_allowed:!r,tyres:d.tyres_recommended,damage_change_allowed:!!r&&r.damage_change_allowed,damage:r&&d.damage.find(function(e){return e.id===r.damage})?r.damage:d.damage[d.damage.length-1].id,shortcut_check:r&&d.shortcut_check.find(function(e){return e.id===r.shortcut_check})?r.shortcut_check:d.shortcut_check[0].id,superally:!!r&&r.superally,superally_hold:!!r&&r.superally_hold,retry_allowed:!!r&&r.retry_allowed});case 16:a=!0,e.next=6;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e["catch"](4),n=!0,c=e.t0;case 25:e.prev=25,e.prev=26,a||null==o.return||o.return();case 28:if(e.prev=28,!n){e.next=31;break}throw c;case 31:return e.finish(28);case 32:return e.finish(25);case 33:case"end":return e.stop()}},e,this,[[4,21,25,33],[26,,28,32]])}));function t(t){return e.apply(this,arguments)}return t}(),trackRemove:function(e){G.tracks.splice(e,1),G.trackFixIncorrectService()},trackMove:function(e,t){var r=A(this.tracks,e,t);return G.trackFixIncorrectService(),r},trackMoveUp:function(e){return this.trackMove(e,-1)},trackMoveDown:function(e){return this.trackMove(e,1)},tournamentFromHTML:function(e){var t=(new DOMParser).parseFromString(e,"text/html"),r=t.getElementById("tournament");if(r){var a=new FormData(r),n=a.get("tour_to_date"),s=a.get("tour_from_date"),c={name:a.get("tour_name")||this.tournament.name,description:a.get("tour_descr")||this.tournament.description,online:null!==a.get("online"),offline:null!==a.get("offlinet"),from_date:s?T(s):this.tournament.from_date,from_time:a.get("tour_from_time")||this.tournament.from_time,to_date:n?T(n):this.tournament.to_date,to_time:a.get("tour_to_time")||this.tournament.to_time,cant_resume:null!==a.get("cantresrace"),only_one_car:null!==a.get("onecaronly"),dont_show_splits:null!==a.get("nosplits"),dont_show_temporary_results_in_rbr:null!==a.get("notempres"),dont_show_temporary_results_in_web:null!==a.get("notempresweb"),save_replays:null!==a.get("savereplays"),require_stage_comments:null!==a.get("getcomments"),test_tournament:null!==a.get("testrun"),password:"",registration_deadline:a.get("enroll_close")||this.tournament.registration_deadline,superally_penalty:Number(a.get("SRallyPenaltySel"))||this.tournament.superally_penalty};return this.tournament=c,{track_ids:(a.get("tourstages")||"").split(";").filter(function(e){return e.length>0}),cars_physics:a.get("PhysicsModId")||this.cars_physics.car_physics_id,has_legs:null!==a.get("has_legs")}}return{track_ids:[],cars_physics:"0",has_legs:!1}},tournamentPostOutput:function(){return L({tour_name:this.tournament.name.trim(),tour_descr:this.tournament.description,online:this.tournament.online?"on":null,offlinet:this.tournament.offline?"on":null,PhysicsModId:this.cars_physics.car_physics_id,tour_from_date:O(this.tournament.from_date),tour_from_time:this.tournament.from_time,tour_to_date:O(this.tournament.to_date),tour_to_time:this.tournament.to_time,cantresrace:this.tournament.cant_resume?"on":null,onecaronly:this.tournament.only_one_car?"on":null,nosplits:this.tournament.dont_show_splits?"on":null,notempres:this.tournament.dont_show_temporary_results_in_rbr?"on":null,notempresweb:this.tournament.dont_show_temporary_results_in_web?"on":null,savereplays:this.tournament.save_replays?"on":null,getcomments:this.tournament.require_stage_comments?"on":null,testrun:this.tournament.test_tournament?"on":null,ispassword:this.tournament.password?"on":null,tour_password:this.tournament.password||null,has_legs:this.legs.length>0?"on":null,need_enroll:this.tournament.registration_deadline?"on":null,enroll_close:this.tournament.registration_deadline||null,SRallyPenaltySel:this.tournament.superally_penalty.toString(),tourstages:this.tracks.map(function(e){return e.id}).join(";")+";"})},tournamentDummyPostOutput:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=R(),r=t.nextDay,a=t.nextThreeDays;return L(Object(_["a"])({},this.tournamentPostOutput(),{tour_name:"dummy",tour_from_date:O(P(r)),tour_from_time:"00:00",tour_to_date:O(P(a)),tour_to_time:"23:59",PhysicsModId:J.carPhysics[0].id,has_legs:null},e))},carsPhysicsFromHTML:function(e){var t=this,r=(new DOMParser).parseFromString(e,"text/html"),a=r.getElementById("tournament");if(a){var n=new FormData(a),c=this.cars_physics.car_physics_id,o=n.getAll("ModsSel[]"),i=!0,l=!1,u=void 0;try{for(var d,h=function(){var e=d.value;e=e.toString(),X.byId[e]?t.cars_physics.selected_car_ids.push(e):X.trackPhysics[c].find(function(t){return e===t.id})&&(t.cars_physics.track_physics_id=e)},_=s()(o);!(i=(d=_.next()).done);i=!0)h()}catch(m){l=!0,u=m}finally{try{i||null==_.return||_.return()}finally{if(l)throw u}}}},carsPhysicsPostOutput:function(){return L({LicSel:["0"],ModsSel:[this.cars_physics.track_physics_id].concat(Object(d["a"])(this.cars_physics.selected_car_ids))})},trackFromHTML:function(e,t,r){var a=(new DOMParser).parseFromString(r,"text/html"),n=a.getElementById("tournament");if(n){var s=new FormData(n);return{id:e,name:s.get("stage_rename")||"",surface_type:s.get("SurfSel")||t.surface_type[0].id,surface_age:s.get("SurfAgeSel")||t.surface_age[0].id,weather:s.get("WeatherSel")||t.weather[0].id,weather2:s.get("Weather2Sel")||t.weather2[0].id,weather_change_allowed:null!==s.get("canchangeweather"),time_of_day:s.get("TimeOfDaySel")||t.time_of_day[0].id,clouds:s.get("CloudsSel")||t.clouds[0].id,service_time_mins:Number(s.get("ServiceSel"))||0,setup_change_allowed:null!==s.get("canchangesetup"),tyre_replacement_allowed:null!==s.get("canrenewtyres"),tyre_change_allowed:null!==s.get("canchangetyres"),tyres:s.get("TyresSel")||t.tyres_recommended,damage_change_allowed:null!==s.get("canchangedamage"),damage:s.get("DamageSel")||t.damage[t.damage.length-1].id,shortcut_check:s.get("CutcheckerSel")||t.shortcut_check[0].id,superally:null!==s.get("allowsuperally"),superally_hold:null!==s.get("superallychpoint"),retry_allowed:null!==s.get("canrepeatstage")}}return null},trackPostOutput:function(e){var t=this.tracks[e],r=e===this.tracks.length-1;return L({renamestage:t.name?"on":null,stage_rename:t.name,CarSel:this.cars_physics.selected_car_ids[0],SurfSel:t.surface_type,SurfAgeSel:t.surface_age,TexturesPackSel:"-1",WeatherPackSel:"-1",canchangeweather:t.weather_change_allowed?"on":null,WeatherSel:t.weather,TimeOfDaySel:t.time_of_day,Weather2Sel:t.weather2,CloudsSel:t.clouds,ServiceSel:r?null:t.service_time_mins.toString(),canrenewtyres:t.tyre_replacement_allowed?"on":null,canchangetyres:t.tyre_change_allowed?"on":null,TyresSel:t.tyres,canchangedamage:t.damage_change_allowed?"on":null,DamageSel:t.damage,CutcheckerSel:t.shortcut_check,leg_pos:0===this.legs.length?null:this.legs.reduce(function(t,r,a){return e>r.after_stage_divider?a+1:t},0),allowsuperally:t.superally?"on":null,superallychpoint:t.superally_hold?"on":null,canrepeatstage:t.retry_allowed?"on":null,canchangesetup:t.setup_change_allowed?"on":null})},trackFixIncorrectService:function(){if(this.tracks.length>0){var e=this.tracks[this.tracks.length-1];e.service_time_mins=0,e.tyre_replacement_allowed=!1}},legsFromHTML:function(e){var t=(new DOMParser).parseFromString(e,"text/html"),r=D(t,"/html/body/table/tbody/tr/td/table[3]/tbody/tr[1]/td[2]/form/table/tbody"),a=[];if(r){var n=!0,c=!1,o=void 0;try{for(var i,l=s()(r.children);!(n=(i=l.next()).done);n=!0){var u=i.value,d=!isNaN(Number(u.children[0].textContent||""));if(d&&!(u.children.length<7)){var h=u.children[1].textContent||"",_=h.match(/(\d+) - (\d+)/);if(_){var m=Number(_[2]),p=T(u.children[5].children[0].getAttribute("value")||""),f=u.children[6].children[0].getAttribute("value")||"";a.push({stages_to:m,date_to:p,time_to:f})}}}}catch(k){c=!0,o=k}finally{try{n||null==l.return||l.return()}finally{if(c)throw o}}}for(var g=0;g<a.length;g++){var v=g===a.length-1;if(!v){var y=a[g];this.legs.push({after_stage_divider:y.stages_to-1,date:y.date_to,time:y.time_to})}}},legsPostOutput:function(){var e=this;return 0===this.legs.length?{}:this.legs.map(function(t,r){return{index:r,date_from:O(0===r?e.tournament.from_date:e.legs[r-1].date),time_from:0===r?e.tournament.from_time:e.legs[r-1].time,date_to:O(t.date),time_to:t.time}}).concat({index:this.legs.length,date_from:O(this.legs[this.legs.length-1].date),time_from:this.legs[this.legs.length-1].time,date_to:O(this.tournament.to_date),time_to:this.tournament.to_time}).reduce(function(t,r,a){var n={};return a>0&&(n["leg".concat(a,"_date_from")]=r.date_from,n["leg".concat(a,"_time_from")]=r.time_from),a<=e.legs.length-1&&(n["leg".concat(a,"_date_to")]=r.date_to,n["leg".concat(a,"_time_to")]=r.time_to),Object(_["a"])({},t,n)},{})}},Y=k["componentFactory"].create({name:"Tournament",computed:{superally:function(){return J.fetched?J.superally:void 0},tournament:function(){return G.tournament}},props:{errors:Object},render:function(e){var t=this;return e("table",[e("tbody",[e("tr",[e("td",[e("label",{attrs:{for:"tournament.name"}},["Tournament name"])]),e("td",[e("input",g()([{on:{input:function(e){e.target.composing||(t.tournament.name=e.target.value)}},attrs:{id:"tournament.name"},domProps:{value:t.tournament.name}},{directives:[{name:"model",value:t.tournament.name,modifiers:{}}]}])),e("div",{class:"error"},[this.errors.name])])]),e("tr",[e("td",[e("label",{attrs:{for:"tournament.description"}},["Tournament description"])]),e("td",[e("textarea",g()([{on:{input:function(e){e.target.composing||(t.tournament.description=e.target.value)}},attrs:{id:"tournament.description"},style:"background-color: #050505;",domProps:{value:t.tournament.description}},{directives:[{name:"model",value:t.tournament.description,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"tournament.online"}},[" Online tournament"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.tournament.online,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.tournament.online=r.concat([s])):c>-1&&(t.tournament.online=r.slice(0,c).concat(r.slice(c+1)))}else t.tournament.online=n}},attrs:{type:"checkbox",id:"tournament.online"},domProps:{checked:y()(t.tournament.online)?this._i(t.tournament.online,null)>-1:t.tournament.online}},{directives:[{name:"model",value:t.tournament.online,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"tournament.offline"}},[" Offline tournament"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.tournament.offline,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.tournament.offline=r.concat([s])):c>-1&&(t.tournament.offline=r.slice(0,c).concat(r.slice(c+1)))}else t.tournament.offline=n}},attrs:{type:"checkbox",id:"tournament.offline"},domProps:{checked:y()(t.tournament.offline)?this._i(t.tournament.offline,null)>-1:t.tournament.offline}},{directives:[{name:"model",value:t.tournament.offline,modifiers:{}}]}]))])]),e("tr",[e("td",["Valid from (",e("a",{attrs:{href:"https://greenwichmeantime.com/time-zone/europe/european-union/czech-republic/"}},["CET"]),") (blank = now)"]),e("td",[e("input",g()([{on:{input:function(e){e.target.composing||(t.tournament.from_date=e.target.value)}},attrs:{type:"date",id:"tournament.from_date"},domProps:{value:t.tournament.from_date}},{directives:[{name:"model",value:t.tournament.from_date,modifiers:{}}]}])),e("input",g()([{on:{input:function(e){e.target.composing||(t.tournament.from_time=e.target.value)}},attrs:{type:"time",id:"tournament.from_time"},domProps:{value:t.tournament.from_time}},{directives:[{name:"model",value:t.tournament.from_time,modifiers:{}}]}])),e("div",{class:"error"},[this.errors.from_datetime])])]),e("tr",[e("td",["Valid to (",e("a",{attrs:{href:"https://greenwichmeantime.com/time-zone/europe/european-union/czech-republic/"}},["CET"]),")"]),e("td",[e("input",g()([{on:{input:function(e){e.target.composing||(t.tournament.to_date=e.target.value)}},attrs:{type:"date",id:"tournament.from_to"},domProps:{value:t.tournament.to_date}},{directives:[{name:"model",value:t.tournament.to_date,modifiers:{}}]}])),e("input",g()([{on:{input:function(e){e.target.composing||(t.tournament.to_time=e.target.value)}},attrs:{type:"time",id:"tournament.from_to"},domProps:{value:t.tournament.to_time}},{directives:[{name:"model",value:t.tournament.to_time,modifiers:{}}]}])),e("div",{class:"error"},[this.errors.to_datetime])])]),e("tr",[e("td",[e("label",{attrs:{for:"tournament.cant_resume"}},["Can't resume tournament"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.tournament.cant_resume,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.tournament.cant_resume=r.concat([s])):c>-1&&(t.tournament.cant_resume=r.slice(0,c).concat(r.slice(c+1)))}else t.tournament.cant_resume=n}},attrs:{type:"checkbox",id:"tournament.cant_resume"},domProps:{checked:y()(t.tournament.cant_resume)?this._i(t.tournament.cant_resume,null)>-1:t.tournament.cant_resume}},{directives:[{name:"model",value:t.tournament.cant_resume,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"tournament.only_one_car"}},["Only one car"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.tournament.only_one_car,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.tournament.only_one_car=r.concat([s])):c>-1&&(t.tournament.only_one_car=r.slice(0,c).concat(r.slice(c+1)))}else t.tournament.only_one_car=n}},attrs:{type:"checkbox",id:"tournament.only_one_car"},domProps:{checked:y()(t.tournament.only_one_car)?this._i(t.tournament.only_one_car,null)>-1:t.tournament.only_one_car}},{directives:[{name:"model",value:t.tournament.only_one_car,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"tournament.dont_show_splits"}},["Don't show splits"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.tournament.dont_show_splits,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.tournament.dont_show_splits=r.concat([s])):c>-1&&(t.tournament.dont_show_splits=r.slice(0,c).concat(r.slice(c+1)))}else t.tournament.dont_show_splits=n}},attrs:{type:"checkbox",id:"tournament.dont_show_splits"},domProps:{checked:y()(t.tournament.dont_show_splits)?this._i(t.tournament.dont_show_splits,null)>-1:t.tournament.dont_show_splits}},{directives:[{name:"model",value:t.tournament.dont_show_splits,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"tournament.dont_show_temporary_results_in_rbr"}},["Don't show temporary results in RBR"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.tournament.dont_show_temporary_results_in_rbr,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.tournament.dont_show_temporary_results_in_rbr=r.concat([s])):c>-1&&(t.tournament.dont_show_temporary_results_in_rbr=r.slice(0,c).concat(r.slice(c+1)))}else t.tournament.dont_show_temporary_results_in_rbr=n}},attrs:{type:"checkbox",id:"tournament.dont_show_temporary_results_in_rbr"},domProps:{checked:y()(t.tournament.dont_show_temporary_results_in_rbr)?this._i(t.tournament.dont_show_temporary_results_in_rbr,null)>-1:t.tournament.dont_show_temporary_results_in_rbr}},{directives:[{name:"model",value:t.tournament.dont_show_temporary_results_in_rbr,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"tournament.dont_show_temporary_results_in_web"}},["Don't show temporary results on web"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.tournament.dont_show_temporary_results_in_web,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.tournament.dont_show_temporary_results_in_web=r.concat([s])):c>-1&&(t.tournament.dont_show_temporary_results_in_web=r.slice(0,c).concat(r.slice(c+1)))}else t.tournament.dont_show_temporary_results_in_web=n}},attrs:{type:"checkbox",id:"tournament.dont_show_temporary_results_in_web"},domProps:{checked:y()(t.tournament.dont_show_temporary_results_in_web)?this._i(t.tournament.dont_show_temporary_results_in_web,null)>-1:t.tournament.dont_show_temporary_results_in_web}},{directives:[{name:"model",value:t.tournament.dont_show_temporary_results_in_web,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"tournament.save_replays"}},["Save replays"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.tournament.save_replays,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.tournament.save_replays=r.concat([s])):c>-1&&(t.tournament.save_replays=r.slice(0,c).concat(r.slice(c+1)))}else t.tournament.save_replays=n}},attrs:{type:"checkbox",id:"tournament.save_replays"},domProps:{checked:y()(t.tournament.save_replays)?this._i(t.tournament.save_replays,null)>-1:t.tournament.save_replays}},{directives:[{name:"model",value:t.tournament.save_replays,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"tournament.require_stage_comments"}},["Require stage comments"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.tournament.require_stage_comments,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.tournament.require_stage_comments=r.concat([s])):c>-1&&(t.tournament.require_stage_comments=r.slice(0,c).concat(r.slice(c+1)))}else t.tournament.require_stage_comments=n}},attrs:{type:"checkbox",id:"tournament.require_stage_comments"},domProps:{checked:y()(t.tournament.require_stage_comments)?this._i(t.tournament.require_stage_comments,null)>-1:t.tournament.require_stage_comments}},{directives:[{name:"model",value:t.tournament.require_stage_comments,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"tournament.test_tournament"}},["Testing (tournament will be deleted after 14 days)"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.tournament.test_tournament,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.tournament.test_tournament=r.concat([s])):c>-1&&(t.tournament.test_tournament=r.slice(0,c).concat(r.slice(c+1)))}else t.tournament.test_tournament=n}},attrs:{type:"checkbox",id:"tournament.test_tournament"},domProps:{checked:y()(t.tournament.test_tournament)?this._i(t.tournament.test_tournament,null)>-1:t.tournament.test_tournament}},{directives:[{name:"model",value:t.tournament.test_tournament,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"tournament.password"}},["Password"])]),e("td",[e("input",g()([{on:{input:function(e){e.target.composing||(t.tournament.password=e.target.value)}},attrs:{id:"tournament.password",placeholder:"No password"},domProps:{value:t.tournament.password}},{directives:[{name:"model",value:t.tournament.password,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"tournament.registration_deadline"}},["Registration deadline (hours before tournament start)"])]),e("td",[e("input",g()([{on:{input:function(e){e.target.composing||(t.tournament.registration_deadline=e.target.value)}},attrs:{id:"tournament.registration_deadline",placeholder:"No registration"},domProps:{value:t.tournament.registration_deadline}},{directives:[{name:"model",value:t.tournament.registration_deadline,modifiers:{}}]}])),e("div",{class:"error"},[this.errors.registration_deadline])])]),e("tr",[e("td",["Superally penalty"]),e("td",[this.superally?e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.tournament.superally_penalty=e.target.multiple?r:r[0]}}},{directives:[{name:"model",value:t.tournament.superally_penalty,modifiers:{}}]}]),[this.superally.map(function(t){return e("option",{key:"superally".concat(t.id),domProps:{value:t.id}},[t.label])})]):e("div",["Loading..."])])])])])}});var Z=k["componentFactory"].create({name:"Cars",data:function(){return{car_pack:"",available_cars_selected_ids:[],selected_cars_selected_ids:[],cars_physics:G.cars_physics}},props:{errors:Object},computed:{car_physics_select:function(){return J.fetched?J.carPhysics:void 0},track_physics_select:function(){return X.trackPhysics[this.cars_physics.car_physics_id]||[]},car_packs_select:function(){if(!this.car_physics_select)return[];if(!X.carPacks[this.cars_physics.car_physics_id])return[];var e=X.carPacks[this.cars_physics.car_physics_id];return u()(e).map(function(t){return{id:t,label:e[t].name}})},available_cars:function(){if(!this.car_packs_select)return[];var e=X.carPacks[this.cars_physics.car_physics_id][this.car_pack];return this.carIdsForSelect(e.cars)},selected_cars:function(){return this.carIdsForSelect(this.cars_physics.selected_car_ids)}},methods:{addToSelected:function(e){this.cars_physics.selected_car_ids=this.cars_physics.selected_car_ids.concat(e).filter(function(e,t,r){return r.indexOf(e)===t}),this.available_cars_selected_ids=[]},addSelected:function(){this.addToSelected(this.available_cars_selected_ids)},addAll:function(){this.addToSelected(this.available_cars.map(function(e){return e.id}))},removeSelected:function(){var e=this;this.cars_physics.selected_car_ids=this.cars_physics.selected_car_ids.filter(function(t){return!e.selected_cars_selected_ids.includes(t)})},removeAll:function(){this.cars_physics.selected_car_ids=[],this.selected_cars_selected_ids=[]},carIdsForSelect:function(e){return e.map(function(e){return{id:e,value:X.byId[e]}}).sort(function(e,t){return e.value.toLowerCase()>t.value.toLowerCase()?1:-1})}},watch:{"cars_physics.car_physics_id":function(){this.cars_physics.track_physics_id="",this.cars_physics.selected_car_ids=[],this.car_pack="",this.removeAll()}},render:function(e){var t=this;return e("table",[e("tbody",[e("tr",[e("td",{style:"vertical-align: top;"},[e("div",["Car physics",this.car_physics_select?e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.cars_physics.car_physics_id=e.target.multiple?r:r[0]}},style:"width: 100%;"},{directives:[{name:"model",value:t.cars_physics.car_physics_id,modifiers:{}}]}]),[e("option",{attrs:{disabled:!0,value:""}},["Select car physics"]),this.car_physics_select.map(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[t.label])})]):e("div",["Loading..."])]),e("div",["Track physics",e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.cars_physics.track_physics_id=e.target.multiple?r:r[0]}},style:"width: 100%;"},{directives:[{name:"model",value:t.cars_physics.track_physics_id,modifiers:{}}]}]),[e("option",{attrs:{disabled:!0,value:""}},[X.fetching[this.cars_physics.car_physics_id]?"Loading...":this.cars_physics.car_physics_id?"Select track physics":"Select car physics first"]),this.track_physics_select.map(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[t.label])})])]),e("div",["Car pack",e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.car_pack=e.target.multiple?r:r[0]}},style:"width: 100%;"},{directives:[{name:"model",value:t.car_pack,modifiers:{}}]}]),[e("option",{attrs:{disabled:!0,value:""}},[X.fetching[this.cars_physics.car_physics_id]?"Loading...":this.cars_physics.car_physics_id?"Select car pack":"Select car physics first"]),this.car_packs_select.map(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[t.label])})])]),e("div",[e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.available_cars_selected_ids=e.target.multiple?r:r[0]}},attrs:{multiple:!0},style:"width: 100%; min-width: 200px; height: 400px;"},{directives:[{name:"model",value:t.available_cars_selected_ids,modifiers:{}}]}]),[this.car_pack?this.available_cars.map(function(r){return e("option",{key:r.id,attrs:{title:r.value},domProps:{value:r.id},on:{dblclick:t.addSelected}},[r.value])}):e("option",{attrs:{disabled:!0,value:""}},["No car pack selected"])])])]),e("td",{class:"select-buttons"},[e("button",{on:{click:this.addSelected},style:"text-align: left;"},["Add selected >"]),e("button",{on:{click:this.addAll},style:"text-align: left;"},["Add all >>"]),e("button",{on:{click:this.removeSelected},style:"text-align: right;"},["< Remove selected"]),e("button",{on:{click:this.removeAll},style:"text-align: right;"},["<< Remove all"])]),e("td",[e("div",["Selected cars"]),e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.selected_cars_selected_ids=e.target.multiple?r:r[0]}},attrs:{multiple:!0},style:"width: 100%; min-width: 200px; height: 500px;"},{directives:[{name:"model",value:t.selected_cars_selected_ids,modifiers:{}}]}]),[this.errors.selected_cars&&e("option",{class:"error"},[this.errors.selected_cars]),this.selected_cars.map(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[t.value])})])])])])])}});var $=k["componentFactory"].create({name:"TrackList",data:function(){return{selected_track_groups:[""],available_tracks_filter:"",available_tracks_selected_ids:[],tracks_selected_indexes:[],tracks:G.tracks,tracks_data:B.byId}},props:{errors:Object},computed:{available_track_groups:function(){var e=[],t=[];return i()(this.tracks_data).forEach(function(r){e.includes(r.country)||e.push(r.country),t.includes(r.surface)||t.push(r.surface)}),[].concat(Object(d["a"])(t.sort()),Object(d["a"])(e.sort()))},available_tracks_select:function(){var e=this;return u()(this.tracks_data).map(function(t){return{id:t,value:e.tracks_data[t]}}).sort(function(e,t){return e.value.name>t.value.name?1:-1}).filter(function(t){return e.selected_track_groups.includes("")||e.selected_track_groups.includes(t.value.country)||e.selected_track_groups.includes(t.value.surface)}).filter(function(t){return""===e.available_tracks_filter||-1!==t.value.name.toLowerCase().indexOf(e.available_tracks_filter.toLowerCase())})},total_distance:function(){var e=this;return this.tracks.reduce(function(t,r){return t+e.tracks_data[r.id].distance},0).toFixed(1)},isLoading:function(){return B.fetching}},methods:{addToSelected:function(e){G.trackAdd(e)},addSelected:function(){this.addToSelected(this.available_tracks_selected_ids)},moveSelected:function(e){for(var t=this.tracks_selected_indexes.sort(function(t,r){return(e>=0?t>r:t<r)?-1:1}),r=0;r<t.length;r++){var a=t[r];if(!G.trackMove(a,e))break;this.tracks_selected_indexes[r]+=e}},addRandom:function(){var e=this.available_tracks_select[Math.floor(Math.random()*this.available_tracks_select.length)].id;e&&this.addToSelected([e])},removeSelected:function(){this.tracks_selected_indexes.sort(function(e,t){return e>t?-1:1}).forEach(function(e){G.trackRemove(e)})},removeAll:function(){this.tracks.splice(0)}},render:function(e){var t=this;return this.isLoading?e("div",["Loading track list..."]):e("table",[e("tbody",[e("tr",[e("td",[e("div",["Track groups"]),e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.selected_track_groups=e.target.multiple?r:r[0]}},attrs:{multiple:!0},style:"height: 400px;"},{directives:[{name:"model",value:t.selected_track_groups,modifiers:{}}]}]),[e("option",{attrs:{value:""}},["All tracks"]),this.available_track_groups.map(function(t){return e("option",{domProps:{value:t},key:t},[t])})])]),e("td",[e("div",["Tracks"]),e("div",[e("input",g()([{on:{input:function(e){e.target.composing||(t.available_tracks_filter=e.target.value)}},style:"width: 100%;",attrs:{placeholder:"Search..."},domProps:{value:t.available_tracks_filter}},{directives:[{name:"model",value:t.available_tracks_filter,modifiers:{}}]}]))]),e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.available_tracks_selected_ids=e.target.multiple?r:r[0]}},attrs:{multiple:!0},style:"height: 382px; width: 200px"},{directives:[{name:"model",value:t.available_tracks_selected_ids,modifiers:{}}]}]),[this.available_tracks_select.map(function(r){return e("option",{domProps:{value:r.id},key:r.id,on:{dblclick:t.addSelected}},[r.value.name])})])]),e("td",{class:"select-buttons"},[e("button",{on:{click:function(){return t.moveSelected(-1)}},style:"text-align: left; margin-bottom: 16px;"},["^^^ Move selected"]),e("button",{on:{click:this.addSelected},style:"text-align: left;"},["Add selected >"]),e("button",{on:{click:this.addRandom},style:"text-align: left;"},["Add random >"]),e("button",{on:{click:this.removeSelected},style:"text-align: right;"},["< Remove selected"]),e("button",{on:{click:this.removeAll},style:"text-align: right;"},["<< Remove all"]),e("button",{on:{click:function(){return t.moveSelected(1)}},style:"text-align: right; margin-top: 16px;"},["Move selected vvv"])]),e("td",[e("div",["Selected tracks"]),e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.tracks_selected_indexes=e.target.multiple?r:r[0]},dblclick:this.removeSelected},attrs:{multiple:!0},style:"height: 400px; width: 200px"},{directives:[{name:"model",value:t.tracks_selected_indexes,modifiers:{}}]}]),[this.errors.selected_tracks&&e("option",{class:"error"},[this.errors.selected_tracks]),this.tracks.map(function(r,a){return e("option",{domProps:{value:a},key:"".concat(a).concat(r.id)},[a+1," - ",t.tracks_data[r.id].name])})]),e("div",["Total distance: ",this.total_distance," km"])])])])])}});var K=k["componentFactory"].create({name:"WeatherSelect",props:{track:Object},computed:{settings:function(){return H.byId[this.track.id]}},render:function(e){var t=this;return this.settings?e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.track.weather=e.target.multiple?r:r[0]}}},{directives:[{name:"model",value:t.track.weather,modifiers:{}}]}]),[this.settings.weather.map(function(t){return e("option",{key:"weather".concat(t.id),domProps:{value:t.id}},[t.label])})]):e("div",["Loading..."])}});var Q=k["componentFactory"].create({name:"SurfaceTypeSelect",props:{track:Object},computed:{settings:function(){return H.byId[this.track.id]}},render:function(e){var t=this;return this.settings?e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.track.surface_type=e.target.multiple?r:r[0]}}},{directives:[{name:"model",value:t.track.surface_type,modifiers:{}}]}]),[this.settings.surface_type.map(function(t){return e("option",{key:"surface_type".concat(t.id),domProps:{value:t.id}},[t.label])})]):e("div",["Loading..."])}});var ee=k["componentFactory"].create({name:"SurfaceAgeSelect",props:{track:Object},computed:{settings:function(){return H.byId[this.track.id]}},render:function(e){var t=this;return this.settings?e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.track.surface_age=e.target.multiple?r:r[0]}}},{directives:[{name:"model",value:t.track.surface_age,modifiers:{}}]}]),[this.settings.surface_age.map(function(t){return e("option",{key:"surface_age".concat(t.id),domProps:{value:t.id}},[t.label])})]):e("div",["Loading..."])}});var te=k["componentFactory"].create({name:"ServiceSelect",props:{track:Object},render:function(e){var t=this;return e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.track.service_time_mins=e.target.multiple?r:r[0]}}},{directives:[{name:"model",value:t.track.service_time_mins,modifiers:{}}]}]),[e("option",{domProps:{value:0}},["No service"]),e("option",{domProps:{value:5}},["5 min."]),e("option",{domProps:{value:10}},["10 min."]),e("option",{domProps:{value:15}},["15 min."]),e("option",{domProps:{value:20}},["20 min."]),e("option",{domProps:{value:30}},["30 min."]),e("option",{domProps:{value:60}},["60 min."]),e("option",{domProps:{value:90}},["90 min."])])}});var re=k["componentFactory"].create({name:"DamageSelect",props:{track:Object},computed:{settings:function(){return H.byId[this.track.id]}},render:function(e){var t=this;return this.settings?e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.track.damage=e.target.multiple?r:r[0]}}},{directives:[{name:"model",value:t.track.damage,modifiers:{}}]}]),[this.settings.damage.map(function(t){return e("option",{key:"damage".concat(t.id),domProps:{value:t.id}},[t.label])})]):e("div",["Loading..."])}});var ae=k["componentFactory"].create({name:"TyreSelect",props:{track:Object},computed:{settings:function(){return H.byId[this.track.id]}},render:function(e){var t=this;return this.settings?e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.track.tyres=e.target.multiple?r:r[0]}}},{directives:[{name:"model",value:t.track.tyres,modifiers:{}}]}]),[this.settings.tyres.map(function(t){return e("option",{key:"tyres".concat(t.id),domProps:{value:t.id}},[t.label])})]):e("div",["Loading..."])}});var ne=k["componentFactory"].create({name:"ShortcutSelect",props:{track:Object},computed:{settings:function(){return H.byId[this.track.id]}},render:function(e){var t=this;return this.settings?e("select",g()([{on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.track.shortcut_check=e.target.multiple?r:r[0]}}},{directives:[{name:"model",value:t.track.shortcut_check,modifiers:{}}]}]),[this.settings.shortcut_check.map(function(t){return e("option",{key:"shortcut".concat(t.id),domProps:{value:t.id}},[t.label])})]):e("div",["Loading..."])}});var se=k["componentFactory"].create({name:"TrackWeatherSelect",props:{track:Object},computed:{options:function(){return U.byId[this.track.id]}},render:function(e){var t=this;return this.options?e("select",{on:{change:function(e){if(e.target){var r=e.target.value.split(","),a=Object(W["a"])(r,3),n=a[0],s=a[1],c=a[2];t.track.time_of_day=n,t.track.weather2=s,t.track.clouds=c}}}},[this.options.map(function(t){return e("option",{key:"t".concat(t.time_of_day.id,"w").concat(t.weather2.id,"c").concat(t.clouds.id),domProps:{value:"".concat(t.time_of_day.id,",").concat(t.weather2.id,",").concat(t.clouds.id)}},[t.time_of_day.label,"; ",t.weather2.label,"; ",t.clouds.label," ",t.remark?"(".concat(t.remark,")"):""])})]):e("div",["Loading..."])}});var ce=k["componentFactory"].create({name:"Track",props:{track:Object,index:Number},data:function(){return{tracks_data:B.byId,tracks_settings:H.byId[this.track.id],selected_car_ids:G.cars_physics.selected_car_ids}},computed:{track_data:function(){return this.tracks_data[this.track.id]},car_id_options:function(){return G.cars_physics.selected_car_ids.map(function(e){return{id:e,value:X.byId[e]}}).sort(function(e,t){return e.value.toLowerCase()>t.value.toLowerCase()?1:-1})},is_last_track:function(){return this.index===G.tracks.length-1}},watch:{"track.service_time_mins":function(e){e<=0&&(this.track.tyre_replacement_allowed=!1)}},render:function(e){var t=this;return e("table",[e("tbody",[e("tr",[e("td",["Original track name"]),e("td",[this.track_data.name])]),e("tr",[e("td",["Distance"]),e("td",[this.track_data.distance," km"])]),e("tr",[e("td",["Overriden track name"]),e("td",[e("input",g()([{on:{input:function(e){e.target.composing||(t.track.name=e.target.value)}},attrs:{placeholder:"None"},domProps:{value:t.track.name}},{directives:[{name:"model",value:t.track.name,modifiers:{}}]}]))])]),e("tr",[e("td",["Surface type"]),e("td",[e(Q,{attrs:{track:this.track}})])]),e("tr",[e("td",["Surface age"]),e("td",[e(ee,{attrs:{track:this.track}})])]),e("tr",[e("td",["Weather"]),e("td",[e(K,{attrs:{track:this.track}})])]),e("tr",[e("td",["Weather 2"]),e("td",[e(se,{attrs:{track:this.track}})])]),!1===this.is_last_track&&e("tr",[e("td",["Service area after this stage"]),e("td",[e(te,{attrs:{track:this.track}})])]),!1===this.is_last_track&&this.track.service_time_mins>0&&e("tr",[e("td",[e("label",{attrs:{for:"track.tyre_replacement_allowed"}},["Allow tyres replacement at service area"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.track.tyre_replacement_allowed,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.track.tyre_replacement_allowed=r.concat([s])):c>-1&&(t.track.tyre_replacement_allowed=r.slice(0,c).concat(r.slice(c+1)))}else t.track.tyre_replacement_allowed=n}},attrs:{type:"checkbox",id:"track.tyre_replacement_allowed"},domProps:{checked:y()(t.track.tyre_replacement_allowed)?this._i(t.track.tyre_replacement_allowed,null)>-1:t.track.tyre_replacement_allowed}},{directives:[{name:"model",value:t.track.tyre_replacement_allowed,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"track.setup_change_allowed"}},["Allow setup change"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.track.setup_change_allowed,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.track.setup_change_allowed=r.concat([s])):c>-1&&(t.track.setup_change_allowed=r.slice(0,c).concat(r.slice(c+1)))}else t.track.setup_change_allowed=n}},attrs:{type:"checkbox",id:"track.setup_change_allowed"},domProps:{checked:y()(t.track.setup_change_allowed)?this._i(t.track.setup_change_allowed,null)>-1:t.track.setup_change_allowed}},{directives:[{name:"model",value:t.track.setup_change_allowed,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"track.tyre_change_allowed"}},["Allow tyres type change"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.track.tyre_change_allowed,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.track.tyre_change_allowed=r.concat([s])):c>-1&&(t.track.tyre_change_allowed=r.slice(0,c).concat(r.slice(c+1)))}else t.track.tyre_change_allowed=n}},attrs:{type:"checkbox",id:"track.tyre_change_allowed"},domProps:{checked:y()(t.track.tyre_change_allowed)?this._i(t.track.tyre_change_allowed,null)>-1:t.track.tyre_change_allowed}},{directives:[{name:"model",value:t.track.tyre_change_allowed,modifiers:{}}]}]))])]),e("tr",[e("td",["Tyres"]),e("td",[e(ae,{attrs:{track:this.track}})])]),e("tr",[e("td",[e("label",{attrs:{for:"track.damage_change_allowed"}},["Allow damage change"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.track.damage_change_allowed,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.track.damage_change_allowed=r.concat([s])):c>-1&&(t.track.damage_change_allowed=r.slice(0,c).concat(r.slice(c+1)))}else t.track.damage_change_allowed=n}},attrs:{type:"checkbox",id:"track.damage_change_allowed"},domProps:{checked:y()(t.track.damage_change_allowed)?this._i(t.track.damage_change_allowed,null)>-1:t.track.damage_change_allowed}},{directives:[{name:"model",value:t.track.damage_change_allowed,modifiers:{}}]}]))])]),e("tr",[e("td",["Damage"]),e("td",[e(re,{attrs:{track:this.track}})])]),e("tr",[e("td",["Shortcuts checking"]),e("td",[e(ne,{attrs:{track:this.track}})])]),e("tr",[e("td",[e("label",{attrs:{for:"track.superally"}},["Allow superally in this stage"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.track.superally,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.track.superally=r.concat([s])):c>-1&&(t.track.superally=r.slice(0,c).concat(r.slice(c+1)))}else t.track.superally=n}},attrs:{type:"checkbox",id:"track.superally"},domProps:{checked:y()(t.track.superally)?this._i(t.track.superally,null)>-1:t.track.superally}},{directives:[{name:"model",value:t.track.superally,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"track.superally_hold"}},["Superally hold this stage"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.track.superally_hold,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.track.superally_hold=r.concat([s])):c>-1&&(t.track.superally_hold=r.slice(0,c).concat(r.slice(c+1)))}else t.track.superally_hold=n}},attrs:{type:"checkbox",id:"track.superally_hold"},domProps:{checked:y()(t.track.superally_hold)?this._i(t.track.superally_hold,null)>-1:t.track.superally_hold}},{directives:[{name:"model",value:t.track.superally_hold,modifiers:{}}]}]))])]),e("tr",[e("td",[e("label",{attrs:{for:"track.retry_allowed"}},["Allow to retry this stage"])]),e("td",[e("input",g()([{on:{change:function(e){var r=t.track.retry_allowed,a=e.target,n=!!a.checked;if(y()(r)){var s=null,c=t._i(r,s);a.checked?c<0&&(t.track.retry_allowed=r.concat([s])):c>-1&&(t.track.retry_allowed=r.slice(0,c).concat(r.slice(c+1)))}else t.track.retry_allowed=n}},attrs:{type:"checkbox",id:"track.retry_allowed"},domProps:{checked:y()(t.track.retry_allowed)?this._i(t.track.retry_allowed,null)>-1:t.track.retry_allowed}},{directives:[{name:"model",value:t.track.retry_allowed,modifiers:{}}]}]))])])])])}});var oe=k["componentFactory"].create({name:"Legs",data:function(){return{tracks_data:B.byId,tracks_settings:H.byId,tracks:G.tracks,legs:G.legs,store:G}},props:{errors:Object},computed:{maxStageDivider:function(){return this.legs.reduce(function(e,t){return t.after_stage_divider>e?t.after_stage_divider:e},0)},canAddLeg:function(){return this.tracks.length>=2&&(0===this.legs.length||this.maxStageDivider<this.tracks.length-2)},lastLeg:function(){return this.legs[this.legs.length-1]}},methods:{arrayCanMoveElement:C,addLeg:function(){if(!1!==this.canAddLeg){var e=this.store.tournament.from_date,t=this.legs[this.legs.length-1];if(t){var r=Number(new Date(t.date)),a=r+864e5;e=P(new Date(a))}this.legs.push({after_stage_divider:0===this.legs.length?0:this.maxStageDivider+1,date:e,time:"23:59"})}},canMoveLegUp:function(e){return e>0&&void 0===this.legs.find(function(t){return t.after_stage_divider===e-1})},moveLegUp:function(e){if(!1!==this.canMoveLegUp(e)){var t=!0,r=!1,a=void 0;try{for(var n,c=s()(this.legs);!(t=(n=c.next()).done);t=!0){var o=n.value;if(o.after_stage_divider===e){o.after_stage_divider--;break}}}catch(i){r=!0,a=i}finally{try{t||null==c.return||c.return()}finally{if(r)throw a}}}},canMoveLegDown:function(e){return e<this.tracks.length-2&&void 0===this.legs.find(function(t){return t.after_stage_divider===e+1})},moveLegDown:function(e){if(!1!==this.canMoveLegDown(e)){var t=!0,r=!1,a=void 0;try{for(var n,c=s()(this.legs);!(t=(n=c.next()).done);t=!0){var o=n.value;if(o.after_stage_divider===e){o.after_stage_divider++;break}}}catch(i){r=!0,a=i}finally{try{t||null==c.return||c.return()}finally{if(r)throw a}}}},removeLeg:function(e){for(var t=0;t<this.legs.length;t++)if(this.legs[t].after_stage_divider===e){this.legs.splice(t,1);break}}},render:function(e){var t=this;return e("div",[e("table",[e("tbody",[this.tracks.map(function(r,a){return[e("tr",{key:a},[e("td",{style:"vertical-align: top; min-width: 40px;"},["SS ",a+1]),e("td",{class:"schedule-legs-inputs",style:"vertical-align: top;"},[e("div",[e("input",g()([{on:{input:function(e){e.target.composing||(r.name=e.target.value)}},attrs:{placeholder:t.tracks_data[r.id].name},domProps:{value:r.name}},{directives:[{name:"model",value:r.name,modifiers:{}}]}])),e(K,{attrs:{track:r}}),e(re,{attrs:{track:r}})]),e("div",[e(ae,{attrs:{track:r}}),e(Q,{attrs:{track:r}}),e(ee,{attrs:{track:r}}),e(te,{attrs:{track:r}})]),e("div",[e("input",g()([{on:{change:function(e){var a=r.tyre_change_allowed,n=e.target,s=!!n.checked;if(y()(a)){var c=null,o=t._i(a,c);n.checked?o<0&&(r.tyre_change_allowed=a.concat([c])):o>-1&&(r.tyre_change_allowed=a.slice(0,o).concat(a.slice(o+1)))}else r.tyre_change_allowed=s}},attrs:{id:"tcbox".concat(a),type:"checkbox"},domProps:{checked:y()(r.tyre_change_allowed)?t._i(r.tyre_change_allowed,null)>-1:r.tyre_change_allowed}},{directives:[{name:"model",value:r.tyre_change_allowed,modifiers:{}}]}])),"    ",e("label",{attrs:{for:"tcbox".concat(a)}},["Tyre change"]),e("input",g()([{on:{change:function(e){var a=r.setup_change_allowed,n=e.target,s=!!n.checked;if(y()(a)){var c=null,o=t._i(a,c);n.checked?o<0&&(r.setup_change_allowed=a.concat([c])):o>-1&&(r.setup_change_allowed=a.slice(0,o).concat(a.slice(o+1)))}else r.setup_change_allowed=s}},attrs:{id:"scbox".concat(a),type:"checkbox"},domProps:{checked:y()(r.setup_change_allowed)?t._i(r.setup_change_allowed,null)>-1:r.setup_change_allowed}},{directives:[{name:"model",value:r.setup_change_allowed,modifiers:{}}]}])),"   ",e("label",{attrs:{for:"scbox".concat(a)}},["Setup change"]),e("input",g()([{on:{change:function(e){var a=r.superally,n=e.target,s=!!n.checked;if(y()(a)){var c=null,o=t._i(a,c);n.checked?o<0&&(r.superally=a.concat([c])):o>-1&&(r.superally=a.slice(0,o).concat(a.slice(o+1)))}else r.superally=s}},attrs:{id:"srbox".concat(a),type:"checkbox"},domProps:{checked:y()(r.superally)?t._i(r.superally,null)>-1:r.superally}},{directives:[{name:"model",value:r.superally,modifiers:{}}]}])),"              ",e("label",{attrs:{for:"srbox".concat(a)}},["Superally"]),e("input",g()([{on:{change:function(e){var a=r.superally_hold,n=e.target,s=!!n.checked;if(y()(a)){var c=null,o=t._i(a,c);n.checked?o<0&&(r.superally_hold=a.concat([c])):o>-1&&(r.superally_hold=a.slice(0,o).concat(a.slice(o+1)))}else r.superally_hold=s}},attrs:{id:"srhbox".concat(a),type:"checkbox"},domProps:{checked:y()(r.superally_hold)?t._i(r.superally_hold,null)>-1:r.superally_hold}},{directives:[{name:"model",value:r.superally_hold,modifiers:{}}]}])),"         ",e("label",{attrs:{for:"srhbox".concat(a)}},["Superally hold"])])]),e("td",{style:"width: 50px;"},[e("button",{attrs:{title:"Move track up",disabled:!1===t.arrayCanMoveElement(t.tracks,a,-1)},style:"width: 100%;",on:{click:function(){return G.trackMoveUp(a)}}},["^"]),e("button",{attrs:{title:"Move track down",disabled:!1===C(t.tracks,a,1)},style:"width: 100%;",on:{click:function(){return G.trackMoveDown(a)}}},["v"]),e("button",{attrs:{title:"Remove track"},style:"width: 100%;",on:{click:function(){return G.trackRemove(a)}}},["X"])])]),r.service_time_mins>0&&e("tr",[e("th",{attrs:{colspan:3}},["Service area (",r.service_time_mins," min.) / ",e("input",g()([{on:{change:function(e){var a=r.tyre_replacement_allowed,n=e.target,s=!!n.checked;if(y()(a)){var c=null,o=t._i(a,c);n.checked?o<0&&(r.tyre_replacement_allowed=a.concat([c])):o>-1&&(r.tyre_replacement_allowed=a.slice(0,o).concat(a.slice(o+1)))}else r.tyre_replacement_allowed=s}},attrs:{type:"checkbox"},domProps:{checked:y()(r.tyre_replacement_allowed)?t._i(r.tyre_replacement_allowed,null)>-1:r.tyre_replacement_allowed}},{directives:[{name:"model",value:r.tyre_replacement_allowed,modifiers:{}}]}]))," Tyre replacement"])]),r.superally_hold&&e("tr",[e("th",{attrs:{colspan:3}},["Superally"])]),t.legs.map(function(r,n){return a!==r.after_stage_divider?null:e("tr",{key:"".concat(a," ").concat(r,"leg")},[e("th",{attrs:{colspan:3},style:"text-align: center",class:"leg_revamped"},[e("button",{attrs:{title:"Move leg up",disabled:!1===t.canMoveLegUp(r.after_stage_divider)},on:{click:function(){return t.moveLegUp(r.after_stage_divider)}}},["^^^"]),"Leg ",n+1,e("input",g()([{on:{input:function(e){e.target.composing||(r.date=e.target.value)}},attrs:{type:"date"},domProps:{value:r.date}},{directives:[{name:"model",value:r.date,modifiers:{}}]}])),e("input",g()([{on:{input:function(e){e.target.composing||(r.time=e.target.value)}},attrs:{type:"time"},domProps:{value:r.time}},{directives:[{name:"model",value:r.time,modifiers:{}}]}])),e("button",{attrs:{title:"Remove leg"},on:{click:function(){return t.removeLeg(r.after_stage_divider)}}},["Remove"]),"Leg ",n+2,e("button",{attrs:{title:"Move leg down",disabled:!1===t.canMoveLegDown(r.after_stage_divider)},on:{click:function(){return t.moveLegDown(r.after_stage_divider)}}},["vvv"]),e("div",[t.errors[r.after_stage_divider]])])])})]})])]),e("table",{style:"margin: 0 auto;"},[e("thead",[e("tr",[e("td",["Leg"]),e("td",["Stage"]),e("td",["Date from"]),e("td",["Date to"])])]),this.legs.length>0&&e("tbody",[this.legs.map(function(r,a){return e("tr",{key:"".concat(a," leg")},[e("td",[a+1]),0===a?e("td",["1 - ",r.after_stage_divider+1]):(t.legs.length,e("td",[t.legs[a-1].after_stage_divider+2," - ",r.after_stage_divider+1])),e("td",0===a?[G.tournament.from_date," ",G.tournament.from_time]:[t.legs[a-1].date," ",t.legs[a-1].time]),e("td",[r.date," ",r.time])])}),e("tr",[e("td",[this.legs.length+1]),e("td",[this.lastLeg.after_stage_divider+2," - ",this.store.tracks.length]),e("td",[this.lastLeg.date," ",this.lastLeg.time]),e("td",[G.tournament.to_date," ",G.tournament.to_time])])]),0===this.legs.length&&e("tbody",{style:"text-align: center;"},[e("td",{attrs:{colspan:4}},["No legs created"])]),e("tfoot",[e("tr",[e("td",{attrs:{colspan:4},style:"text-align: center;"},[e("button",{on:{click:this.addLeg},attrs:{disabled:!1===this.canAddLeg}},["Add leg"])])])])])])}});var ie=r("5176"),le=r.n(ie),ue=(r("6c7b"),k["componentFactory"].create({name:"Presets",data:function(){return{store:G,saveNames:new Array(10).fill(void 0)}},methods:{save:function(e,t){t&&t.trim()&&(this.saveNames=this.saveNames.map(function(r,a){return a!==e?r:t}),localStorage.setItem("save".concat(e),S()(this.store)))},load:function(e){var t=this,r=localStorage.getItem("save".concat(e));r&&(le()(this.store,JSON.parse(r)),this.store.tracks.forEach(function(e){t.store.trackFetchInfo(e.id)}))}},mounted:function(){var e=localStorage.getItem("save_names");e&&(this.saveNames=JSON.parse(e))},watch:{saveNames:function(){localStorage.setItem("save_names",S()(this.saveNames))}},computed:{output:function(){return{tournament:this.store.tournamentPostOutput(),cars_physics:this.store.carsPhysicsPostOutput(),tracks:this.store.tracks.map(function(e,t){return G.trackPostOutput(t)}),legs:this.store.legsPostOutput()}}},render:function(e){var t=this;return e("div",[e("div",["Save slot: ",new Array(10).fill(0).map(function(r,a){return e("button",{on:{click:function(){return t.save(a,prompt("Enter the slot save name"))}}},[a+1])})]),e("div",["Load slot: ",this.saveNames.map(function(r,a){return e("button",{on:{click:function(){return t.load(a)}},attrs:{disabled:!1===Boolean(r)}},[a+1," ",r?"- ".concat(r):""])})]),e("table",[e("thead",[e("tr",[e("td",["JSON Data"]),e("td",["Output data"])])]),e("tbody",[e("tr",[e("td",{style:"vertical-align: top;"},[e("pre",[S()(this.store,null,4).trim()])]),e("td",{style:"vertical-align: top;"},[e("pre",[S()(this.output,null,4).trim()])])])])])])}}));var de;r("41d0");(function(e){e["Tournament"]="tournament",e["Cars"]="cars",e["TrackList"]="track_list",e["Track"]="track",e["ScheduleLegs"]="schedule_legs",e["Presets"]="presets"})(de||(de={}));var he=a["default"].extend({name:"App",data:function(){return{current_page:de.Tournament,track_index:0,store:G,hidden:"",current_request_operation:"",serverErrors:[]}},computed:{tracks_data:function(){return B.byId},tracks_settings:function(){return H},tracks_weather:function(){return U},from_date:function(){var e=this.store.tournament,t=e.from_date,r=e.from_time;return t||r?r?new Date("".concat(t,"T").concat(r,"+0100")):new Date("".concat(t,"T23:59:00+0100")):new Date},to_date:function(){var e=this.store.tournament,t=e.to_date,r=e.to_time;return new Date("".concat(t,"T").concat(r,"+0100"))},cars_errors:function(){var e=this.store.cars_physics,t=e.selected_car_ids,r=e.car_physics_id,a=e.track_physics_id;return{selected_cars:0===t.length?"Must select atleast one car":"",car_physics:0===r.length?"Must select car physics":"",track_physics:0===a.length?"Must select track physics":""}},tracks_errors:function(){return{selected_tracks:0===this.store.tracks.length?"Must select atleast one track":""}},tournament_errors:function(){var e=new Date,t=new Date(Number(this.from_date)+864e5),r=new Date(Number(this.from_date)+6048e5),a=Number(this.store.tournament.registration_deadline);return{name:0===this.store.tournament.name.trim().length?"Enter the tournament name":"",from_datetime:this.from_date<e?"This date cannot be set earlier than now":this.from_date>=this.to_date?"This date cannot be set later than 'Valid to' date":"",to_datetime:this.to_date<t?"This date must be set atleast 24 hours after the tournament beginning":this.to_date>r?"This date cannot be set to end after more than 7 days":this.to_date<=this.from_date?"This date cannot be set earlier than 'Valid from' date":"",registration_deadline:0===this.store.tournament.registration_deadline.trim().length?"":isNaN(a)?"Must be a number":a<=0?"Must be positive":!1===p()(a)?"Must be integer":""}},legs_errors:function(){var e=this;return this.store.legs.sort(function(e,t){return e.after_stage_divider>t.after_stage_divider?1:-1}).reduce(function(t,r,a,n){var s="",c=new Date("".concat(r.date,"T").concat(r.time,"+0100"));r.date||(s="Correct date must be set"),r.time||(s="Correct time must be set");var o=n[a-1];if(c<=e.from_date?s="This date must be set after the tournament start date: ".concat(e.from_date.toLocaleString()):c>=e.to_date&&(s="This date must be set before the tournament end date: ".concat(e.to_date.toLocaleString())),o){var i=new Date("".concat(o.date,"T").concat(o.time,"+0100"));c<=i&&(s="This date must be set after the previous leg split date")}return Object(_["a"])({},t,Object(h["a"])({},r.after_stage_divider,s))},{})},notifications:function(){var e=this;return[].concat(Object(d["a"])(u()(this.tracks_settings.fetching).map(function(t){return e.tracks_settings.fetching[t]?"Fetching settings for ".concat(B.byId[t].name):""})),Object(d["a"])(u()(this.tracks_weather.fetching).map(function(t){return e.tracks_settings.fetching[t]?"Fetching weather info for ".concat(B.byId[t].name):""}))).filter(function(e){return e.length>0})}},methods:{hasErrors:function(e){return i()(e).find(function(e){return!0===Boolean(e)})},submit:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,r,a,n,s,c,o,i,l,u,d,h,_,m,p;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.store.legs.length>0,this.serverErrors=[],r="/html/body/table/tbody/tr/td/table[3]/tbody/tr[1]/td[2]/span",a="/html/body/table/tbody/tr/td/table[3]/tbody/tr[1]/td[2]/center/span",e.prev=4,s=this.store.tournamentPostOutput(),this.current_request_operation="Sending tournament info",e.next=9,F(s,{flow:"0"});case 9:return n=e.sent,this.checkAndAppendServerErrors({page:"Tournament",errorsXPath:r,res:n}),c=this.store.carsPhysicsPostOutput(),this.current_request_operation="Sending Cars / Physics info",e.next=15,F(c,{flow:"1"});case 15:n=e.sent,this.checkAndAppendServerErrors({page:"Cars / Physics",errorsXPath:r,res:n}),o=0;case 18:if(!(o<this.store.tracks.length)){e.next=28;break}return i=this.store.trackPostOutput(o),this.current_request_operation="Sending SS ".concat(o+1," info"),e.next=23,F(i,{flow:"2",curstagepos:o.toString()});case 23:n=e.sent,this.checkAndAppendServerErrors({page:"SS ".concat(o+1),errorsXPath:a,res:n});case 25:o++,e.next=18;break;case 28:if(l=this.store.legsPostOutput(),!t){e.next=35;break}return this.current_request_operation="Sending legs info",e.next=33,F(l,{flow:"3",page_selector:(2+this.store.tracks.length).toString()});case 33:n=e.sent,this.checkAndAppendServerErrors({page:"Legs",errorsXPath:r,res:n});case 35:if(0!==this.serverErrors.length){e.next=46;break}return this.current_request_operation="Submitting tournament",e.next=39,F(t?l:s,{flow:t?"3":"0",save_tournament:!0,save_from_leg_page:t});case 39:return n=e.sent,e.next=42,n.text();case 42:u=e.sent,d=(new DOMParser).parseFromString(u,"text/html"),h=D(d,"/html/body/table/tbody/tr/td/table[3]/tbody/tr[1]/td[2]/center[3]/a"),h&&(_=h.getAttribute("href")||"",m=_.match(/torid=([^&]+)/),m&&(p=m[1],window.location.replace("index.php?act=tourmntsview&torid=".concat(p))));case 46:e.next=52;break;case 48:e.prev=48,e.t0=e["catch"](4),this.serverErrors=[{page:"Error",error:e.t0.message}],this.current_request_operation="";case 52:case"end":return e.stop()}},e,this,[[4,48]])}));function t(){return e.apply(this,arguments)}return t}(),checkAndAppendServerErrors:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var r,a,n,c,o,i,l,u,d,h,_,m;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.res,a=t.errorsXPath,n=t.page,e.t0=new DOMParser,e.next=4,r.text();case 4:if(e.t1=e.sent,c=e.t0.parseFromString.call(e.t0,e.t1,"text/html"),o=D(c,a),!o){e.next=39;break}i="",l=!0,u=!1,d=void 0,e.prev=12,h=s()(o.childNodes);case 14:if(l=(_=h.next()).done){e.next=24;break}if(m=_.value,"br"!==m.nodeName){e.next=20;break}return i&&this.serverErrors.push({page:n,error:i}),i="",e.abrupt("continue",21);case 20:i+=m.textContent;case 21:l=!0,e.next=14;break;case 24:e.next=30;break;case 26:e.prev=26,e.t2=e["catch"](12),u=!0,d=e.t2;case 30:e.prev=30,e.prev=31,l||null==h.return||h.return();case 33:if(e.prev=33,!u){e.next=36;break}throw d;case 36:return e.finish(33);case 37:return e.finish(30);case 38:i&&this.serverErrors.push({page:n,error:i});case 39:case"end":return e.stop()}},e,this,[[12,26,30,38],[31,,33,37]])}));function t(t){return e.apply(this,arguments)}return t}()},watch:{"store.tracks":function(e){if(e.length<2)G.legs.splice(0,G.legs.length);else for(var t=G.legs.length-1;t>=0;t--){var r=G.legs[t];r.after_stage_divider>=e.length-1&&G.legs.splice(t,1)}},"store.cars_physics.car_physics_id":function(e){X.fetchCars(e)},hidden:{immediate:!0,handler:function(e){var t=document.getElementById("tournament");t&&(t.style.display=e?"":"none")}}},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,r,a,n,c,o,i,l,u,d,h,m,p,f,g,v,y;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return J.fetchTournamentConstants(),this.current_request_operation="Fetching track information",e.next=4,B.fetchTracks();case 4:if(t=new URLSearchParams(window.location.search),r=t.get("torid"),!r){e.next=86;break}return e.prev=7,a=this.store.tournamentFromHTML(document.getElementsByTagName("html")[0].innerHTML),n=a.track_ids,c=a.cars_physics,o=a.has_legs,this.current_request_operation="Fetching Cars / Physics",e.next=12,X.fetchCars(c);case 12:this.store.cars_physics.car_physics_id=c,this.current_request_operation="Fetching track information",i=!0,l=!1,u=void 0,e.prev=17,d=s()(n);case 19:if(i=(h=d.next()).done){e.next=26;break}return m=h.value,e.next=23,G.trackFetchInfo(m);case 23:i=!0,e.next=19;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e["catch"](17),l=!0,u=e.t0;case 32:e.prev=32,e.prev=33,i||null==d.return||d.return();case 35:if(e.prev=35,!l){e.next=38;break}throw u;case 38:return e.finish(35);case 39:return e.finish(32);case 40:return this.current_request_operation="Getting ready to fetch tournament info",e.next=43,fetch("/index.php?act=tourmntscre4A&new_tour=0&torid=".concat(r));case 43:return f=L(Object(_["a"])({},this.store.tournamentPostOutput(),{has_legs:o?"on":null,tourstages:n.join(";").concat(";")})),this.current_request_operation="Fetching tournament's Cars / Physics",e.next=47,F(f,{page_selector:"1"});case 47:return p=e.sent,e.t1=this.store,e.next=51,p.text();case 51:e.t2=e.sent,e.t1.carsPhysicsFromHTML.call(e.t1,e.t2),g=0;case 54:if(!(g<n.length)){e.next=71;break}return v=n[g],this.current_request_operation="Fetching SS ".concat(g+1),e.next=59,F(f,{page_selector:(2+g).toString()});case 59:return p=e.sent,e.t3=this.store,e.t4=v,e.t5=H.byId[v],e.next=65,p.text();case 65:e.t6=e.sent,y=e.t3.trackFromHTML.call(e.t3,e.t4,e.t5,e.t6),y&&this.store.tracks.push(y);case 68:g++,e.next=54;break;case 71:if(!o){e.next=81;break}return this.current_request_operation="Fetching legs info",e.next=75,F(f,{page_selector:(2+this.store.tracks.length).toString()});case 75:return p=e.sent,e.t7=this.store,e.next=79,p.text();case 79:e.t8=e.sent,e.t7.legsFromHTML.call(e.t7,e.t8);case 81:e.next=86;break;case 83:e.prev=83,e.t9=e["catch"](7),this.serverErrors=[{page:"Error",error:e.t9.message}];case 86:this.current_request_operation="";case 87:case"end":return e.stop()}},e,this,[[7,83],[17,28,32,40],[33,,35,39]])}));function t(){return e.apply(this,arguments)}return t}(),render:function(e){var t=this;return e("div",{attrs:{id:"tournament_revamped"}},[e("table",{style:this.hidden?"display: none;":""},[e("tbody",[e("tr",[e("td",{class:"nav-buttons",style:"width: 25%;"},[e("button",{on:{click:function(){t.current_page=de.Tournament}},class:{active:this.current_page===de.Tournament,error:this.hasErrors(this.tournament_errors)}},["Tournament"]),e("button",{on:{click:function(){t.current_page=de.Cars}},attrs:{disabled:!J.fetched},class:{active:this.current_page===de.Cars,error:this.hasErrors(this.cars_errors)}},["Cars / Physics"]),e("button",{on:{click:function(){t.current_page=de.TrackList}},attrs:{disabled:B.fetching},class:{active:this.current_page===de.TrackList,error:this.hasErrors(this.tracks_errors)},style:"margin-bottom: 8px"},["Tracks"]),this.store.tracks.map(function(r,a){return e("button",{key:"track".concat(a),attrs:{disabled:!t.tracks_settings.byId[r.id]||!t.tracks_weather.byId[r.id]},on:{click:function(){t.current_page=de.Track,t.track_index=a}},class:{active:t.current_page===de.Track&&t.track_index===a}},["SS ",a+1," - ",t.tracks_data[r.id].name," ",r.name?"(".concat(r.name,")"):""])}),e("button",{on:{click:function(){t.current_page=de.ScheduleLegs}},class:{active:this.current_page===de.ScheduleLegs,error:this.hasErrors(this.legs_errors)},style:"margin-top: 8px"},["Schedule and legs"]),e("button",{on:{click:function(){t.current_page=de.Presets}},class:{active:this.current_page===de.Presets}},["JSON info"]),this.hasErrors(Object(_["a"])({},this.tournament_errors,this.cars_errors,this.tracks_errors,this.legs_errors))?e("button",{attrs:{disabled:!0},style:"margin-top: 8px"},["Can't send data due to errors"]):e("button",{attrs:{disabled:Boolean(this.current_request_operation)},style:"margin-top: 8px",on:{click:function(){return t.submit()}}},["Save tournament"]),this.serverErrors.length>0&&e("div",{style:"margin-top: 8px"},["Failed to create tournament",this.serverErrors.map(function(t,r){return e("div",{key:"serverError".concat(r),class:"error"},[t.page,": ",t.error])})]),e("div",{style:"margin-top: 8px"},[this.notifications.map(function(t,r){return e("div",{key:"notification".concat(r)},[t])})]),e("div",{style:"margin-top: 8px"},[e("div",["ver 1"]),e("div",[e("a",{attrs:{href:"https://github.com/suXinjke/RBRCZTourneyCreatorRevamped"}},["GitHub "])," |",e("a",{attrs:{href:"https://twitter.com/suxinjke"}},[" Twitter "])," |",e("a",{attrs:{href:"http://rbr.onlineracing.cz/index.php?act=ustats&u=66612"}},[" RBR CZ"])])])]),e("td",{style:"vertical-align: top;"},[this.current_request_operation?e("div",[this.current_request_operation]):this.current_page===de.Tournament?e(Y,{attrs:{errors:this.tournament_errors}}):this.current_page===de.Cars?e(Z,{attrs:{errors:this.cars_errors}}):this.current_page===de.TrackList?e($,{attrs:{errors:this.tracks_errors}}):this.current_page===de.Track?e(ce,{attrs:{track:this.store.tracks[this.track_index],index:this.track_index}}):this.current_page===de.ScheduleLegs?e(oe,{attrs:{errors:this.legs_errors}}):this.current_page===de.Presets?e(ue):null])])])])])}});r.p="http://127.0.0.1:8080/rbrcz_prototype/",a["default"].config.productionTip=!1;var _e=document.getElementById("tournament");if(_e){var me=_e.parentElement;if(me){var pe=document.createElement("div");pe.id="tournament_revamped",me.prepend(pe),new a["default"]({render:function(e){return e(he)}}).$mount("#tournament_revamped")}}}});
//# sourceMappingURL=app.32327dab.js.map